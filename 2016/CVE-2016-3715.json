{
	"name": "CVE-2016-3715",
	"threat_severity": "Moderate",
	"public_date": "2016-05-03T00:00:00Z",
	"bugzilla": {
		"description": "ImageMagick: File deletion",
		"id": "1332500",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1332500"
	},
	"cvss": {
		"cvss_base_score": "4.3",
		"cvss_scoring_vector": "AV:N/AC:M/Au:N/C:N/I:P/A:N",
		"status": "verified"
	},
	"cwe": "CWE-20",
	"details": [
		"The EPHEMERAL coder in ImageMagick before 6.9.3-10 and 7.x before 7.0.1-1 allows remote attackers to delete arbitrary files via a crafted image.",
		"It was discovered that certain ImageMagick coders and pseudo-protocols did not properly prevent security sensitive operations when processing specially crafted images. A remote attacker could create a specially crafted image that, when processed by an application using ImageMagick or an unsuspecting user using the ImageMagick utilities, would allow the attacker to delete arbitrary files."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2016-3715\nhttps://nvd.nist.gov/vuln/detail/CVE-2016-3715"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Details can be found under the resolve tab at https://access.redhat.com/security/vulnerabilities/2296071\nRed Hat Enterprise Linux 6 and 7\n================================\nAs a workaround the /etc/ImageMagick/policy.xml file can be edited to disable processing of MVG, HTTPS, HTTP, URL, FTP, EPHEMERAL, MSL, LABEL, TEXT,\nSHOW, WIN and PLT commands within image files, simply add the following lines:\n<policy domain=\"coder\" rights=\"none\" pattern=\"EPHEMERAL\" />\n<policy domain=\"coder\" rights=\"none\" pattern=\"HTTPS\" />\n<policy domain=\"coder\" rights=\"none\" pattern=\"HTTP\" />\n<policy domain=\"coder\" rights=\"none\" pattern=\"URL\" />\n<policy domain=\"coder\" rights=\"none\" pattern=\"FTP\" />\n<policy domain=\"coder\" rights=\"none\" pattern=\"MVG\" />\n<policy domain=\"coder\" rights=\"none\" pattern=\"MSL\" />\n<policy domain=\"coder\" rights=\"none\" pattern=\"TEXT\" />\n<policy domain=\"coder\" rights=\"none\" pattern=\"LABEL\" />\n<policy domain=\"coder\" rights=\"none\" pattern=\"SHOW\" />\n<policy domain=\"coder\" rights=\"none\" pattern=\"WIN\" />\n<policy domain=\"coder\" rights=\"none\" pattern=\"PLT\" />\n<policy domain=\"path\" rights=\"none\" pattern=\"@*\" />\nwithin the policy map stanza:\n<policymap>\n...\n</policymap>\nRed Hat Enterprise Linux 5\n==========================\nIn the following folders:\n/usr/lib64/ImageMagick-6.2.8/modules-Q16/coders/ (64bit package)\nor\n/usr/lib/ImageMagick-6.2.8/modules-Q16/coders/ (32bit package)\nRename the following files:\n* mvg.so to mvg.so.bak\n* msl.so to msl.so.bak\n* label.so to label.so.bak"
	},
	"affected_release": [
		{
			"advisory": "RHSA-2016:0726",
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"package": "ImageMagick-0:6.7.2.7-4.el6_7",
			"product_name": "Red Hat Enterprise Linux 6",
			"release_date": "2016-05-09T00:00:00Z"
		},
		{
			"advisory": "RHSA-2016:0726",
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"package": "ImageMagick-0:6.7.8.9-13.el7_2",
			"product_name": "Red Hat Enterprise Linux 7",
			"release_date": "2016-05-09T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:5",
			"fix_state": "Not affected",
			"package_name": "ImageMagick",
			"product_name": "Red Hat Enterprise Linux 5"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:2",
			"fix_state": "Affected",
			"package_name": "ImageMagick",
			"product_name": "Red Hat OpenShift Enterprise 2"
		}
	],
	"csaw": false
}
