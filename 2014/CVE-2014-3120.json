{
	"name": "CVE-2014-3120",
	"threat_severity": "Important",
	"public_date": "2013-12-09T00:00:00Z",
	"bugzilla": {
		"description": "elasticsearch: remote code execution flaw via dynamic scripting",
		"id": "1124252",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1124252"
	},
	"cvss": {
		"cvss_base_score": "6.8",
		"cvss_scoring_vector": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
		"status": "verified"
	},
	"cwe": "CWE-749",
	"details": [
		"The default configuration in Elasticsearch before 1.2 enables dynamic scripting, which allows remote attackers to execute arbitrary MVEL expressions and Java code via the source parameter to _search.  NOTE: this only violates the vendor's intended security policy if the user does not run Elasticsearch in its own independent virtual machine.",
		"It was discovered that the default configuration of Elasticsearch enabled dynamic scripting, allowing a remote attacker to execute arbitrary MVEL expressions and Java code via the source parameter passed to _search."
	],
	"statement": "On Subscription Asset Manager (SAM) 1, the elasticsearch service is only bound to the loopback interface by default. To exploit this issue on a SAM 1 system, an attacker must have local access to the system. On Red Hat JBoss Fuse and Red Hat JBoss A-MQ, the elasticsearch service is only started if the insight-elasticsearch feature is installed. This feature is not installed by default.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2014-3120\nhttps://nvd.nist.gov/vuln/detail/CVE-2014-3120\nhttps://access.redhat.com/solutions/1191453\nhttps://www.cisa.gov/known-exploited-vulnerabilities-catalog"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2014:1171",
			"cpe": "cpe:/a:redhat:fuse_esb_enterprise:7.1.0",
			"product_name": "Fuse ESB Enterprise 7.1.0",
			"release_date": "2014-09-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2014:1171",
			"cpe": "cpe:/a:redhat:fuse_management_console:7.1.0",
			"product_name": "Fuse Management Console 7.1.0",
			"release_date": "2014-09-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2014:1171",
			"cpe": "cpe:/a:redhat:fuse_mq_enterprise:7.1.0",
			"product_name": "Fuse MQ Enterprise 7.1.0",
			"release_date": "2014-09-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2014:1170",
			"cpe": "cpe:/a:redhat:jboss_amq:6.1.0",
			"product_name": "Red Hat JBoss A-MQ 6.1",
			"release_date": "2014-09-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2014:1170",
			"cpe": "cpe:/a:redhat:jboss_fuse:6.1.0",
			"product_name": "Red Hat JBoss Fuse 6.1",
			"release_date": "2014-09-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2014:1186",
			"cpe": "cpe:/a:rhel_sam:1.4::el6",
			"package": "katello-configure-0:1.4.5.1-3.el6sam",
			"product_name": "Red Hat Subscription Asset Manager 1.4",
			"release_date": "2014-09-11T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_web_server:1",
			"fix_state": "Affected",
			"package_name": "amq-6",
			"product_name": "Red Hat JBoss Enterprise Web Server 1"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_web_server:1",
			"fix_state": "Affected",
			"package_name": "fuse-6",
			"product_name": "Red Hat JBoss Enterprise Web Server 1"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_web_server:1",
			"fix_state": "Affected",
			"package_name": "fuse-amq-7",
			"product_name": "Red Hat JBoss Enterprise Web Server 1"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_web_server:1",
			"fix_state": "Affected",
			"package_name": "fuse-esb-7",
			"product_name": "Red Hat JBoss Enterprise Web Server 1"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Not affected",
			"package_name": "elasticsearch",
			"product_name": "Red Hat Satellite 6"
		}
	],
	"upstream_fix": "elasticsearch 1.2.0",
	"csaw": false
}
