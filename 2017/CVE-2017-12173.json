{
	"name": "CVE-2017-12173",
	"threat_severity": "Moderate",
	"public_date": "2017-10-03T00:00:00Z",
	"bugzilla": {
		"description": "CVE-2017-12173 sssd: unsanitized input when searching in local cache database",
		"id": "1498173",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1498173"
	},
	"cvss3": {
		"cvss3_base_score": "4.3",
		"cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
		"status": "verified"
	},
	"cwe": "CWE-20",
	"details": [
		"It was found that sssd's sysdb_search_user_by_upn_res() function before 1.16.0 did not sanitize requests when querying its local cache and was vulnerable to injection. In a centralized login environment, if a password hash was locally cached for a given user, an authenticated attacker could use this flaw to retrieve it.",
		"It was found that sssd's sysdb_search_user_by_upn_res() function did not sanitize requests when querying its local cache and was vulnerable to injection. In a centralized login environment, if a password hash was locally cached for a given user, an authenticated attacker could use this flaw to retrieve it."
	],
	"statement": "This issue affects the versions of sssd as shipped with Red Hat Satellite version 6.0. More recent versions of Satellite no longer ships sssd. This issue is not currently planned to be addressed in future updates. For additional information, refer to the Issue Severity Classification: https://access.redhat.com/security/updates/classification/.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2017-12173\nhttps://nvd.nist.gov/vuln/detail/CVE-2017-12173"
	],
	"acknowledgement": "This issue was discovered by Sumit Bose (Red Hat).",
	"mitigation": {
		"lang": "en:us",
		"value": "It is possible to disable manually credential caching :\n* Stop the sssd service\n* Delete the cache (rm -f /var/lib/sss/db/* /var/log/sssd/*) or manually remove the hashes for the database\n* In the sssd configuration file, change cache_credentials to False for each domains\n* start the sssd service again\nHowever, tools such as realmd & ipa-client-install might enable credential caching, and should be used with care."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2018:1877",
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"package": "ding-libs-0:0.4.0-13.el6",
			"product_name": "Red Hat Enterprise Linux 6",
			"release_date": "2018-06-19T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:1877",
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"package": "sssd-0:1.13.3-60.el6",
			"product_name": "Red Hat Enterprise Linux 6",
			"release_date": "2018-06-19T00:00:00Z"
		},
		{
			"advisory": "RHSA-2017:3379",
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"package": "sssd-0:1.15.2-50.el7_4.8",
			"product_name": "Red Hat Enterprise Linux 7",
			"release_date": "2017-12-05T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:5",
			"fix_state": "Not affected",
			"package_name": "sssd",
			"product_name": "Red Hat Enterprise Linux 5"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Affected",
			"package_name": "sssd",
			"product_name": "Red Hat Satellite 6"
		}
	],
	"upstream_fix": "sssd 1.16.0",
	"csaw": false
}
