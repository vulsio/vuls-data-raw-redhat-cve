{
	"name": "CVE-2017-20146",
	"threat_severity": "Moderate",
	"public_date": "2022-12-27T00:00:00Z",
	"bugzilla": {
		"description": "gorilla: Usage of the CORS handler may apply improper CORS headers",
		"id": "2158262",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2158262"
	},
	"cvss3": {
		"cvss3_base_score": "7.0",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:H/A:L",
		"status": "draft"
	},
	"cwe": "CWE-942",
	"details": [
		"Usage of the CORS handler may apply improper CORS headers, allowing the requester to explicitly control the value of the Access-Control-Allow-Origin header, which bypasses the expected behavior of the Same Origin Policy.",
		"A flaw was found in Gorilla. Usage of the CORS handler may apply improper CORS headers, allowing the requester to explicitly control the value of the Access-Control-Allow-Origin header, which bypasses the expected behavior of the Same Origin Policy."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2017-20146\nhttps://nvd.nist.gov/vuln/detail/CVE-2017-20146\nhttps://github.com/gorilla/handlers/commit/90663712d74cb411cbef281bc1e08c19d1a76145\nhttps://github.com/gorilla/handlers/pull/116\nhttps://pkg.go.dev/vuln/GO-2020-0020"
	],
	"acknowledgement": "Red Hat would like to thank Evan J Johnson for reporting this issue.",
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:logging:5",
			"fix_state": "Not affected",
			"package_name": "openshift-logging/logging-loki-rhel8",
			"product_name": "Logging Subsystem for Red Hat OpenShift"
		},
		{
			"cpe": "cpe:/a:redhat:rhmt",
			"fix_state": "Not affected",
			"package_name": "rhmtc/openshift-migration-registry-rhel8",
			"product_name": "Migration Toolkit for Containers"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_api_data_protection:1",
			"fix_state": "Not affected",
			"package_name": "oadp/oadp-registry-rhel8",
			"product_name": "OpenShift API for Data Protection"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_api_data_protection:1",
			"fix_state": "Not affected",
			"package_name": "oadp/oadp-velero-plugin-rhel8",
			"product_name": "OpenShift API for Data Protection"
		},
		{
			"cpe": "cpe:/a:redhat:ocp_tools",
			"fix_state": "Not affected",
			"package_name": "helm",
			"product_name": "OpenShift Developer Tools and Services"
		},
		{
			"cpe": "cpe:/a:redhat:ocp_tools",
			"fix_state": "Not affected",
			"package_name": "jenkins-operator-container",
			"product_name": "OpenShift Developer Tools and Services"
		},
		{
			"cpe": "cpe:/a:redhat:serverless:1",
			"fix_state": "Not affected",
			"package_name": "openshift-serverless-1/client-kn-rhel8",
			"product_name": "OpenShift Serverless"
		},
		{
			"cpe": "cpe:/a:redhat:serverless:1",
			"fix_state": "Not affected",
			"package_name": "openshift-serverless-1/ingress-rhel8-operator",
			"product_name": "OpenShift Serverless"
		},
		{
			"cpe": "cpe:/a:redhat:serverless:1",
			"fix_state": "Not affected",
			"package_name": "openshift-serverless-1-knative-client-plugin-event-sender-rhel8-container",
			"product_name": "OpenShift Serverless"
		},
		{
			"cpe": "cpe:/a:redhat:red_hat_3scale_amp:2",
			"fix_state": "Not affected",
			"package_name": "3scale-operator-container",
			"product_name": "Red Hat 3scale API Management Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "acm-cluster-proxy-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "acm-multicluster-globalhub-agent-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/acm-governance-policy-addon-controller-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/acm-grafana-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/acm-prometheus-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/acm-search-v2-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/acm-volsync-addon-controller-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/multiclusterhub-repo-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/multiclusterhub-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/multicluster-operators-application-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/multicluster-operators-channel-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/multicluster-operators-subscription-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/observatorium-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/prometheus-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/rbac-query-proxy-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/thanos-receive-controller-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/thanos-rhel7",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:advanced_cluster_security:3",
			"fix_state": "Not affected",
			"package_name": "advanced-cluster-security/rhacs-main-rhel8",
			"product_name": "Red Hat Advanced Cluster Security 3"
		},
		{
			"cpe": "cpe:/a:redhat:advanced_cluster_security:3",
			"fix_state": "Not affected",
			"package_name": "advanced-cluster-security/rhacs-scanner-rhel8",
			"product_name": "Red Hat Advanced Cluster Security 3"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform",
			"fix_state": "Not affected",
			"package_name": "helm",
			"product_name": "Red Hat Ansible Automation Platform 1.2"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:5",
			"fix_state": "Not affected",
			"package_name": "rhceph/snmp-notifier-rhel8",
			"product_name": "Red Hat Ceph Storage 5"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "container-tools:4.0/podman",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "container-tools:rhel8/podman",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "podman",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Out of support scope",
			"package_name": "ansible-service-broker",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Not affected",
			"package_name": "atomic-openshift-dockerregistry",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/kubernetes-nmstate-rhel8-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/metallb-rhel8-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/oc-mirror-plugin-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-agent-installer-api-server-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-agent-installer-node-agent-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-aws-cluster-api-controllers-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-azure-cluster-api-controllers-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-cluster-kube-cluster-api-rhel8-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-cluster-monitoring-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-cluster-platform-operators-manager-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-console",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-docker-registry",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-gcp-filestore-csi-driver-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-grafana",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-hypershift-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-local-storage-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-machine-config-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-metering-ansible-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-metering-helm-container-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-network-interface-bond-cni-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-olm-rukpak-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-operator-marketplace",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-operator-registry",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-operator-sdk-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-prometheus",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-prometheus-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-prom-label-proxy",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-ptp-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-thanos-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-tools-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-vsphere-cluster-api-controllers-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/special-resource-rhel8-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ztp-site-generate-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift-compliance-openscap-container",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift-security-profiles-operator-container",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "ose-containernetworking-plugins-container",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "ose-openshift-controller-manager-container",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "podman",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:assisted_installer:",
			"fix_state": "Not affected",
			"package_name": "rhai-tech-preview/assisted-installer-agent-rhel8",
			"product_name": "Red Hat OpenShift Container Platform Assisted Installer"
		},
		{
			"cpe": "cpe:/a:redhat:assisted_installer:",
			"fix_state": "Not affected",
			"package_name": "rhai-tech-preview/assisted-installer-rhel8",
			"product_name": "Red Hat OpenShift Container Platform Assisted Installer"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Not affected",
			"package_name": "ocs4/mcg-rhel8-operator",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Not affected",
			"package_name": "ocs4/ocs-rhel8-operator",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf4/ocs-rhel8-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf4/odf-csi-addons-sidecar-rhel8",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf4/odf-multicluster-rhel8-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf4/odf-rhel8-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf4/odr-rhel8-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf/odf-multicluster-rhel8-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:2",
			"fix_state": "Not affected",
			"package_name": "rhosdt/jaeger-agent-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 2"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:2",
			"fix_state": "Not affected",
			"package_name": "rhosdt/opentelemetry-collector-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 2"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_gitops:1",
			"fix_state": "Not affected",
			"package_name": "openshift-gitops-1/applicationset-rhel8",
			"product_name": "Red Hat OpenShift GitOps"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_gitops:1",
			"fix_state": "Not affected",
			"package_name": "openshift-gitops-1/argocd-rhel8",
			"product_name": "Red Hat OpenShift GitOps"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_gitops:1",
			"fix_state": "Not affected",
			"package_name": "openshift-gitops-1/dex-rhel8",
			"product_name": "Red Hat OpenShift GitOps"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_gitops:1",
			"fix_state": "Not affected",
			"package_name": "openshift-gitops-1/gitops-rhel8",
			"product_name": "Red Hat OpenShift GitOps"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_gitops:1",
			"fix_state": "Not affected",
			"package_name": "openshift-gitops-1/gitops-rhel8-operator",
			"product_name": "Red Hat OpenShift GitOps"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_gitops:1",
			"fix_state": "Not affected",
			"package_name": "openshift-gitops-1/kam-delivery-rhel8",
			"product_name": "Red Hat OpenShift GitOps"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_sandboxed_containers:1",
			"fix_state": "Not affected",
			"package_name": "openshift-sandboxed-containers/osc-rhel9-operator",
			"product_name": "Red Hat Openshift sandboxed containers"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:16.2",
			"fix_state": "Not affected",
			"package_name": "rhosp-rhel8/osp-director-agent",
			"product_name": "Red Hat OpenStack Platform 16.2"
		},
		{
			"cpe": "cpe:/a:redhat:quay:3",
			"fix_state": "Not affected",
			"package_name": "quay/quay-builder-rhel8",
			"product_name": "Red Hat Quay 3"
		}
	],
	"upstream_fix": "github.com/gorilla/handlers 1.3.0",
	"csaw": false
}
