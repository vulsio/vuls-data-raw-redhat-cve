{
	"name": "CVE-2017-17689",
	"threat_severity": "Moderate",
	"public_date": "2018-05-14T00:00:00Z",
	"bugzilla": {
		"description": "CVE-2017-17689 S/MIME: CBC gadget attacks allows to exfiltrate plaintext out of encrypted emails",
		"id": "1577909",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1577909"
	},
	"cvss3": {
		"cvss3_base_score": "5.3",
		"cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N",
		"status": "draft"
	},
	"cwe": "CWE-200",
	"details": [
		"The S/MIME specification allows a Cipher Block Chaining (CBC) malleability-gadget attack that can indirectly lead to plaintext exfiltration, aka EFAIL."
	],
	"statement": "The research paper talks about use of HTML as a back channel to create an oracle for modified encrypted emails. HTML emails which use external links like \"<img href=\"tla.org/TAG\"/>\" can cause security issues if they are honored by the MUAs. Due to flaws in MIME parsers many MUAs seem to concatenate decrypted HTML mine parts which makes it easy to plan such snippets in HTML emails. Please refer to https://lists.gnupg.org/pipermail/gnupg-users/2018-May/060315.html about how GnuPG can mitigate this flaw.\nFor Thunderbird, this vulnerability was known as CVE-2018-5162 and resolved in 52.8.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2017-17689\nhttps://nvd.nist.gov/vuln/detail/CVE-2017-17689\nhttps://efail.de/"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "The easiest way to mitigate this vulnerability is not to use HTML emails. If you really need to use them ensure that MUA clients disable external links embedded in HTML emails. For example in thunderbird email client, Edit->Preferences->Privacy->Disable \"Allow remote content in messages\"."
	},
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Will not fix",
			"package_name": "kdepim",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "thunderbird",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Will not fix",
			"package_name": "kdepim",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "thunderbird",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "thunderbird",
			"product_name": "Red Hat Enterprise Linux 8"
		}
	],
	"csaw": false
}
