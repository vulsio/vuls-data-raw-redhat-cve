{
	"name": "CVE-2022-24785",
	"threat_severity": "Moderate",
	"public_date": "2022-04-04T00:00:00Z",
	"bugzilla": {
		"description": "Moment.js: Path traversal  in moment.locale",
		"id": "2072009",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2072009"
	},
	"cvss3": {
		"cvss3_base_score": "7.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
		"status": "verified"
	},
	"cwe": "CWE-22",
	"details": [
		"Moment.js is a JavaScript date library for parsing, validating, manipulating, and formatting dates. A path traversal vulnerability impacts npm (server) users of Moment.js between versions 1.0.1 and 2.29.1, especially if a user-provided locale string is directly used to switch moment locale. This problem is patched in 2.29.2, and the patch can be applied to all affected versions. As a workaround, sanitize the user-provided locale name before passing it to Moment.js.",
		"A path traversal vulnerability was found in Moment.js that impacts npm (server) users. This issue occurs if a user-provided locale string is directly used to switch moment locale, which an attacker can exploit to change the correct path to one of their choice. This can result in a loss of integrity."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2022-24785\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-24785\nhttps://github.com/moment/moment/security/advisories/GHSA-8hfj-j24r-96c4"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Sanitize the user-provided locale name before passing it to Moment.js."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2022:6272",
			"cpe": "cpe:/a:redhat:service_mesh:2.0::el8",
			"package": "servicemesh-prometheus-0:2.14.0-18.el8.1",
			"product_name": "OpenShift Service Mesh 2.0",
			"release_date": "2022-08-31T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:5006",
			"cpe": "cpe:/a:redhat:service_mesh:2.1::el8",
			"package": "openshift-service-mesh/kiali-rhel8:1.36.10-2",
			"product_name": "OpenShift Service Mesh 2.1",
			"release_date": "2022-06-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:6277",
			"cpe": "cpe:/a:redhat:service_mesh:2.1::el8",
			"package": "servicemesh-prometheus-0:2.23.0-9.el8",
			"product_name": "OpenShift Service Mesh 2.1",
			"release_date": "2022-08-31T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:1715",
			"cpe": "cpe:/a:redhat:acm:2.3::el8",
			"impact": "low",
			"package": "rhacm2/application-ui-rhel8:v2.3.10-6",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 8",
			"release_date": "2022-05-05T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:1715",
			"cpe": "cpe:/a:redhat:acm:2.3::el8",
			"impact": "low",
			"package": "rhacm2/console-api-rhel8:v2.3.10-5",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 8",
			"release_date": "2022-05-05T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:1715",
			"cpe": "cpe:/a:redhat:acm:2.3::el8",
			"impact": "low",
			"package": "rhacm2/console-rhel8:v2.3.10-4",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 8",
			"release_date": "2022-05-05T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:1715",
			"cpe": "cpe:/a:redhat:acm:2.3::el8",
			"impact": "low",
			"package": "rhacm2/grc-ui-api-rhel8:v2.3.10-4",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 8",
			"release_date": "2022-05-05T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:1715",
			"cpe": "cpe:/a:redhat:acm:2.3::el8",
			"impact": "low",
			"package": "rhacm2/grc-ui-rhel8:v2.3.10-3",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 8",
			"release_date": "2022-05-05T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:1715",
			"cpe": "cpe:/a:redhat:acm:2.3::el8",
			"impact": "low",
			"package": "rhacm2/search-ui-rhel8:v2.3.10-5",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 8",
			"release_date": "2022-05-05T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:5392",
			"cpe": "cpe:/a:redhat:acm:2.3::el8",
			"impact": "low",
			"package": "rhacm2/kui-web-terminal-rhel8:v2.3.11-11",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 8",
			"release_date": "2022-06-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:1681",
			"cpe": "cpe:/a:redhat:acm:2.4::el8",
			"impact": "low",
			"package": "rhacm2/application-ui-rhel8:v2.4.4-3",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.4 for RHEL 8",
			"release_date": "2022-05-03T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:1681",
			"cpe": "cpe:/a:redhat:acm:2.4::el8",
			"impact": "low",
			"package": "rhacm2/console-api-rhel8:v2.4.4-3",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.4 for RHEL 8",
			"release_date": "2022-05-03T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:1681",
			"cpe": "cpe:/a:redhat:acm:2.4::el8",
			"impact": "low",
			"package": "rhacm2/console-rhel8:v2.4.4-4",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.4 for RHEL 8",
			"release_date": "2022-05-03T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:1681",
			"cpe": "cpe:/a:redhat:acm:2.4::el8",
			"impact": "low",
			"package": "rhacm2/grc-ui-api-rhel8:v2.4.4-3",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.4 for RHEL 8",
			"release_date": "2022-05-03T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:1681",
			"cpe": "cpe:/a:redhat:acm:2.4::el8",
			"impact": "low",
			"package": "rhacm2/grc-ui-rhel8:v2.4.4-3",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.4 for RHEL 8",
			"release_date": "2022-05-03T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:1681",
			"cpe": "cpe:/a:redhat:acm:2.4::el8",
			"impact": "low",
			"package": "rhacm2/search-ui-rhel8:v2.4.4-3",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.4 for RHEL 8",
			"release_date": "2022-05-03T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:5201",
			"cpe": "cpe:/a:redhat:acm:2.4::el8",
			"impact": "low",
			"package": "rhacm2/search-api-rhel8:v2.4.5-10",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.4 for RHEL 8",
			"release_date": "2022-06-27T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:4956",
			"cpe": "cpe:/a:redhat:acm:2.5::el8",
			"impact": "low",
			"package": "rhacm2/search-api-rhel8:v2.5.0-25",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.5 for RHEL 8",
			"release_date": "2022-06-09T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:0076",
			"cpe": "cpe:/a:redhat:ceph_storage:5.3::el8",
			"package": "ceph-2:16.2.10-94.el9cp",
			"product_name": "Red Hat Ceph Storage 5.3",
			"release_date": "2023-01-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:3642",
			"cpe": "cpe:/a:redhat:ceph_storage:6.1::el9",
			"package": "rhceph/rhceph-6-dashboard-rhel9:6-75",
			"product_name": "Red Hat Ceph Storage 6.1",
			"release_date": "2023-06-15T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:8652",
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"package": "Moment.js",
			"product_name": "Red Hat Fuse 7.11.1",
			"release_date": "2022-11-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:3954",
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"product_name": "Red Hat Fuse 7.12",
			"release_date": "2023-06-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:4922",
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4",
			"package": "Moment.js",
			"product_name": "Red Hat JBoss Enterprise Application Platform 7.1.0",
			"release_date": "2022-06-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:4919",
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4::el8",
			"package": "eap7-hal-console-0:3.3.12-1.Final_redhat_00001.1.el8eap",
			"product_name": "Red Hat JBoss Enterprise Application Platform 7.4 for RHEL 8",
			"release_date": "2022-06-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:4918",
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4::el7",
			"package": "eap7-hal-console-0:3.3.12-1.Final_redhat_00001.1.el7eap",
			"product_name": "Red Hat JBoss Enterprise Application Platform 7.4 on RHEL 7",
			"release_date": "2022-06-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:6156",
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4.11::el8",
			"package": "odf4/mcg-core-rhel8:v4.11.0-30",
			"product_name": "Red Hat OpenShift Data Foundation 4.11 on RHEL8",
			"release_date": "2022-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:1049",
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6",
			"package": "Moment.js",
			"product_name": "Red Hat Single Sign-On 7",
			"release_date": "2023-03-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:1043",
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el7",
			"package": "rh-sso7-keycloak-0:18.0.6-1.redhat_00001.1.el7sso",
			"product_name": "Red Hat Single Sign-On 7.6 for RHEL 7",
			"release_date": "2023-03-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:1044",
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el8",
			"package": "rh-sso7-keycloak-0:18.0.6-1.redhat_00001.1.el8sso",
			"product_name": "Red Hat Single Sign-On 7.6 for RHEL 8",
			"release_date": "2023-03-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:1045",
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el9",
			"package": "rh-sso7-keycloak-0:18.0.6-1.redhat_00001.1.el9sso",
			"product_name": "Red Hat Single Sign-On 7.6 for RHEL 9",
			"release_date": "2023-03-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:1047",
			"cpe": "cpe:/a:redhat:rhosemc:1.0::el8",
			"package": "rh-sso-7/sso76-openshift-rhel8:7.6-20",
			"product_name": "RHEL-8 based Middleware Containers",
			"release_date": "2023-03-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:6813",
			"cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7.13",
			"package": "Moment.js",
			"product_name": "RHPAM 7.13.1 async",
			"release_date": "2022-10-05T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:service_mesh:2.0",
			"fix_state": "Will not fix",
			"package_name": "kiali",
			"product_name": "OpenShift Service Mesh 2.0"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:2.0",
			"fix_state": "Will not fix",
			"package_name": "servicemesh-grafana",
			"product_name": "OpenShift Service Mesh 2.0"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:2.1",
			"fix_state": "Will not fix",
			"package_name": "servicemesh-grafana",
			"product_name": "OpenShift Service Mesh 2.1"
		},
		{
			"cpe": "cpe:/a:redhat:red_hat_3scale_amp:2",
			"fix_state": "Affected",
			"package_name": "3scale-apicast-operator-bundle-container",
			"product_name": "Red Hat 3scale API Management Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:red_hat_3scale_amp:2",
			"fix_state": "Affected",
			"package_name": "3scale-apicast-operator-container",
			"product_name": "Red Hat 3scale API Management Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "rhacm2/console-header-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "rhacm2/console-ui-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "rhacm2/mcm-topology-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:3",
			"fix_state": "Out of support scope",
			"package_name": "grafana",
			"product_name": "Red Hat Ceph Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:4",
			"fix_state": "Will not fix",
			"package_name": "ceph",
			"product_name": "Red Hat Ceph Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:4",
			"fix_state": "Will not fix",
			"package_name": "rhceph/rhceph-4-dashboard-rhel8",
			"product_name": "Red Hat Ceph Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:5",
			"fix_state": "Affected",
			"package_name": "rhceph/rhceph-5-dashboard-rhel8",
			"product_name": "Red Hat Ceph Storage 5"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:8",
			"fix_state": "Will not fix",
			"package_name": "Moment.js",
			"product_name": "Red Hat Data Grid 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Will not fix",
			"package_name": "389-ds:1.4/389-ds-base",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "cockpit",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "cockpit-appstream",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "cockpit-composer",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "cockpit-session-recording",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "container-tools:2.0/cockpit-podman",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "container-tools:3.0/cockpit-podman",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "container-tools:rhel8/cockpit-podman",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "cockpit",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "cockpit-composer",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "cockpit-session-recording",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "Moment.js",
			"product_name": "Red Hat Integration Camel K"
		},
		{
			"cpe": "cpe:/a:redhat:camel_quarkus:2",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "Moment.js",
			"product_name": "Red Hat Integration Camel Quarkus"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Out of support scope",
			"package_name": "Moment.js",
			"product_name": "Red Hat Integration Data Virtualisation Operator"
		},
		{
			"cpe": "cpe:/a:redhat:service_registry:2",
			"fix_state": "Affected",
			"package_name": "Moment.js",
			"product_name": "Red Hat Integration Service Registry"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:7",
			"fix_state": "Out of support scope",
			"package_name": "Moment.js",
			"product_name": "Red Hat JBoss Data Grid 7"
		},
		{
			"cpe": "cpe:/a:redhat:jbosseapxp",
			"fix_state": "Not affected",
			"package_name": "Moment.js",
			"product_name": "Red Hat JBoss Enterprise Application Platform Expansion Pack"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Out of support scope",
			"package_name": "openshift3/grafana",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Out of support scope",
			"package_name": "openshift3/ose-console",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Out of support scope",
			"package_name": "openshift3/prometheus",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-prometheus",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Out of support scope",
			"package_name": "ceph",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Out of support scope",
			"package_name": "ocs4/mcg-core-rhel8",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Will not fix",
			"package_name": "ceph",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Affected",
			"package_name": "noobaa-core-container",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:2",
			"fix_state": "Affected",
			"package_name": "rhosdt/jaeger-agent-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 2"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_gitops:1",
			"fix_state": "Affected",
			"package_name": "openshift-gitops-1/argocd-rhel8",
			"product_name": "Red Hat OpenShift GitOps"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:16.1",
			"fix_state": "Not affected",
			"package_name": "qpid-dispatch",
			"product_name": "Red Hat OpenStack Platform 16.1"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:16.2",
			"fix_state": "Not affected",
			"package_name": "qpid-dispatch",
			"product_name": "Red Hat OpenStack Platform 16.2"
		},
		{
			"cpe": "cpe:/a:redhat:quay:3",
			"fix_state": "Affected",
			"package_name": "quay/quay-rhel8",
			"product_name": "Red Hat Quay 3"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Affected",
			"package_name": "qpid-dispatch",
			"product_name": "Red Hat Satellite 6"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Will not fix",
			"package_name": "grafana",
			"product_name": "Red Hat Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:enterprise_linux:8::hypervisor",
			"fix_state": "Out of support scope",
			"package_name": "ovirt-engine-api-explorer",
			"product_name": "Red Hat Virtualization 4"
		}
	],
	"upstream_fix": "moment v 2.29.2",
	"csaw": false
}
