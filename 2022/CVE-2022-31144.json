{
	"bugzilla": {
		"description": "CVE-2022-31144 redis: heap overflow via XAUTOCLAIM command",
		"id": "2140891",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2140891"
	},
	"csaw": false,
	"cvss3": {
		"cvss3_base_score": "7.0",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
		"status": "draft"
	},
	"cwe": "CWE-122",
	"details": [
		"Redis is an in-memory database that persists on disk. A specially crafted `XAUTOCLAIM` command on a stream key in a specific state may result with heap overflow, and potentially remote code execution. This problem affects versions on the 7.x branch prior to 7.0.4. The patch is released in version 7.0.4.",
		"A heap-based buffer overflow flaw was found in Redis within the XAUTOCLAIM command implementation. This flaw allows an attacker to craft the XAUTOCLAIM command with malicious data on a stream key in a specific state that triggers a heap-based buffer overflow, possibly enabling remote code execution."
	],
	"name": "CVE-2022-31144",
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:red_hat_3scale_amp:2",
			"fix_state": "Not affected",
			"package_name": "3scale-amp-backend-container",
			"product_name": "Red Hat 3scale API Management Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/search-api-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform",
			"fix_state": "Not affected",
			"package_name": "ansible-tower",
			"product_name": "Red Hat Ansible Automation Platform 1.2"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "redis:6/redis",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "redis",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"fix_state": "Not affected",
			"package_name": "redis",
			"product_name": "Red Hat JBoss Fuse 7"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:13",
			"fix_state": "Out of support scope",
			"package_name": "redis",
			"product_name": "Red Hat OpenStack Platform 13 (Queens)"
		},
		{
			"cpe": "cpe:/a:redhat:quay:3",
			"fix_state": "Not affected",
			"package_name": "quay/quay-rhel8",
			"product_name": "Red Hat Quay 3"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Not affected",
			"package_name": "satellite:el8/rubygem-gitlab-sidekiq-fetcher",
			"product_name": "Red Hat Satellite 6"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Not affected",
			"package_name": "tfm-rubygem-gitlab-sidekiq-fetcher",
			"product_name": "Red Hat Satellite 6"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:3",
			"fix_state": "Not affected",
			"package_name": "rh-redis6-redis",
			"product_name": "Red Hat Software Collections"
		}
	],
	"public_date": "2022-07-19T00:00:00Z",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2022-31144\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-31144\nhttps://github.com/redis/redis/security/advisories/GHSA-96f7-42fg-2jrh"
	],
	"statement": "The vulnerable code was introduced in Redis v7.0.0 and affects only Redis v7.0.0 and higher versions. Hence, Red Hat Enterprise Linux - 8, 9 with Redis v6.x.x are NOT-AFFECTED.",
	"threat_severity": "Moderate",
	"upstream_fix": "redis 7.0.4"
}
