{
	"name": "CVE-2022-0001",
	"threat_severity": "Moderate",
	"public_date": "2022-03-08T00:00:00Z",
	"bugzilla": {
		"description": "Branch History Injection (BHI)",
		"id": "2061712",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2061712"
	},
	"cvss3": {
		"cvss3_base_score": "4.7",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N",
		"status": "verified"
	},
	"details": [
		"Non-transparent sharing of branch predictor selectors between contexts in some Intel(R) Processors may allow an authorized user to potentially enable information disclosure via local access.",
		"A flaw was found in hw. The Branch History Injection (BHI) describes a specific form of intra-mode BTI. This flaw allows an unprivileged attacker to manipulate the branch history before transitioning to supervisor or VMX root mode. This issue is an effort to cause an indirect branch predictor to select a specific predictor entry for an indirect branch, and a disclosure gadget at the predicted target will transiently execute. This execution is possible since the relevant branch history may contain branches taken in previous security contexts, and in particular, in other predictor modes."
	],
	"statement": "The current known mechanisms to exploit this issue rely on unprivileged eBPF functionality. Unprivileged eBPF is disabled by default on Red Hat Enterprise Linux.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2022-0001\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-0001\nhttps://www.intel.com/content/www/us/en/developer/articles/technical/software-security-guidance/technical-documentation/branch-history-injection.html\nhttps://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00598.html\nhttps://www.vusec.net/projects/bhi-spectre-bhb/"
	],
	"acknowledgement": "Red Hat would like to thank Intel for reporting this issue.",
	"mitigation": {
		"lang": "en:us",
		"value": "Disabling unprivileged eBPF effectively mitigates the known attack vectors for exploiting intra-mode branch injections attacks.\nThe default Red Hat Enterprise Linux kernel prevents unprivileged users from being able to use eBPF by the kernel.unprivileged_bpf_disabled sysctl.\nFor the Red Hat Enterprise Linux 7, the eBPF for unprivileged users is always disabled.\nFor the Red Hat Enterprise Linux 8 to confirm the current state, inspect the sysctl with the command:\n# cat /proc/sys/kernel/unprivileged_bpf_disabled\nThe setting of 1 would mean that unprivileged users can not use eBPF, mitigating the flaw.\nContinue to enable SMEP and Enhanced IBRS. This is the default setting on eligible CPUs."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2022:1975",
			"cpe": "cpe:/a:redhat:enterprise_linux:8::nfv",
			"package": "kernel-rt-0:4.18.0-372.9.1.rt7.166.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2022-05-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:1988",
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"package": "kernel-0:4.18.0-372.9.1.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2022-05-10T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Will not fix",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Will not fix",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Will not fix",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"csaw": false
}
