{
	"name": "CVE-2022-48742",
	"threat_severity": "Moderate",
	"public_date": "2024-06-20T00:00:00Z",
	"bugzilla": {
		"description": "kernel: rtnetlink: make sure to refresh master_dev/m_ops in __rtnl_newlink()",
		"id": "2293317",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2293317"
	},
	"cvss3": {
		"cvss3_base_score": "4.1",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:N/I:N/A:H",
		"status": "draft"
	},
	"cwe": "CWE-416",
	"details": [
		"In the Linux kernel, the following vulnerability has been resolved:\nrtnetlink: make sure to refresh master_dev/m_ops in __rtnl_newlink()\nWhile looking at one unrelated syzbot bug, I found the replay logic\nin __rtnl_newlink() to potentially trigger use-after-free.\nIt is better to clear master_dev and m_ops inside the loop,\nin case we have to replay it."
	],
	"statement": "Actual only for Red Hat Enterprise Linux 8.\nFixed for all versions of Red Hat Enterprise Linux 9.\nReading the source code, related source in function __rtnl_newlink or in rtnl_newlink for newer versions.\nThe fix is that setting to NULL these vars\n+master_dev = NULL;\n+m_ops = NULL;\njust before usage (before call \"master_dev = netdev_master_upper_dev_get(dev);\"),\nbut not in advance in the beginning of func __rtnl_newlink.\nIt means that for some complex conditions potentially these vars could be inited with some incorrect values between. No known ways to reproduce it, so saying generally could be considered as not a security issue (or maybe as potential security issue with low level impact).\nThe bug could happen only if function rtnl_link_ops_get(..) returns some \"ops\" (instead of NULL).\nThis could happen if some option \"kind\" exists. Basically it could happen only if IFLA_INFO_KIND being used (that is ops->kind).\nIt is possible to set this \"ops->kind\" during __rtnl_newlink(..) call.\nSee \"RTM_NEWLINK\" in doc https://man7.org/linux/man-pages/man7/rtnetlink.7.html\nI think that regular user cannot trigger call to the \"RTM_NEWLINK\", so only privileged user can try to trigger this issue (potentially, because unlikely that can find way how to trigger it).",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2022-48742\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-48742\nhttps://lore.kernel.org/linux-cve-announce/2024062003-CVE-2022-48742-6393@gregkh/T"
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "kernel 4.9.300, kernel 4.14.265, kernel 4.19.228, kernel 5.4.177, kernel 5.10.97, kernel 5.15.20, kernel 5.16.6, kernel 5.17",
	"csaw": false
}
