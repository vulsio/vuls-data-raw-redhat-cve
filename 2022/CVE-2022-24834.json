{
	"name": "CVE-2022-24834",
	"threat_severity": "Moderate",
	"public_date": "2023-07-10T00:00:00Z",
	"bugzilla": {
		"description": "redis: heap overflow in the lua cjson and cmsgpack libraries",
		"id": "2221662",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2221662"
	},
	"cvss3": {
		"cvss3_base_score": "7.0",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-680",
	"details": [
		"Redis is an in-memory database that persists on disk. A specially crafted Lua script executing in Redis can trigger a heap overflow in the cjson library, and result with heap corruption and potentially remote code execution. The problem exists in all versions of Redis with Lua scripting support, starting from 2.6, and affects only authenticated and authorized users. The problem is fixed in versions 7.0.12, 6.2.13, and 6.0.20.",
		"A heap-based buffer overflow flaw was found in Redis. This flaw allows a local authenticated attacker user or attacker to execute a specially crafted Lua script in Redis. This attack triggers a heap overflow in the cjson and cmsgpack libraries, resulting in heap corruption and potential remote code execution."
	],
	"statement": "The problem exists in all versions of Redis with Lua scripting support, starting from 2.6, and affects only authenticated and authorized users.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2022-24834\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-24834\nhttps://github.com/redis/redis/security/advisories/GHSA-p8x2-9v9q-c838\nhttps://groups.google.com/g/redis-db/c/JDjKS0GubsQ"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Prevent users from executing Lua scripts. This can be done using ACL to restrict EVAL and EVALSHA commands."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2025:0595",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "redis:6-8100020250113083959.489197e6",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2025-01-22T00:00:00Z"
		},
		{
			"advisory": "RHSA-2025:0693",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"package": "redis-0:6.2.17-1.el9_5",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2025-01-27T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:red_hat_3scale_amp:2",
			"fix_state": "Affected",
			"package_name": "3scale-amp-backend-container",
			"product_name": "Red Hat 3scale API Management Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:red_hat_3scale_amp:2",
			"fix_state": "Will not fix",
			"package_name": "3scale-amp-system-container",
			"product_name": "Red Hat 3scale API Management Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/search-api-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform",
			"fix_state": "Not affected",
			"package_name": "ansible-tower",
			"product_name": "Red Hat Ansible Automation Platform 1.2"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "redis-6-container",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"fix_state": "Not affected",
			"package_name": "redis",
			"product_name": "Red Hat Fuse 7"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:16.1",
			"fix_state": "Not affected",
			"package_name": "openstack-redis-base-container",
			"product_name": "Red Hat OpenStack Platform 16.1"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:16.1",
			"fix_state": "Not affected",
			"package_name": "openstack-redis-container",
			"product_name": "Red Hat OpenStack Platform 16.1"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:16.2",
			"fix_state": "Not affected",
			"package_name": "openstack-redis-container",
			"product_name": "Red Hat OpenStack Platform 16.2"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:17.0",
			"fix_state": "Not affected",
			"package_name": "openstack-redis-container",
			"product_name": "Red Hat OpenStack Platform 17.0"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:17.1",
			"fix_state": "Not affected",
			"package_name": "openstack-redis-container",
			"product_name": "Red Hat OpenStack Platform 17.1"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:18.0",
			"fix_state": "Not affected",
			"package_name": "openstack-redis-container",
			"product_name": "Red Hat OpenStack Platform 18.0"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Not affected",
			"package_name": "satellite:el8/rubygem-gitlab-sidekiq-fetcher",
			"product_name": "Red Hat Satellite 6"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Not affected",
			"package_name": "tfm-rubygem-gitlab-sidekiq-fetcher",
			"product_name": "Red Hat Satellite 6"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:3",
			"fix_state": "Will not fix",
			"package_name": "rh-redis6-redis",
			"product_name": "Red Hat Software Collections"
		}
	],
	"upstream_fix": "redis 7.0.12, redis 6.2.13, redis 6.0.20",
	"csaw": false
}
