{
	"name": "CVE-2022-45869",
	"threat_severity": "Moderate",
	"public_date": "2022-11-23T00:00:00Z",
	"bugzilla": {
		"description": "kernel: KVM: x86/mmu: race condition in direct_page_fault()",
		"id": "2151317",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2151317"
	},
	"cvss3": {
		"cvss3_base_score": "5.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
		"status": "verified"
	},
	"cwe": "CWE-362",
	"details": [
		"A race condition in the x86 KVM subsystem in the Linux kernel through 6.1-rc6 allows guest OS users to cause a denial of service (host OS crash or host OS memory corruption) when nested virtualisation and the TDP MMU are enabled.",
		"A flaw was found in the Linux kernel in the KVM. A race condition in direct_page_fault allows guest OS users to cause a denial of service (host OS crash or host OS memory corruption) when nested virtualization and the TDP MMU are enabled."
	],
	"statement": "The nested virtualization feature is not enabled by default up to Red Hat Enterprise Linux 8.4. Most importantly, Red Hat currently provides nested virtualization only as a Technology Preview and is therefore unsupported for production use. For additional details, please see https://access.redhat.com/solutions/21101 and https://access.redhat.com/support/offerings/techpreview.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2022-45869\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-45869"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "This vulnerability can be mitigated by disabling the nested virtualization feature.\nFor Intel:\n```\n# modprobe -r kvm_intel\n# modprobe kvm_intel nested=0\n```\nFor AMD:\n```\n# modprobe -r kvm_amd\n# modprobe kvm_amd nested=0\n```"
	},
	"affected_release": [
		{
			"advisory": "RHSA-2023:6901",
			"cpe": "cpe:/a:redhat:enterprise_linux:8::nfv",
			"package": "kernel-rt-0:4.18.0-513.5.1.rt7.307.el8_9",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2023-11-14T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:7077",
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"package": "kernel-0:4.18.0-513.5.1.el8_9",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2023-11-14T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:4377",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"package": "kernel-0:5.14.0-284.25.1.el9_2",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2023-08-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:4378",
			"cpe": "cpe:/a:redhat:enterprise_linux:9::nfv",
			"package": "kernel-rt-0:5.14.0-284.25.1.rt14.310.el9_2",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2023-08-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:4377",
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"package": "kernel-0:5.14.0-284.25.1.el9_2",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2023-08-01T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		}
	],
	"upstream_fix": "kernel 6.1-rc7",
	"csaw": false
}
