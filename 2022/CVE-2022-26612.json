{
	"name": "CVE-2022-26612",
	"threat_severity": "Important",
	"public_date": "2022-04-07T00:00:00Z",
	"bugzilla": {
		"description": "hadoop: Arbitrary file write in FileUtil#unpackEntries on Windows",
		"id": "2073923",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2073923"
	},
	"cvss3": {
		"cvss3_base_score": "9.8",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
		"status": "draft"
	},
	"cwe": "CWE-281",
	"details": [
		"In Apache Hadoop, The unTar function uses unTarUsingJava function on Windows and the built-in tar utility on Unix and other OSes. As a result, a TAR entry may create a symlink under the expected extraction directory which points to an external directory. A subsequent TAR entry may extract an arbitrary file into the external directory using the symlink name. This however would be caught by the same targetDirPath check on Unix because of the getCanonicalPath call. However on Windows, getCanonicalPath doesn't resolve symbolic links, which bypasses the check. unpackEntries during TAR extraction follows symbolic links which allows writing outside expected base directory on Windows. This was addressed in Apache Hadoop 3.2.3",
		"A flaw was found in Apache Hadoop, where an unTar function bypasses a check. This flaw allows an attacker to write outside of the expected base directory on Windows."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2022-26612\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-26612"
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:a_mq_clients:2",
			"fix_state": "Not affected",
			"package_name": "hadoop",
			"product_name": "A-MQ Clients 2"
		},
		{
			"cpe": "cpe:/a:redhat:logging:5",
			"fix_state": "Affected",
			"package_name": "hadoop",
			"product_name": "Logging Subsystem for Red Hat OpenShift"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/volsync-mover-rclone-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:8",
			"fix_state": "Not affected",
			"package_name": "hadoop",
			"product_name": "Red Hat Data Grid 8"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "hadoop",
			"product_name": "Red Hat Integration Camel K"
		},
		{
			"cpe": "cpe:/a:redhat:camel_quarkus:2",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "hadoop",
			"product_name": "Red Hat Integration Camel Quarkus"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Out of support scope",
			"package_name": "hadoop",
			"product_name": "Red Hat Integration Data Virtualisation Operator"
		},
		{
			"cpe": "cpe:/a:redhat:amq_broker:7",
			"fix_state": "Not affected",
			"package_name": "hadoop",
			"product_name": "Red Hat JBoss A-MQ 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:7",
			"fix_state": "Out of support scope",
			"package_name": "hadoop",
			"product_name": "Red Hat JBoss Data Grid 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_virtualization:6",
			"fix_state": "Out of support scope",
			"package_name": "hadoop",
			"product_name": "Red Hat JBoss Data Virtualization 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7",
			"fix_state": "Not affected",
			"package_name": "hadoop",
			"product_name": "Red Hat JBoss Enterprise Application Platform 7"
		},
		{
			"cpe": "cpe:/a:redhat:jbosseapxp",
			"fix_state": "Not affected",
			"package_name": "hadoop",
			"product_name": "Red Hat JBoss Enterprise Application Platform Expansion Pack"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:6",
			"fix_state": "Out of support scope",
			"package_name": "hadoop",
			"product_name": "Red Hat JBoss Fuse 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "hadoop",
			"product_name": "Red Hat JBoss Fuse 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse_service_works:6",
			"fix_state": "Out of support scope",
			"package_name": "hadoop",
			"product_name": "Red Hat JBoss Fuse Service Works 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_operations_network:3",
			"fix_state": "Out of support scope",
			"package_name": "hadoop",
			"product_name": "Red Hat JBoss Operations Network 3"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Affected",
			"package_name": "openshift4/ose-metering-hadoop",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:amq_streams:1",
			"fix_state": "Not affected",
			"package_name": "hadoop",
			"product_name": "streams for Apache Kafka"
		}
	],
	"upstream_fix": "Apache Hadoop 3.2.3",
	"csaw": false
}
