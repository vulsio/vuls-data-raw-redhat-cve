{
	"name": "CVE-2022-24812",
	"threat_severity": "Important",
	"public_date": "2022-04-12T12:00:00Z",
	"bugzilla": {
		"description": "Privilege Escalation in grafana enterprise",
		"id": "2072429",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2072429"
	},
	"cvss3": {
		"cvss3_base_score": "8.0",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H",
		"status": "draft"
	},
	"cwe": "CWE-273",
	"details": [
		"Grafana is an open-source platform for monitoring and observability. When fine-grained access control is enabled and a client uses Grafana API Key to make requests, the permissions for that API Key are cached for 30 seconds for the given organization. Because of the way the cache ID is constructed, the consequent requests with any API Key evaluate to the same permissions as the previous requests. This can lead to an escalation of privileges, when for example a first request is made with Admin permissions, and the second request with different API Key is made with Viewer permissions, the second request will get the cached permissions from the previous Admin, essentially accessing higher privilege than it should. The vulnerability is only impacting Grafana Enterprise when the fine-grained access control beta feature is enabled and there are more than one API Keys in one organization with different roles assigned. All installations after Grafana Enterprise v8.1.0-beta1 should be upgraded as soon as possible. As an alternative, disable fine-grained access control will mitigate the vulnerability.",
		"A flaw was found in Grafana Enterprise. When the fine-grained access control beta feature is enabled, Grafana 8.1.0-beta1 introduces the Privilege Escalation vulnerability."
	],
	"statement": "Red Hat products do not ship the Grafana Enterprise version, therefore are not affected by this vulnerability.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2022-24812\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-24812\nhttps://grafana.com/blog/2022/04/12/grafana-enterprise-8.4.6-released-with-high-severity-security-fix/"
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:service_mesh:2.0",
			"fix_state": "Not affected",
			"package_name": "servicemesh-grafana",
			"product_name": "OpenShift Service Mesh 2.0"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:2.1",
			"fix_state": "Not affected",
			"package_name": "openshift-service-mesh/grafana-rhel8",
			"product_name": "OpenShift Service Mesh 2.1"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:2.1",
			"fix_state": "Not affected",
			"package_name": "servicemesh-grafana",
			"product_name": "OpenShift Service Mesh 2.1"
		},
		{
			"cpe": "cpe:/a:redhat:red_hat_3scale_amp:2",
			"fix_state": "Not affected",
			"package_name": "3scale-operator-bundle-container",
			"product_name": "Red Hat 3scale API Management Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:red_hat_3scale_amp:2",
			"fix_state": "Not affected",
			"package_name": "3scale-operator-container",
			"product_name": "Red Hat 3scale API Management Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/acm-grafana-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/grafana-dashboard-loader-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:quarkus:2",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat build of Quarkus"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:3",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Ceph Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:4",
			"fix_state": "Not affected",
			"package_name": "rhceph/rhceph-4-dashboard-rhel8",
			"product_name": "Red Hat Ceph Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:5",
			"fix_state": "Not affected",
			"package_name": "rhceph/rhceph-5-dashboard-rhel8",
			"product_name": "Red Hat Ceph Storage 5"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "grafana-pcp",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "grafana-pcp",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Not affected",
			"package_name": "openshift3/grafana",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "cluster-monitoring-operator-container",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-grafana",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "ose-thanos-container",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "prometheus-config-reloader-container",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "prometheus-operator-container",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_gitops:1",
			"fix_state": "Not affected",
			"package_name": "openshift-gitops-1/gitops-rhel8-operator",
			"product_name": "Red Hat OpenShift GitOps"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Storage 3"
		}
	],
	"upstream_fix": "grafana-enterprise 8.4.6",
	"csaw": false
}
