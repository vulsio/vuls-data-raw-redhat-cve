{
	"name": "CVE-2022-30550",
	"threat_severity": "Moderate",
	"public_date": "2022-07-06T00:00:00Z",
	"bugzilla": {
		"description": "dovecot: Privilege escalation when similar master and non-master passdbs are used",
		"id": "2105070",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2105070"
	},
	"cvss3": {
		"cvss3_base_score": "6.8",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N",
		"status": "verified"
	},
	"cwe": "CWE-284",
	"details": [
		"An issue was discovered in the auth component in Dovecot 2.2 and 2.3 before 2.3.20. When two passdb configuration entries exist with the same driver and args settings, incorrect username_filter and mechanism settings can be applied to passdb definitions. These incorrectly applied settings can lead to an unintended security configuration and can permit privilege escalation in certain configurations. The documentation does not advise against the use of passdb definitions that have the same driver and args settings. One such configuration would be where an administrator wishes to use the same PAM configuration or passwd file for both normal and master users but use the username_filter setting to restrict which of the users is able to be a master user.",
		"A vulnerability was found in the Dovecot IMAP Server. When two passdb configuration entries exist in the Dovecot configuration, which have the same driver and args settings, the incorrect username_filter and mechanism settings can be applied to passdb definitions. These incorrect settings can lead to an unintended security configuration and can permit privilege escalation with certain configurations involving a master user authentication. If the same passwd file or PAM is used for both normal and master users, an attacker could easily become a master user, potentially escalating privileges on the system."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2022-30550\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-30550\nhttps://dovecot.org/pipermail/dovecot-news/2022-July/000478.html"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Always authenticate master users from a different source than regular users, for example, use a separate passwd file. Alternatively, you can use global ACLs to ensure that only legitimate master users have privileged access."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2022:7623",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "dovecot-1:2.3.16-3.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2022-11-08T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:8208",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"package": "dovecot-1:2.3.16-7.el9",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2022-11-15T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "dovecot",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "dovecot",
			"product_name": "Red Hat Enterprise Linux 7"
		}
	],
	"csaw": false
}
