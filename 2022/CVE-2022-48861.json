{
	"name": "CVE-2022-48861",
	"threat_severity": "Moderate",
	"public_date": "2024-07-16T00:00:00Z",
	"bugzilla": {
		"description": "kernel: vdpa: fix use-after-free on vp_vdpa_remove",
		"id": "2298205",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2298205"
	},
	"cvss3": {
		"cvss3_base_score": "5.6",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:H",
		"status": "draft"
	},
	"cwe": "CWE-416",
	"details": [
		"In the Linux kernel, the following vulnerability has been resolved:\nvdpa: fix use-after-free on vp_vdpa_remove\nWhen vp_vdpa driver is unbind, vp_vdpa is freed in vdpa_unregister_device\nand then vp_vdpa->mdev.pci_dev is dereferenced in vp_modern_remove,\ntriggering use-after-free.\nCall Trace of unbinding driver free vp_vdpa :\ndo_syscall_64\nvfs_write\nkernfs_fop_write_iter\ndevice_release_driver_internal\npci_device_remove\nvp_vdpa_remove\nvdpa_unregister_device\nkobject_release\ndevice_release\nkfree\nCall Trace of dereference vp_vdpa->mdev.pci_dev:\nvp_modern_remove\npci_release_selected_regions\npci_release_region\npci_resource_len\npci_resource_end\n(dev)->resource[(bar)].end"
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2022-48861\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-48861\nhttps://lore.kernel.org/linux-cve-announce/2024071628-CVE-2022-48861-440e@gregkh/T"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
	},
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Will not fix",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Will not fix",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Will not fix",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Will not fix",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "kernel 5.15.29, kernel 5.16.15, kernel 5.17",
	"csaw": false
}
