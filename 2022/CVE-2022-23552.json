{
	"name": "CVE-2022-23552",
	"threat_severity": "Important",
	"public_date": "2023-01-27T00:00:00Z",
	"bugzilla": {
		"description": "persistent xss in grafana core plugins",
		"id": "2158420",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2158420"
	},
	"cvss3": {
		"cvss3_base_score": "7.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
		"status": "verified"
	},
	"cwe": "CWE-79",
	"details": [
		"Grafana is an open-source platform for monitoring and observability. Starting with the 8.1 branch and prior to versions 8.5.16, 9.2.10, and 9.3.4, Grafana had a stored XSS vulnerability affecting the core plugin GeoMap. The stored XSS vulnerability was possible because SVG files weren't properly sanitized and allowed arbitrary JavaScript to be executed in the context of the currently authorized user of the Grafana instance. An attacker needs to have the Editor role in order to change a panel to include either an external URL to a SVG-file containing JavaScript, or use the `data:` scheme to load an inline SVG-file containing JavaScript. This means that vertical privilege escalation is possible, where a user with Editor role can change to a known password for a user having Admin role if the user with Admin role executes malicious JavaScript viewing a dashboard. Users may upgrade to version 8.5.16, 9.2.10, or 9.3.4 to receive a fix.",
		"A flaw was found in The GeoMap and Canvas plugins of Grafana. The GeoMap and Canvas plugins are core plugins in Grafana, which means that all Grafana instances have GeoMap and Canvas installed. These two plugins are vulnerable to Cross-site scripting, where an attacker with an Editor role can add an SVG file containing malicious JavaScript code. The Javascript is executed when a user with an admin role later edits the GeoMap/Canvas panel."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2022-23552\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-23552\nhttps://grafana.com/blog/2023/01/25/grafana-security-releases-new-versions-with-fixes-for-cve-2022-23552-cve-2022-41912-and-cve-2022-39324/"
	],
	"acknowledgement": "Red Hat would like to thank Grafana Security Team for reporting this issue.",
	"affected_release": [
		{
			"advisory": "RHSA-2023:6420",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"impact": "moderate",
			"package": "grafana-0:9.2.10-7.el9_3",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2023-11-07T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:service_mesh:2.1",
			"fix_state": "Not affected",
			"package_name": "servicemesh-grafana",
			"product_name": "OpenShift Service Mesh 2.1"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/acm-grafana-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:3",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Ceph Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:4",
			"fix_state": "Not affected",
			"package_name": "rhceph/rhceph-4-dashboard-rhel8",
			"product_name": "Red Hat Ceph Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:5",
			"fix_state": "Not affected",
			"package_name": "rhceph/rhceph-5-dashboard-rhel8",
			"product_name": "Red Hat Ceph Storage 5"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"impact": "moderate",
			"package_name": "grafana",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-grafana",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Storage 3"
		}
	],
	"upstream_fix": "Grafana 8.5.19, Grafana 9.2.8.2, Grafana 9.3.2.2",
	"csaw": false
}
