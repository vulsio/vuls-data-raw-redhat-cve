{
	"name": "CVE-2022-2053",
	"threat_severity": "Moderate",
	"public_date": "2022-06-14T00:00:00Z",
	"bugzilla": {
		"description": "undertow: Large AJP request may cause DoS",
		"id": "2095862",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2095862"
	},
	"cvss3": {
		"cvss3_base_score": "7.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
		"status": "verified"
	},
	"cwe": "CWE-400->CWE-770",
	"details": [
		"When a POST request comes through AJP and the request exceeds the max-post-size limit (maxEntitySize), Undertow's AjpServerRequestConduit implementation closes a connection without sending any response to the client/proxy. This behavior results in that a front-end proxy marking the backend worker (application server) as an error state and not forward requests to the worker for a while. In mod_cluster, this continues until the next STATUS request (10 seconds intervals) from the application server updates the server state. So, in the worst case, it can result in \"All workers are in error state\" and mod_cluster responds \"503 Service Unavailable\" for a while (up to 10 seconds). In mod_proxy_balancer, it does not forward requests to the worker until the \"retry\" timeout passes. However, luckily, mod_proxy_balancer has \"forcerecovery\" setting (On by default; this parameter can force the immediate recovery of all workers without considering the retry parameter of the workers if all workers of a balancer are in error state.). So, unlike mod_cluster, mod_proxy_balancer does not result in responding \"503 Service Unavailable\". An attacker could use this behavior to send a malicious request and trigger server errors, resulting in DoS (denial of service). This flaw was fixed in Undertow 2.2.19.Final, Undertow 2.3.0.Alpha2.",
		"A flaw was found in Undertow. AJP requests to the server may allow an attacker to send a malicious request and trigger server errors, resulting in a denial of service."
	],
	"statement": "Red Hat Fuse 7 is now in Maintenance Support Phase and is marked Fixed. However, Red Hat Fuse Online does not contain the fix for this flaw.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2022-2053\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-2053"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2022:8652",
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"impact": "low",
			"package": "undertow",
			"product_name": "Red Hat Fuse 7.11.1",
			"release_date": "2022-11-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:6825",
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4",
			"package": "undertow",
			"product_name": "Red Hat JBoss Enterprise Application Platform 7",
			"release_date": "2022-10-05T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:6822",
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4::el8",
			"package": "eap7-undertow-0:2.2.19-1.SP2_redhat_00001.1.el8eap",
			"product_name": "Red Hat JBoss Enterprise Application Platform 7.4 for RHEL 8",
			"release_date": "2022-10-05T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:6823",
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4::el9",
			"package": "eap7-undertow-0:2.2.19-1.SP2_redhat_00001.1.el9eap",
			"product_name": "Red Hat JBoss Enterprise Application Platform 7.4 for RHEL 9",
			"release_date": "2022-10-05T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:6821",
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4::el7",
			"package": "eap7-undertow-0:2.2.19-1.SP2_redhat_00001.1.el7eap",
			"product_name": "Red Hat JBoss Enterprise Application Platform 7.4 on RHEL 7",
			"release_date": "2022-10-05T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:openshift_application_runtimes:1.0",
			"fix_state": "Not affected",
			"package_name": "undertow",
			"product_name": "Red Hat build of Quarkus"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:8",
			"fix_state": "Will not fix",
			"package_name": "undertow",
			"product_name": "Red Hat Data Grid 8"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7",
			"fix_state": "Not affected",
			"package_name": "undertow",
			"product_name": "Red Hat Decision Manager 7"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "undertow",
			"product_name": "Red Hat Integration Camel K"
		},
		{
			"cpe": "cpe:/a:redhat:camel_quarkus:2",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "undertow",
			"product_name": "Red Hat Integration Camel Quarkus"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Not affected",
			"package_name": "undertow",
			"product_name": "Red Hat Integration Service Registry"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:7",
			"fix_state": "Out of support scope",
			"impact": "low",
			"package_name": "undertow",
			"product_name": "Red Hat JBoss Data Grid 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:6",
			"fix_state": "Out of support scope",
			"impact": "low",
			"package_name": "undertow",
			"product_name": "Red Hat JBoss Fuse 6"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:13",
			"fix_state": "Out of support scope",
			"impact": "moderate",
			"package_name": "opendaylight",
			"product_name": "Red Hat OpenStack Platform 13 (Queens)"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7",
			"fix_state": "Not affected",
			"package_name": "undertow",
			"product_name": "Red Hat Process Automation 7"
		},
		{
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7",
			"fix_state": "Will not fix",
			"package_name": "undertow",
			"product_name": "Red Hat Single Sign-On 7"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_application_runtimes:1.0",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "undertow",
			"product_name": "Red Hat support for Spring Boot"
		}
	],
	"upstream_fix": "undertow 2.2.19.Final, undertow 2.3.0.Alpha2",
	"csaw": false
}
