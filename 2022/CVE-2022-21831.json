{
	"bugzilla": {
		"description": "Code injection vulnerability in ActiveStorage",
		"id": "2064747",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2064747"
	},
	"csaw": false,
	"cvss3": {
		"cvss3_base_score": "9.8",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
		"status": "draft"
	},
	"cwe": "CWE-94",
	"details": [
		"A code injection vulnerability exists in the Active Storage >= v5.2.0 that could allow an attacker to execute code via image_processing arguments.",
		"A flaw was found in the Active Storage module of Rails, where the transformation method or its arguments for image_processing are not trusted arbitrary input. This flaw allows an attacker to inject code in Rails."
	],
	"mitigation": {
		"lang": "en:us",
		"value": "To work around this issue, applications should implement a strict allow-list on accepted transformation methods or arguments. Additionally, a strict image magick security policy will help mitigate this issue:\nhttps://imagemagick.org/script/security-policy.php"
	},
	"name": "CVE-2022-21831",
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Affected",
			"package_name": "tfm-ror52-rubygem-rails",
			"product_name": "Red Hat Satellite 6"
		}
	],
	"public_date": "2022-03-08T00:00:00Z",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2022-21831\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-21831\nhttps://github.com/advisories/GHSA-w749-p3v6-hccq"
	],
	"threat_severity": "Important",
	"upstream_fix": "rails 7.0.2.3, rails 6.0.4.7, rails 6.1.4.7, rails 5.2.6.3"
}
