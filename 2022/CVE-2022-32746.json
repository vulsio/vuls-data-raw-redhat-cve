{
	"name": "CVE-2022-32746",
	"threat_severity": "Moderate",
	"public_date": "2022-07-27T00:00:00Z",
	"bugzilla": {
		"description": "samba: AD users can induce a use-after-free in the server process with an LDAP add or modify request",
		"id": "2108215",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2108215"
	},
	"cvss3": {
		"cvss3_base_score": "5.4",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L",
		"status": "verified"
	},
	"cwe": "CWE-416",
	"details": [
		"A flaw was found in the Samba AD LDAP server. The AD DC database audit logging module can access LDAP message values freed by a preceding database module, resulting in a use-after-free issue. This issue is only possible when modifying certain privileged attributes, such as userAccountControl.",
		"A flaw was found in the Samba AD LDAP server. The AD DC database audit logging module can access LDAP message values freed by a preceding database module, resulting in a use-after-free issue. This issue is only possible when modifying certain privileged attributes, such as userAccountControl."
	],
	"statement": "Although versions of Samba shipped with Red Hat Enterprise Linux do not support Samba in AD mode, the affected code is shipped in RHEL with the `libldb` package.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2022-32746\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-32746\nhttps://www.samba.org/samba/security/CVE-2022-32746.html"
	],
	"acknowledgement": "Upstream acknowledges Andrew Bartlett (Catalyst) and Joseph Sutton (Catalyst) as the original reporters.",
	"mitigation": {
		"lang": "en:us",
		"value": "Disabling the AD DC database audit logging prevents the use-after-free from occurring, as that is the only component that will access the original message."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2022:7730",
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"package": "libldb-0:2.5.2-2.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2022-11-08T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:8318",
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"package": "libldb-0:2.5.2-1.el9",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2022-11-15T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "libldb",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "samba",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "samba4",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "libldb",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "samba",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "samba",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "samba",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Will not fix",
			"package_name": "libldb",
			"product_name": "Red Hat Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Not affected",
			"package_name": "samba",
			"product_name": "Red Hat Storage 3"
		}
	],
	"upstream_fix": "samba 4.16.4, samba 4.15.9, samba 4.14.14",
	"csaw": false
}
