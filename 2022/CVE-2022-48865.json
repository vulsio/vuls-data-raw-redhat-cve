{
	"name": "CVE-2022-48865",
	"threat_severity": "Moderate",
	"public_date": "2024-07-16T00:00:00Z",
	"bugzilla": {
		"description": "kernel: tipc: fix kernel panic when enabling bearer",
		"id": "2298209",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2298209"
	},
	"cvss3": {
		"cvss3_base_score": "5.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
		"status": "draft"
	},
	"cwe": "CWE-362",
	"details": [
		"In the Linux kernel, the following vulnerability has been resolved:\ntipc: fix kernel panic when enabling bearer\nWhen enabling a bearer on a node, a kernel panic is observed:\n[    4.498085] RIP: 0010:tipc_mon_prep+0x4e/0x130 [tipc]\n...\n[    4.520030] Call Trace:\n[    4.520689]  <IRQ>\n[    4.521236]  tipc_link_build_proto_msg+0x375/0x750 [tipc]\n[    4.522654]  tipc_link_build_state_msg+0x48/0xc0 [tipc]\n[    4.524034]  __tipc_node_link_up+0xd7/0x290 [tipc]\n[    4.525292]  tipc_rcv+0x5da/0x730 [tipc]\n[    4.526346]  ? __netif_receive_skb_core+0xb7/0xfc0\n[    4.527601]  tipc_l2_rcv_msg+0x5e/0x90 [tipc]\n[    4.528737]  __netif_receive_skb_list_core+0x20b/0x260\n[    4.530068]  netif_receive_skb_list_internal+0x1bf/0x2e0\n[    4.531450]  ? dev_gro_receive+0x4c2/0x680\n[    4.532512]  napi_complete_done+0x6f/0x180\n[    4.533570]  virtnet_poll+0x29c/0x42e [virtio_net]\n...\nThe node in question is receiving activate messages in another\nthread after changing bearer status to allow message sending/\nreceiving in current thread:\nthread 1           |              thread 2\n--------           |              --------\n|\ntipc_enable_bearer()        |\ntest_and_set_bit_lock()   |\ntipc_bearer_xmit_skb()  |\n| tipc_l2_rcv_msg()\n|   tipc_rcv()\n|     __tipc_node_link_up()\n|       tipc_link_build_state_msg()\n|         tipc_link_build_proto_msg()\n|           tipc_mon_prep()\n|           {\n|             ...\n|             // null-pointer dereference\n|             u16 gen = mon->dom_gen;\n|             ...\n|           }\n// Not being executed yet |\ntipc_mon_create()         |\n{                         |\n...                     |\n// allocate             |\nmon = kzalloc();        |\n...                     |\n}                         |\nMonitoring pointer in thread 2 is dereferenced before monitoring data\nis allocated in thread 1. This causes kernel panic.\nThis commit fixes it by allocating the monitoring data before enabling\nthe bearer to receive messages."
	],
	"statement": "rhel-8.10)",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2022-48865\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-48865\nhttps://lore.kernel.org/linux-cve-announce/2024071629-CVE-2022-48865-bd8b@gregkh/T"
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Will not fix",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Will not fix",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "kernel 5.10.106, kernel 5.15.29, kernel 5.16.15, kernel 5.17",
	"csaw": false
}
