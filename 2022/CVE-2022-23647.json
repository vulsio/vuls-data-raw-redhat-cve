{
	"affected_release": [
		{
			"advisory": "RHSA-2022:8524",
			"cpe": "cpe:/a:redhat:jboss_data_grid:8",
			"impact": "moderate",
			"package": "prismjs",
			"product_name": "Red Hat Data Grid 8.4.0",
			"release_date": "2022-11-17T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:6835",
			"cpe": "cpe:/a:redhat:service_registry:2.3",
			"impact": "moderate",
			"package": "prismjs",
			"product_name": "RHINT Service Registry 2.3.0 GA",
			"release_date": "2022-10-06T00:00:00Z"
		}
	],
	"bugzilla": {
		"description": "improperly escaped output allows a XSS",
		"id": "2056643",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2056643"
	},
	"csaw": false,
	"cvss3": {
		"cvss3_base_score": "6.1",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
		"status": "verified"
	},
	"cwe": "CWE-79",
	"details": [
		"Prism is a syntax highlighting library. Starting with version 1.14.0 and prior to version 1.27.0, Prism's command line plugin can be used by attackers to achieve a cross-site scripting attack. The command line plugin did not properly escape its output, leading to the input text being inserted into the DOM as HTML code. Server-side usage of Prism is not impacted. Websites that do not use the Command Line plugin are also not impacted. This bug has been fixed in v1.27.0. As a workaround, do not use the command line plugin on untrusted inputs, or sanitize all code blocks (remove all HTML code text) from all code blocks that use the command line plugin.",
		"A Cross-site scripting attack was found in Prism. The command-line plugin did not properly escape its output. This issue leads to the input text being inserted into the Document Object Model (DOM) as HTML code, which can be exploited by an attacker."
	],
	"name": "CVE-2022-23647",
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:migration_toolkit_virtualization:2",
			"fix_state": "Not affected",
			"package_name": "migration-toolkit-virtualization/mtv-ui-rhel8",
			"product_name": "Migration Toolkit for Virtualization"
		},
		{
			"cpe": "cpe:/a:redhat:ocp_tools",
			"fix_state": "Fix deferred",
			"package_name": "odo",
			"product_name": "OpenShift Developer Tools and Services"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:2.0",
			"fix_state": "Not affected",
			"package_name": "servicemesh-grafana",
			"product_name": "OpenShift Service Mesh 2.0"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:2.1",
			"fix_state": "Not affected",
			"package_name": "openshift-service-mesh/kiali-rhel8",
			"product_name": "OpenShift Service Mesh 2.1"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:2.1",
			"fix_state": "Not affected",
			"package_name": "servicemesh-grafana",
			"product_name": "OpenShift Service Mesh 2.1"
		},
		{
			"cpe": "cpe:/a:redhat:red_hat_3scale_amp:2",
			"fix_state": "Affected",
			"package_name": "3scale-apicast-operator-bundle-container",
			"product_name": "Red Hat 3scale API Management Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:red_hat_3scale_amp:2",
			"fix_state": "Affected",
			"package_name": "3scale-apicast-operator-container",
			"product_name": "Red Hat 3scale API Management Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:advanced_cluster_security:3",
			"fix_state": "Not affected",
			"package_name": "advanced-cluster-security/rhacs-docs-rhel8",
			"product_name": "Red Hat Advanced Cluster Security 3"
		},
		{
			"cpe": "cpe:/a:redhat:advanced_cluster_security:3",
			"fix_state": "Not affected",
			"package_name": "advanced-cluster-security/rhacs-main-rhel8",
			"product_name": "Red Hat Advanced Cluster Security 3"
		},
		{
			"cpe": "cpe:/a:redhat:advanced_cluster_security:3",
			"fix_state": "Not affected",
			"package_name": "advanced-cluster-security/rhacs-rhel8-operator",
			"product_name": "Red Hat Advanced Cluster Security 3"
		},
		{
			"cpe": "cpe:/a:redhat:advanced_cluster_security:3",
			"fix_state": "Not affected",
			"package_name": "advanced-cluster-security/rhacs-roxctl-rhel8",
			"product_name": "Red Hat Advanced Cluster Security 3"
		},
		{
			"cpe": "cpe:/a:redhat:amq_online:1",
			"fix_state": "Will not fix",
			"impact": "moderate",
			"package_name": "prismjs",
			"product_name": "Red Hat A-MQ Online"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Not affected",
			"package_name": "aap-azure-ui",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:3",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Ceph Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:4",
			"fix_state": "Not affected",
			"package_name": "rhceph/rhceph-4-dashboard-rhel8",
			"product_name": "Red Hat Ceph Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:5",
			"fix_state": "Not affected",
			"package_name": "rhceph/rhceph-5-dashboard-rhel8",
			"product_name": "Red Hat Ceph Storage 5"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"impact": "moderate",
			"package_name": "grafana",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Not affected",
			"impact": "moderate",
			"package_name": "prismjs",
			"product_name": "Red Hat Integration Camel K"
		},
		{
			"cpe": "cpe:/a:redhat:camel_quarkus:2",
			"fix_state": "Not affected",
			"impact": "moderate",
			"package_name": "prismjs",
			"product_name": "Red Hat Integration Camel Quarkus"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Not affected",
			"impact": "moderate",
			"package_name": "prismjs",
			"product_name": "Red Hat Integration Data Virtualisation Operator"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Out of support scope",
			"package_name": "prismjs",
			"product_name": "Red Hat Integration Service Registry"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Not affected",
			"package_name": "openshift3/grafana",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-grafana",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_gitops:1",
			"fix_state": "Will not fix",
			"package_name": "openshift-gitops-1/argocd-rhel8",
			"product_name": "Red Hat OpenShift GitOps"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Storage 3"
		}
	],
	"public_date": "2022-02-18T00:00:00Z",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2022-23647\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-23647\nhttps://github.com/PrismJS/prism/security/advisories/GHSA-3949-f494-cm99"
	],
	"statement": "This issue affects Prism as shipped with all versions of Red Hat Ceph Storage, Red Hat Migration Toolkit for Virtualization, Red Hat OpenShift Container Platform, Red Hat OpenShift Service Mesh, Red Hat Advanced Cluster Security, and Red Hat Gluster Storage. However, this flaw is not known to be exploitable under any supported scenario, as websites that do not use the Command Line plugin are also not impacted. The above products do not use the Command Line plugin, thus, are marked not affected.",
	"threat_severity": "Important",
	"upstream_fix": "prismjs 1.27.0"
}
