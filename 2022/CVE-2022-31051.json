{
	"name": "CVE-2022-31051",
	"threat_severity": "Moderate",
	"public_date": "2022-06-09T00:00:00Z",
	"bugzilla": {
		"description": "Masked secrets can be disclosed if they contain characters that are excluded from uri encoding",
		"id": "2097414",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2097414"
	},
	"cvss3": {
		"cvss3_base_score": "7.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
		"status": "verified"
	},
	"cwe": "CWE-212",
	"details": [
		"semantic-release is an open source npm package for automated version management and package publishing. In affected versions secrets that would normally be masked by semantic-release can be accidentally disclosed if they contain characters that are excluded from uri encoding by `encodeURI`. Occurrence is further limited to execution contexts where push access to the related repository is not available without modifying the repository url to inject credentials. Users are advised to upgrade. Users unable to upgrade should ensure that secrets that do not contain characters that are excluded from encoding with `encodeURI` when included in a URL are already masked properly.",
		"A vulnerability was found in semantic-release. Secrets that are normally masked are accidentally disclosed if they contain characters excluded from uri encoding by `encodeURI()`. The vulnerability is further limited to execution contexts where push access to the related repository is unavailable without modifying the repository URL to inject credentials."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2022-31051\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-31051\nhttps://github.com/semantic-release/semantic-release/security/advisories/GHSA-x2pg-mjhr-2m5x"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Users should ensure that secrets that do not contain characters that are excluded from encoding with `encodeURI` when included in a URL that is already masked properly."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2022:5555",
			"cpe": "cpe:/a:redhat:rhev_manager:4.4:el8",
			"package": "ovirt-web-ui-0:1.9.0-1.el8ev",
			"product_name": "Red Hat Virtualization Engine 4.4",
			"release_date": "2022-07-14T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:directory_server:11",
			"fix_state": "Not affected",
			"package_name": "redhat-ds:11/389-ds-base",
			"product_name": "Red Hat Directory Server 11"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "389-ds:1.4/389-ds-base",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "cockpit",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "cockpit-appstream",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "container-tools:rhel8/cockpit-podman",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/a:redhat:enterprise_linux:8::hypervisor",
			"fix_state": "Affected",
			"package_name": "ovirt-engine-ui-extensions",
			"product_name": "Red Hat Virtualization 4"
		}
	],
	"upstream_fix": "semantic-release 19.0.3",
	"csaw": false
}
