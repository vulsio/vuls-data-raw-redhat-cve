{
	"name": "CVE-2024-0985",
	"threat_severity": "Important",
	"public_date": "2024-02-08T00:00:00Z",
	"bugzilla": {
		"description": "postgresql: non-owner 'REFRESH MATERIALIZED VIEW CONCURRENTLY' executes arbitrary SQL",
		"id": "2263384",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2263384"
	},
	"cvss3": {
		"cvss3_base_score": "8.0",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-271",
	"details": [
		"Late privilege drop in REFRESH MATERIALIZED VIEW CONCURRENTLY in PostgreSQL allows an object creator to execute arbitrary SQL functions as the command issuer. The command intends to run SQL functions as the owner of the materialized view, enabling safe refresh of untrusted materialized views. The victim is a superuser or member of one of the attacker's roles. The attack requires luring the victim into running REFRESH MATERIALIZED VIEW CONCURRENTLY on the attacker's materialized view. As part of exploiting this vulnerability, the attacker creates functions that use CREATE RULE to convert the internally-built temporary table to a view. Versions before PostgreSQL 15.6, 14.11, 13.14, and 12.18 are affected. The only known exploit does not work in PostgreSQL 16 and later. For defense in depth, PostgreSQL 16.2 adds the protections that older branches are using to fix their vulnerability.",
		"A flaw was found in PostgreSQL. A late privilege drop in REFRESH MATERIALIZED VIEW CONCURRENTLY in PostgreSQL can allow an object creator to execute arbitrary SQL functions as the command issuer. The command intends to run SQL functions as the owner of the materialized view, enabling a safe refresh of untrusted materialized views. The attack requires luring the victim, a superuser or member of one of the attacker's roles, into running REFRESH MATERIALIZED VIEW CONCURRENTLY on the attacker's materialized view."
	],
	"statement": "This PostgreSQL vulnerability poses a significant risk due to its potential for unauthorized access and manipulation of data. Essentially, it allows attackers to execute arbitrary SQL functions using the REFRESH MATERIALIZED VIEW CONCURRENTLY command, especially when the victim is a superuser or holds a role within the attacker's control. By luring victims into running this command on a maliciously crafted materialized view, attackers can exploit the system. This could lead to serious consequences, such as data breaches or data corruption, compromising the integrity and confidentiality of the database.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-0985\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-0985"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2024:0956",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "postgresql:10-8090020240213200157.a75119d5",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2024-02-26T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:0973",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "postgresql:15-8090020240209124629.a75119d5",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2024-02-26T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:0974",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "postgresql:12-8090020240209130909.a75119d5",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2024-02-26T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:0975",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "postgresql:13-8090020240209125046.a75119d5",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2024-02-26T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1071",
			"cpe": "cpe:/a:redhat:rhel_aus:8.2",
			"package": "postgresql:12-8020020240214021628.4cda2c84",
			"product_name": "Red Hat Enterprise Linux 8.2 Advanced Update Support",
			"release_date": "2024-03-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1071",
			"cpe": "cpe:/a:redhat:rhel_tus:8.2",
			"package": "postgresql:12-8020020240214021628.4cda2c84",
			"product_name": "Red Hat Enterprise Linux 8.2 Telecommunications Update Service",
			"release_date": "2024-03-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1071",
			"cpe": "cpe:/a:redhat:rhel_e4s:8.2",
			"package": "postgresql:12-8020020240214021628.4cda2c84",
			"product_name": "Red Hat Enterprise Linux 8.2 Update Services for SAP Solutions",
			"release_date": "2024-03-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1070",
			"cpe": "cpe:/a:redhat:rhel_eus:8.6",
			"package": "postgresql:12-8060020240214083443.ad008a3a",
			"product_name": "Red Hat Enterprise Linux 8.6 Extended Update Support",
			"release_date": "2024-03-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1017",
			"cpe": "cpe:/a:redhat:rhel_eus:8.8",
			"package": "postgresql:15-8080020240220104521.63b34585",
			"product_name": "Red Hat Enterprise Linux 8.8 Extended Update Support",
			"release_date": "2024-02-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1069",
			"cpe": "cpe:/a:redhat:rhel_eus:8.8",
			"package": "postgresql:12-8080020240214025906.63b34585",
			"product_name": "Red Hat Enterprise Linux 8.8 Extended Update Support",
			"release_date": "2024-03-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:0950",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"package": "postgresql:15-9030020240209100638.rhel9",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2024-02-22T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:0951",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"package": "postgresql-0:13.14-1.el9_3",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2024-02-22T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:0988",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-postgresql13-postgresql-0:13.14-1.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2024-02-26T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:0990",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-postgresql12-postgresql-0:12.18-1.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2024-02-26T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:0992",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-postgresql10-postgresql-0:10.23-3.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2024-02-26T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:serverless:1",
			"fix_state": "Under investigation",
			"package_name": "postgresql",
			"product_name": "OpenShift Serverless"
		},
		{
			"cpe": "cpe:/a:redhat:optaplanner:::el6",
			"fix_state": "Under investigation",
			"package_name": "postgresql",
			"product_name": "Red Hat build of OptaPlanner 8"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:8",
			"fix_state": "Not affected",
			"package_name": "postgresql",
			"product_name": "Red Hat Data Grid 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "postgresql",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "postgresql",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "postgresql:16/postgresql",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "postgresql:16/postgresql",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:debezium:2",
			"fix_state": "Not affected",
			"package_name": "postgresql",
			"product_name": "Red Hat Integration Change Data Capture"
		},
		{
			"cpe": "cpe:/a:redhat:service_registry:2",
			"fix_state": "Not affected",
			"package_name": "postgresql",
			"product_name": "Red Hat Integration Service Registry"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:7",
			"fix_state": "Not affected",
			"package_name": "postgresql",
			"product_name": "Red Hat JBoss Data Grid 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"fix_state": "Not affected",
			"package_name": "postgresql",
			"product_name": "Red Hat JBoss Fuse 7"
		}
	],
	"upstream_fix": "postgresql 12.18, postgresql 13.14, postgresql 14.11, postgresql 15.6",
	"csaw": false
}
