{
	"name": "CVE-2024-45812",
	"threat_severity": "Moderate",
	"public_date": "2024-09-17T20:15:06Z",
	"bugzilla": {
		"description": "vite: XSS via DOM Clobbering gadget found in vite bundled scripts",
		"id": "2312935",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2312935"
	},
	"cvss3": {
		"cvss3_base_score": "6.4",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:H",
		"status": "verified"
	},
	"cwe": "CWE-79",
	"details": [
		"Vite a frontend build tooling framework for javascript. Affected versions of vite were discovered to contain a DOM Clobbering vulnerability when building scripts to `cjs`/`iife`/`umd` output format. The DOM Clobbering gadget in the module can lead to cross-site scripting (XSS) in web pages where scriptless attacker-controlled HTML elements (e.g., an img tag with an unsanitized name attribute) are present. DOM Clobbering is a type of code-reuse attack where the attacker first embeds a piece of non-script, seemingly benign HTML markups in the webpage (e.g. through a post or comment) and leverages the gadgets (pieces of js code) living in the existing javascript code to transform it into executable code. We have identified a DOM Clobbering vulnerability in Vite bundled scripts, particularly when the scripts dynamically import other scripts from the assets folder and the developer sets the build output format to `cjs`, `iife`, or `umd`. In such cases, Vite replaces relative paths starting with `__VITE_ASSET__` using the URL retrieved from `document.currentScript`. However, this implementation is vulnerable to a DOM Clobbering attack. The `document.currentScript` lookup can be shadowed by an attacker via the browser's named DOM tree element access mechanism. This manipulation allows an attacker to replace the intended script element with a malicious HTML element. When this happens, the src attribute of the attacker-controlled element is used as the URL for importing scripts, potentially leading to the dynamic loading of scripts from an attacker-controlled server. This vulnerability can result in cross-site scripting (XSS) attacks on websites that include Vite-bundled files (configured with an output format of `cjs`, `iife`, or `umd`) and allow users to inject certain scriptless HTML tags without properly sanitizing the name or id attributes. This issue has been patched in versions 5.4.6, 5.3.6, 5.2.14, 4.5.5, and 3.2.11. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
		"A DOM clobbering vulnerability was found in ViteJS. This may lead to cross-site scripting (XSS) attacks on websites that include Vite-bundled files configured with an output format of cjs, iife, or umd, and allow users to inject certain scriptless HTML tags without properly sanitizing the name or id attributes."
	],
	"statement": "This issue is classified as moderate severity rather than important due to the specific conditions required to exploit the vulnerability. While DOM Clobbering can lead to Cross-Site Scripting (XSS), the attack surface is relatively limited. Exploitation is contingent on the presence of unsanitized user-supplied HTML with certain scriptless attributes (`name`, `id`) and the use of particular Vite build outputs (`cjs`, `iife`, `umd`). In environments following proper input sanitization practices, the risk is significantly mitigated. Moreover, the vulnerability does not enable direct code injection or compromise by default but rather leverages existing script elements, reducing the likelihood of widespread exploitation compared to higher severity issues.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-45812\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-45812\nhttps://github.com/vitejs/vite/commit/ade1d89660e17eedfd35652165b0c26905259fad\nhttps://github.com/vitejs/vite/security/advisories/GHSA-64vr-g452-qvp3\nhttps://github.com/webpack/webpack/security/advisories/GHSA-4vvj-4cpr-p986\nhttps://research.securitum.com/xss-in-amp4email-dom-clobbering\nhttps://scnps.co/papers/sp23_domclob.pdf"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2024:10917",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-agent-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:10917",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-all-in-one-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:10917",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-collector-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:10917",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-es-index-cleaner-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:10917",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-es-rollover-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:10917",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-ingester-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:10917",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-operator-bundle",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:10917",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-query-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:10917",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-rhel8-operator",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:10962",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-agent-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:10962",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-all-in-one-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:10962",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-collector-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:10962",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-es-index-cleaner-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:10962",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-es-rollover-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:10962",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-ingester-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:10962",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-operator-bundle",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:10962",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-query-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:10962",
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.4::el8",
			"package": "jaeger-rhel8-operator",
			"product_name": "Red Hat OpenShift distributed tracing 3",
			"release_date": "2024-12-11T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Affected",
			"package_name": "automation-controller",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Not affected",
			"package_name": "automation-eda-controller",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:8",
			"fix_state": "Not affected",
			"package_name": "vite",
			"product_name": "Red Hat JBoss Enterprise Application Platform 8"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3",
			"fix_state": "Not affected",
			"package_name": "rhosdt/jaeger-agent-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3",
			"fix_state": "Affected",
			"package_name": "rhosdt/jaeger-all-in-one-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3",
			"fix_state": "Not affected",
			"package_name": "rhosdt/jaeger-collector-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3",
			"fix_state": "Not affected",
			"package_name": "rhosdt/jaeger-es-index-cleaner-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3",
			"fix_state": "Not affected",
			"package_name": "rhosdt/jaeger-es-rollover-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3",
			"fix_state": "Not affected",
			"package_name": "rhosdt/jaeger-ingester-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:3",
			"fix_state": "Affected",
			"package_name": "rhosdt/jaeger-query-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 3"
		}
	],
	"csaw": false
}
