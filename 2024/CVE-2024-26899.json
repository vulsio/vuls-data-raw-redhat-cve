{
	"name": "CVE-2024-26899",
	"threat_severity": "Moderate",
	"public_date": "2024-04-17T00:00:00Z",
	"bugzilla": {
		"description": "kernel: block: fix deadlock between bd_link_disk_holder and partition scan",
		"id": "2275650",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2275650"
	},
	"cvss3": {
		"cvss3_base_score": "4.4",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H",
		"status": "draft"
	},
	"cwe": "CWE-833",
	"details": [
		"In the Linux kernel, the following vulnerability has been resolved:\nblock: fix deadlock between bd_link_disk_holder and partition scan\n'open_mutex' of gendisk is used to protect open/close block devices. But\nin bd_link_disk_holder(), it is used to protect the creation of symlink\nbetween holding disk and slave bdev, which introduces some issues.\nWhen bd_link_disk_holder() is called, the driver is usually in the process\nof initialization/modification and may suspend submitting io. At this\ntime, any io hold 'open_mutex', such as scanning partitions, can cause\ndeadlocks. For example, in raid:\nT1                              T2\nbdev_open_by_dev\nlock open_mutex [1]\n...\nefi_partition\n...\nmd_submit_bio\nmd_ioctl mddev_syspend\n-> suspend all io\nmd_add_new_disk\nbind_rdev_to_array\nbd_link_disk_holder\ntry lock open_mutex [2]\nmd_handle_request\n-> wait mddev_resume\nT1 scan partition, T2 add a new device to raid. T1 waits for T2 to resume\nmddev, but T2 waits for open_mutex held by T1. Deadlock occurs.\nFix it by introducing a local mutex 'blk_holder_mutex' to replace\n'open_mutex'."
	],
	"statement": "Red Hat Enterprise Linux 8 is not affected by this vulnerability.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-26899\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-26899\nhttps://lore.kernel.org/linux-cve-announce/2024041745-CVE-2024-26899-3f41@gregkh/T"
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "kernel 6.7.11, kernel 6.8.2, kernel 6.9-rc1",
	"csaw": false
}
