{
	"name": "CVE-2024-3183",
	"threat_severity": "Important",
	"public_date": "2024-06-10T00:00:00Z",
	"bugzilla": {
		"description": "freeipa: user can obtain a hash of the passwords of all domain users and perform offline brute force",
		"id": "2270685",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2270685"
	},
	"cvss3": {
		"cvss3_base_score": "8.1",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
		"status": "verified"
	},
	"cwe": "CWE-916",
	"details": [
		"A vulnerability was found in FreeIPA in a way when a Kerberos TGS-REQ is encrypted using the client’s session key. This key is different for each new session, which protects it from brute force attacks. However, the ticket it contains is encrypted using the target principal key directly. For user principals, this key is a hash of a public per-principal randomly-generated salt and the user’s password.\nIf a principal is compromised it means the attacker would be able to retrieve tickets encrypted to any principal, all of them being encrypted by their own key directly. By taking these tickets and salts offline, the attacker could run brute force attacks to find character strings able to decrypt tickets when combined to a principal salt (i.e. find the principal’s password)."
	],
	"statement": "This kind of attacks primarily affect user principals, not service principals because their keys are usually generated randomly. But weak user passwords are particularly vulnerable to such attacks, especially if they are referenced in password dictionaries.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-3183\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-3183\nhttps://www.freeipa.org/release-notes/4-12-1.html"
	],
	"acknowledgement": "Red Hat would like to thank Mikhail Sukhov for reporting this issue.",
	"mitigation": {
		"lang": "en:us",
		"value": "To mitigate this vulnerability, ticket requests to user principals are now disallowed in FreeIPA realms by default. This will keep attackers from obtaining data encrypted with the user key directly."
	},
	"upstream_fix": "FreeIPA 4.11.2, FreeIPA 4.12.1",
	"csaw": false
}
