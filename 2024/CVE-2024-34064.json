{
	"name": "CVE-2024-34064",
	"threat_severity": "Moderate",
	"public_date": "2024-05-06T00:00:00Z",
	"bugzilla": {
		"description": "jinja2: accepts keys containing non-attribute characters",
		"id": "2279476",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2279476"
	},
	"cvss3": {
		"cvss3_base_score": "5.4",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N",
		"status": "verified"
	},
	"cwe": "CWE-79",
	"details": [
		"Jinja is an extensible templating engine. The `xmlattr` filter in affected versions of Jinja accepts keys containing non-attribute characters. XML/HTML attributes cannot contain spaces, `/`, `>`, or `=`, as each would then be interpreted as starting a separate attribute. If an application accepts keys (as opposed to only values) as user input, and renders these in pages that other users see as well, an attacker could use this to inject other attributes and perform XSS. The fix for CVE-2024-22195 only addressed spaces but not other characters. Accepting keys as user input is now explicitly considered an unintended use case of the `xmlattr` filter, and code that does so without otherwise validating the input should be flagged as insecure, regardless of Jinja version. Accepting _values_ as user input continues to be safe. This vulnerability is fixed in 3.1.4."
	],
	"statement": "The fix for CVE-2024-22195 only addressed spaces, not other characters. Accepting keys as user input is now explicitly considered an unintended use case of the `xmlattr` filter, and code that does so without otherwise validating the input should be flagged as insecure, regardless of Jinja version. Accepting _values_ as user input continues to be safe.\nFence agents on RHEL 8 has been fixed as a part of https://access.redhat.com/errata/RHBA-2024:4238",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-34064\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-34064\nhttps://github.com/pallets/jinja/security/advisories/GHSA-h75v-3vvj-5mfj"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Do not accept user input as keys to the xmlattr filter without validation. See the statement above for more information."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2024:6011",
			"cpe": "cpe:/a:redhat:openshift_ironic:4.13::el9",
			"package": "python-jinja2-0:3.0.1-3.el9.1",
			"product_name": "Ironic content for Red Hat OpenShift Container Platform 4.13",
			"release_date": "2024-09-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:3781",
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2.4::el8",
			"package": "python3x-jinja2-0:3.1.4-1.el8ap",
			"product_name": "Red Hat Ansible Automation Platform 2.4 for RHEL 8",
			"release_date": "2024-06-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4522",
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2.4::el8",
			"package": "automation-controller-0:4.5.8-1.el8ap",
			"product_name": "Red Hat Ansible Automation Platform 2.4 for RHEL 8",
			"release_date": "2024-07-12T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:3781",
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2.4::el9",
			"package": "python-jinja2-0:3.1.4-1.el9ap",
			"product_name": "Red Hat Ansible Automation Platform 2.4 for RHEL 9",
			"release_date": "2024-06-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4522",
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2.4::el9",
			"package": "automation-controller-0:4.5.8-1.el9ap",
			"product_name": "Red Hat Ansible Automation Platform 2.4 for RHEL 9",
			"release_date": "2024-07-12T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4231",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "python-jinja2-0:2.10.1-5.el8_10",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2024-07-02T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:3795",
			"cpe": "cpe:/a:redhat:rhel_aus:8.4",
			"package": "fence-agents-0:4.2.1-65.el8_4.15",
			"product_name": "Red Hat Enterprise Linux 8.4 Advanced Mission Critical Update Support",
			"release_date": "2024-06-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:3795",
			"cpe": "cpe:/a:redhat:rhel_tus:8.4",
			"package": "fence-agents-0:4.2.1-65.el8_4.15",
			"product_name": "Red Hat Enterprise Linux 8.4 Telecommunications Update Service",
			"release_date": "2024-06-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:3795",
			"cpe": "cpe:/a:redhat:rhel_e4s:8.4",
			"package": "fence-agents-0:4.2.1-65.el8_4.15",
			"product_name": "Red Hat Enterprise Linux 8.4 Update Services for SAP Solutions",
			"release_date": "2024-06-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4404",
			"cpe": "cpe:/a:redhat:rhel_aus:8.6",
			"package": "fence-agents-0:4.2.1-89.el8_6.12",
			"product_name": "Red Hat Enterprise Linux 8.6 Advanced Mission Critical Update Support",
			"release_date": "2024-07-09T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4404",
			"cpe": "cpe:/a:redhat:rhel_tus:8.6",
			"package": "fence-agents-0:4.2.1-89.el8_6.12",
			"product_name": "Red Hat Enterprise Linux 8.6 Telecommunications Update Service",
			"release_date": "2024-07-09T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4404",
			"cpe": "cpe:/a:redhat:rhel_e4s:8.6",
			"package": "fence-agents-0:4.2.1-89.el8_6.12",
			"product_name": "Red Hat Enterprise Linux 8.6 Update Services for SAP Solutions",
			"release_date": "2024-07-09T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:3811",
			"cpe": "cpe:/a:redhat:rhel_eus:8.8",
			"package": "fence-agents-0:4.2.1-112.el8_8.6",
			"product_name": "Red Hat Enterprise Linux 8.8 Extended Update Support",
			"release_date": "2024-06-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:3820",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"package": "fence-agents-0:4.10.0-62.el9_4.3",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2024-06-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4414",
			"cpe": "cpe:/a:redhat:rhel_e4s:9.0",
			"package": "fence-agents-0:4.10.0-20.el9_0.13",
			"product_name": "Red Hat Enterprise Linux 9.0 Update Services for SAP Solutions",
			"release_date": "2024-07-09T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4427",
			"cpe": "cpe:/a:redhat:rhel_eus:9.2",
			"package": "fence-agents-0:4.10.0-43.el9_2.6",
			"product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
			"release_date": "2024-07-09T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4958",
			"cpe": "cpe:/a:redhat:openshift_ironic:4.15::el9",
			"package": "python-jinja2-0:3.0.1-3.el9.1",
			"product_name": "Red Hat OpenShift Container Platform 4.15",
			"release_date": "2024-08-07T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4616",
			"cpe": "cpe:/a:redhat:openshift_ironic:4.16::el9",
			"package": "python-jinja2-0:3.0.1-3.el9.1",
			"product_name": "Red Hat OpenShift Container Platform 4.16",
			"release_date": "2024-07-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:5662",
			"cpe": "cpe:/a:redhat:satellite:6.15::el8",
			"package": "python-jinja2-0:3.1.4-1.el8pc",
			"product_name": "Red Hat Satellite 6.15 for RHEL 8",
			"release_date": "2024-08-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:5662",
			"cpe": "cpe:/a:redhat:satellite_capsule:6.15::el8",
			"package": "python-jinja2-0:3.1.4-1.el8pc",
			"product_name": "Red Hat Satellite 6.15 for RHEL 8",
			"release_date": "2024-08-20T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform",
			"fix_state": "Out of support scope",
			"package_name": "ansible-tower",
			"product_name": "Red Hat Ansible Automation Platform 1.2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Not affected",
			"package_name": "ansible-lint",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Not affected",
			"package_name": "python3-jinja2",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Not affected",
			"package_name": "python3x-ansible-compat",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Not affected",
			"package_name": "python3x-django-lifecycle",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Not affected",
			"package_name": "python-ansible-compat",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Not affected",
			"package_name": "python-django-lifecycle",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:5",
			"fix_state": "Affected",
			"package_name": "cephadm-ansible",
			"product_name": "Red Hat Ceph Storage 5"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:6",
			"fix_state": "Affected",
			"package_name": "cephadm-ansible",
			"product_name": "Red Hat Ceph Storage 6"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:7",
			"fix_state": "Affected",
			"package_name": "cephadm-ansible",
			"product_name": "Red Hat Ceph Storage 7"
		},
		{
			"cpe": "cpe:/a:redhat:rhdh:1",
			"fix_state": "Affected",
			"package_name": "rhdh-hub-container",
			"product_name": "Red Hat Developer Hub"
		},
		{
			"cpe": "cpe:/a:redhat:rhdh:1",
			"fix_state": "Affected",
			"package_name": "rhdh-operator-container",
			"product_name": "Red Hat Developer Hub"
		},
		{
			"cpe": "cpe:/a:redhat:discovery:1.0::el8",
			"fix_state": "Will not fix",
			"package_name": "discovery-server-container",
			"product_name": "Red Hat Discovery"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "python-jinja2",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "python-jinja2",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "fence-agents",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Will not fix",
			"package_name": "python27:2.7/python-jinja2",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "rust-srpm-macros",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "python-jinja2",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "rust-srpm-macros",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4-aws-iso",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-ovn-kubernetes",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Affected",
			"package_name": "openshift4/ztp-site-generate-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:17.1",
			"fix_state": "Not affected",
			"package_name": "openstack-ansible-core",
			"product_name": "Red Hat OpenStack Platform 17.1"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:18.0",
			"fix_state": "Affected",
			"package_name": "python-httpcore",
			"product_name": "Red Hat OpenStack Platform 18.0"
		},
		{
			"cpe": "cpe:/a:redhat:quay:3",
			"fix_state": "Affected",
			"package_name": "quay/quay-rhel8",
			"product_name": "Red Hat Quay 3"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:3",
			"fix_state": "Will not fix",
			"package_name": "rh-python38-python-jinja2",
			"product_name": "Red Hat Software Collections"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Affected",
			"package_name": "gdeploy",
			"product_name": "Red Hat Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:rhui:4::el8",
			"fix_state": "Affected",
			"package_name": "python-jinja2",
			"product_name": "Red Hat Update Infrastructure 4 for Cloud Providers"
		}
	],
	"upstream_fix": "jinja2 3.1.4",
	"csaw": false
}
