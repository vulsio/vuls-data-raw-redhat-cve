{
	"name": "CVE-2024-40910",
	"threat_severity": "Moderate",
	"public_date": "2024-07-12T00:00:00Z",
	"bugzilla": {
		"description": "kernel: ax25: Fix refcount imbalance on inbound connections",
		"id": "2297494",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2297494"
	},
	"cvss3": {
		"cvss3_base_score": "4.4",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H",
		"status": "draft"
	},
	"cwe": "CWE-911",
	"details": [
		"In the Linux kernel, the following vulnerability has been resolved:\nax25: Fix refcount imbalance on inbound connections\nWhen releasing a socket in ax25_release(), we call netdev_put() to\ndecrease the refcount on the associated ax.25 device. However, the\nexecution path for accepting an incoming connection never calls\nnetdev_hold(). This imbalance leads to refcount errors, and ultimately\nto kernel crashes.\nA typical call trace for the above situation will start with one of the\nfollowing errors:\nrefcount_t: decrement hit 0; leaking memory.\nrefcount_t: underflow; use-after-free.\nAnd will then have a trace like:\nCall Trace:\n<TASK>\n? show_regs+0x64/0x70\n? __warn+0x83/0x120\n? refcount_warn_saturate+0xb2/0x100\n? report_bug+0x158/0x190\n? prb_read_valid+0x20/0x30\n? handle_bug+0x3e/0x70\n? exc_invalid_op+0x1c/0x70\n? asm_exc_invalid_op+0x1f/0x30\n? refcount_warn_saturate+0xb2/0x100\n? refcount_warn_saturate+0xb2/0x100\nax25_release+0x2ad/0x360\n__sock_release+0x35/0xa0\nsock_close+0x19/0x20\n[...]\nOn reboot (or any attempt to remove the interface), the kernel gets\nstuck in an infinite loop:\nunregister_netdevice: waiting for ax0 to become free. Usage count = 0\nThis patch corrects these issues by ensuring that we call netdev_hold()\nand ax25_dev_hold() for new connections in ax25_accept(). This makes the\nlogic leading to ax25_accept() match the logic for ax25_bind(): in both\ncases we increment the refcount, which is ultimately decremented in\nax25_release()."
	],
	"statement": "Red Hat Enterprise Linux is not vulnerable to this CVE, as it does not affect the versions or configurations of the Linux kernel used in its distributions.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-40910\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-40910\nhttps://lore.kernel.org/linux-cve-announce/2024071210-CVE-2024-40910-d7d9@gregkh/T"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
	},
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "kernel 6.1.95, kernel 6.6.35, kernel 6.9.6, kernel 6.10-rc3",
	"csaw": false
}
