{
	"name": "CVE-2024-3019",
	"threat_severity": "Important",
	"public_date": "2024-03-27T00:00:00Z",
	"bugzilla": {
		"description": "pcp: exposure of the redis server backend allows remote command execution via pmproxy",
		"id": "2271898",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2271898"
	},
	"cvss3": {
		"cvss3_base_score": "8.8",
		"cvss3_scoring_vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-668",
	"details": [
		"A flaw was found in PCP. The default pmproxy configuration exposes the Redis server backend to the local network, allowing remote command execution with the privileges of the Redis user. This issue can only be exploited when pmproxy is running. By default, pmproxy is not running and needs to be started manually. The pmproxy service is usually started from the 'Metrics settings' page of the Cockpit web interface. This flaw affects PCP versions 4.3.4 and newer.",
		"A flaw was found in PCP. The default pmproxy configuration exposes the Redis server backend to the local network, allowing remote command execution with the privileges of the Redis user. This issue can only be exploited when pmproxy is running. By default, pmproxy is not running and needs to be started manually. The pmproxy service is usually started from the 'Metrics settings' page of the Cockpit web interface. This flaw affects PCP versions 4.3.4 and newer."
	],
	"statement": "As this flaw allows a attacker from the local network to execute arbitrary code and it requires the pmproxy service to be running, which is not the default, it has been rated with an important severity.\nPCP, as shipped in Red Hat Enterprise Linux 6 and 7, is not affected by this vulnerability because the Redis server backend is not enabled and exposed via pmproxy. Additionally, RHEL9 is not exploitable if the redis:7 module is installed instead of the default Redis version 6.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-3019\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-3019"
	],
	"acknowledgement": "Red Hat would like to thank Jihwan Yoon (NAVER Cloud Security Analysis) for reporting this issue.",
	"mitigation": {
		"lang": "en:us",
		"value": "To mitigate this flaw, stop and disable the pmproxy.service or disable the Redis server backend via the pmproxy configuration file.\nTo stop and disable the pmproxy.service, run the following command:\n~~~\n# systemctl disable --now pmproxy.service\n~~~\nTo disable the Redis backend server via the pmproxy configuration file:\n~~~\n# sed -i 's/redis.enabled = true/redis.enabled = false/g' /etc/pcp/pmproxy/pmproxy.conf\n# systemctl restart pmproxy.service\n~~~"
	},
	"affected_release": [
		{
			"advisory": "RHSA-2024:3264",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "pcp-0:5.3.7-20.el8_10",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2024-05-22T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:3392",
			"cpe": "cpe:/a:redhat:rhel_aus:8.2",
			"package": "pcp-0:5.0.2-8.el8_2",
			"product_name": "Red Hat Enterprise Linux 8.2 Advanced Update Support",
			"release_date": "2024-05-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:3323",
			"cpe": "cpe:/a:redhat:rhel_aus:8.4",
			"package": "pcp-0:5.2.5-7.el8_4",
			"product_name": "Red Hat Enterprise Linux 8.4 Advanced Mission Critical Update Support",
			"release_date": "2024-05-23T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:3323",
			"cpe": "cpe:/a:redhat:rhel_tus:8.4",
			"package": "pcp-0:5.2.5-7.el8_4",
			"product_name": "Red Hat Enterprise Linux 8.4 Telecommunications Update Service",
			"release_date": "2024-05-23T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:3323",
			"cpe": "cpe:/a:redhat:rhel_e4s:8.4",
			"package": "pcp-0:5.2.5-7.el8_4",
			"product_name": "Red Hat Enterprise Linux 8.4 Update Services for SAP Solutions",
			"release_date": "2024-05-23T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:3324",
			"cpe": "cpe:/a:redhat:rhel_eus:8.6",
			"package": "pcp-0:5.3.5-9.el8_6",
			"product_name": "Red Hat Enterprise Linux 8.6 Extended Update Support",
			"release_date": "2024-05-23T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:3322",
			"cpe": "cpe:/a:redhat:rhel_eus:8.8",
			"package": "pcp-0:5.3.7-18.el8_8",
			"product_name": "Red Hat Enterprise Linux 8.8 Extended Update Support",
			"release_date": "2024-05-23T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:2566",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"package": "pcp-0:6.2.0-2.el9_4",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2024-04-30T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:3325",
			"cpe": "cpe:/a:redhat:rhel_eus:9.0",
			"package": "pcp-0:5.3.5-9.el9_0",
			"product_name": "Red Hat Enterprise Linux 9.0 Extended Update Support",
			"release_date": "2024-05-23T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:3321",
			"cpe": "cpe:/a:redhat:rhel_eus:9.2",
			"package": "pcp-0:6.0.1-6.el9_2",
			"product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
			"release_date": "2024-05-23T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "pcp",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "pcp",
			"product_name": "Red Hat Enterprise Linux 7"
		}
	],
	"csaw": false
}
