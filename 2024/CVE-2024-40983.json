{
	"name": "CVE-2024-40983",
	"threat_severity": "Moderate",
	"public_date": "2024-07-12T00:00:00Z",
	"bugzilla": {
		"description": "kernel: tipc: force a dst refcount before doing decryption",
		"id": "2297567",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2297567"
	},
	"cvss3": {
		"cvss3_base_score": "5.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
		"status": "verified"
	},
	"cwe": "CWE-911",
	"details": [
		"In the Linux kernel, the following vulnerability has been resolved:\ntipc: force a dst refcount before doing decryption\nAs it says in commit 3bc07321ccc2 (\"xfrm: Force a dst refcount before\nentering the xfrm type handlers\"):\n\"Crypto requests might return asynchronous. In this case we leave the\nrcu protected region, so force a refcount on the skb's destination\nentry before we enter the xfrm type input/output handlers.\"\nOn TIPC decryption path it has the same problem, and skb_dst_force()\nshould be called before doing decryption to avoid a possible crash.\nShuang reported this issue when this warning is triggered:\n[] WARNING: include/net/dst.h:337 tipc_sk_rcv+0x1055/0x1ea0 [tipc]\n[] Kdump: loaded Tainted: G W --------- - - 4.18.0-496.el8.x86_64+debug\n[] Workqueue: crypto cryptd_queue_worker\n[] RIP: 0010:tipc_sk_rcv+0x1055/0x1ea0 [tipc]\n[] Call Trace:\n[] tipc_sk_mcast_rcv+0x548/0xea0 [tipc]\n[] tipc_rcv+0xcf5/0x1060 [tipc]\n[] tipc_aead_decrypt_done+0x215/0x2e0 [tipc]\n[] cryptd_aead_crypt+0xdb/0x190\n[] cryptd_queue_worker+0xed/0x190\n[] process_one_work+0x93d/0x17e0"
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-40983\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-40983\nhttps://lore.kernel.org/linux-cve-announce/2024071201-CVE-2024-40983-e1b1@gregkh/T"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2024:5928",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"package": "kernel-0:5.14.0-427.33.1.el9_4",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2024-08-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:5928",
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"package": "kernel-0:5.14.0-427.33.1.el9_4",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2024-08-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:6267",
			"cpe": "cpe:/a:redhat:rhel_eus:9.2",
			"package": "kernel-0:5.14.0-284.82.1.el9_2",
			"product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
			"release_date": "2024-09-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:6268",
			"cpe": "cpe:/a:redhat:rhel_eus:9.2::nfv",
			"package": "kernel-rt-0:5.14.0-284.82.1.rt14.367.el9_2",
			"product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
			"release_date": "2024-09-04T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "kernel 5.10.221, kernel 5.15.162, kernel 6.1.96, kernel 6.6.36, kernel 6.9.7, kernel 6.10-rc5",
	"csaw": false
}
