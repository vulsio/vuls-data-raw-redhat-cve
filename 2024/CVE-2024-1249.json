{
	"name": "CVE-2024-1249",
	"threat_severity": "Important",
	"public_date": "2024-04-16T00:00:00Z",
	"bugzilla": {
		"description": "keycloak: org.keycloak.protocol.oidc: unvalidated cross-origin messages in checkLoginIframe leads to DDoS",
		"id": "2262918",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2262918"
	},
	"cvss3": {
		"cvss3_base_score": "7.4",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:N/A:H",
		"status": "verified"
	},
	"cwe": "CWE-346",
	"details": [
		"A flaw was found in Keycloak's OIDC component in the \"checkLoginIframe,\" which allows unvalidated cross-origin messages. This flaw allows attackers to coordinate and send millions of requests in seconds using simple code, significantly impacting the application's availability without proper origin validation for incoming messages.",
		"A flaw was found in Keycloak's OIDC component in the \"checkLoginIframe,\" which allows unvalidated cross-origin messages. This flaw allows attackers to coordinate and send millions of requests in seconds using simple code, significantly impacting the application's availability without proper origin validation for incoming messages."
	],
	"statement": "The vulnerability in Keycloak's OIDC component allowing unvalidated cross-origin messages in the \"checkLoginIframe\" function represents an important severity issue due to its potential to cause significant disruption and resource exhaustion. Exploitation of this flaw can lead to a Denial of Service (DoS) condition, where malicious actors can overwhelm the server with a high volume of requests, impacting availability for legitimate users. The absence of proper origin validation means attackers can exploit this weakness relatively easily, leveraging automated scripts to flood the server within seconds.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-1249\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-1249"
	],
	"acknowledgement": "Red Hat would like to thank Adriano MÃ¡rcio Monteiro for reporting this issue.",
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2024:1867",
			"cpe": "cpe:/a:redhat:build_keycloak:22::el9",
			"package": "rhbk/keycloak-operator-bundle:22.0.10-1",
			"product_name": "Red Hat build of Keycloak 22",
			"release_date": "2024-04-16T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1867",
			"cpe": "cpe:/a:redhat:build_keycloak:22::el9",
			"package": "rhbk/keycloak-rhel9:22-13",
			"product_name": "Red Hat build of Keycloak 22",
			"release_date": "2024-04-16T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1867",
			"cpe": "cpe:/a:redhat:build_keycloak:22::el9",
			"package": "rhbk/keycloak-rhel9-operator:22-16",
			"product_name": "Red Hat build of Keycloak 22",
			"release_date": "2024-04-16T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1868",
			"cpe": "cpe:/a:redhat:build_keycloak:22",
			"package": "keycloak",
			"product_name": "Red Hat build of Keycloak 22.0.10",
			"release_date": "2024-04-16T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:2945",
			"cpe": "cpe:/a:redhat:amq_broker:7.12",
			"package": "keycloak",
			"product_name": "Red Hat JBoss A-MQ 7",
			"release_date": "2024-05-21T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1860",
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el7",
			"package": "rh-sso7-keycloak-0:18.0.13-1.redhat_00001.1.el7sso",
			"product_name": "Red Hat Single Sign-On 7.6 for RHEL 7",
			"release_date": "2024-04-16T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1861",
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el8",
			"package": "rh-sso7-keycloak-0:18.0.13-1.redhat_00001.1.el8sso",
			"product_name": "Red Hat Single Sign-On 7.6 for RHEL 8",
			"release_date": "2024-04-16T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1862",
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el9",
			"package": "rh-sso7-keycloak-0:18.0.13-1.redhat_00001.1.el9sso",
			"product_name": "Red Hat Single Sign-On 7.6 for RHEL 9",
			"release_date": "2024-04-16T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1864",
			"cpe": "cpe:/a:redhat:rhosemc:1.0::el8",
			"package": "rh-sso-7/sso76-openshift-rhel8:7.6-46",
			"product_name": "RHEL-8 based Middleware Containers",
			"release_date": "2024-04-16T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4057",
			"cpe": "cpe:/a:redhat:openshift_serverless:1.33::el8",
			"package": "openshift-serverless-1-logic-data-index-ephemeral-rhel8-container-1.33.0-5",
			"product_name": "RHOSS-1.33-RHEL-8",
			"release_date": "2024-06-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4057",
			"cpe": "cpe:/a:redhat:openshift_serverless:1.33::el8",
			"package": "openshift-serverless-1-logic-data-index-postgresql-rhel8-container-1.33.0-5",
			"product_name": "RHOSS-1.33-RHEL-8",
			"release_date": "2024-06-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4057",
			"cpe": "cpe:/a:redhat:openshift_serverless:1.33::el8",
			"package": "openshift-serverless-1-logic-jobs-service-ephemeral-rhel8-container-1.33.0-5",
			"product_name": "RHOSS-1.33-RHEL-8",
			"release_date": "2024-06-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4057",
			"cpe": "cpe:/a:redhat:openshift_serverless:1.33::el8",
			"package": "openshift-serverless-1-logic-jobs-service-postgresql-rhel8-container-1.33.0-5",
			"product_name": "RHOSS-1.33-RHEL-8",
			"release_date": "2024-06-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4057",
			"cpe": "cpe:/a:redhat:openshift_serverless:1.33::el8",
			"package": "openshift-serverless-1-logic-kn-workflow-cli-artifacts-rhel8-container-1.33.0-5",
			"product_name": "RHOSS-1.33-RHEL-8",
			"release_date": "2024-06-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4057",
			"cpe": "cpe:/a:redhat:openshift_serverless:1.33::el8",
			"package": "openshift-serverless-1-logic-rhel8-operator-bundle-container-1.33.0-5",
			"product_name": "RHOSS-1.33-RHEL-8",
			"release_date": "2024-06-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4057",
			"cpe": "cpe:/a:redhat:openshift_serverless:1.33::el8",
			"package": "openshift-serverless-1-logic-rhel8-operator-container-1.33.0-3",
			"product_name": "RHOSS-1.33-RHEL-8",
			"release_date": "2024-06-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4057",
			"cpe": "cpe:/a:redhat:openshift_serverless:1.33::el8",
			"package": "openshift-serverless-1-logic-swf-builder-rhel8-container-1.33.0-5",
			"product_name": "RHOSS-1.33-RHEL-8",
			"release_date": "2024-06-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4057",
			"cpe": "cpe:/a:redhat:openshift_serverless:1.33::el8",
			"package": "openshift-serverless-1-logic-swf-devmode-rhel8-container-1.33.0-5",
			"product_name": "RHOSS-1.33-RHEL-8",
			"release_date": "2024-06-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1866",
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6",
			"package": "keycloak",
			"product_name": "RHSSO 7.6.8",
			"release_date": "2024-04-16T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:migration_toolkit_applications:6",
			"fix_state": "Affected",
			"package_name": "mta/mta-ui-rhel8",
			"product_name": "Migration Toolkit for Applications 6"
		},
		{
			"cpe": "cpe:/a:redhat:migration_toolkit_applications:7",
			"fix_state": "Affected",
			"package_name": "mta/mta-ui-rhel9",
			"product_name": "Migration Toolkit for Applications 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:8",
			"fix_state": "Not affected",
			"package_name": "keycloak",
			"product_name": "Red Hat Data Grid 8"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7",
			"fix_state": "Affected",
			"package_name": "keycloak",
			"product_name": "Red Hat Decision Manager 7"
		},
		{
			"cpe": "cpe:/a:redhat:rhdh:1",
			"fix_state": "Not affected",
			"package_name": "rhdh-hub-container",
			"product_name": "Red Hat Developer Hub"
		},
		{
			"cpe": "cpe:/a:redhat:service_registry:2",
			"fix_state": "Affected",
			"package_name": "keycloak",
			"product_name": "Red Hat Integration Service Registry"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:7",
			"fix_state": "Not affected",
			"package_name": "keycloak",
			"product_name": "Red Hat JBoss Data Grid 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6",
			"fix_state": "Out of support scope",
			"package_name": "keycloak",
			"product_name": "Red Hat JBoss Enterprise Application Platform 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6",
			"fix_state": "Out of support scope",
			"package_name": "keycloak-adapter-eap6",
			"product_name": "Red Hat JBoss Enterprise Application Platform 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6",
			"fix_state": "Out of support scope",
			"package_name": "keycloak-adapter-sso7_2-eap6",
			"product_name": "Red Hat JBoss Enterprise Application Platform 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6",
			"fix_state": "Out of support scope",
			"package_name": "keycloak-adapter-sso7_3-eap6",
			"product_name": "Red Hat JBoss Enterprise Application Platform 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6",
			"fix_state": "Out of support scope",
			"package_name": "keycloak-adapter-sso7_4-eap6",
			"product_name": "Red Hat JBoss Enterprise Application Platform 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6",
			"fix_state": "Out of support scope",
			"package_name": "keycloak-adapter-sso7_5-eap6",
			"product_name": "Red Hat JBoss Enterprise Application Platform 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6",
			"fix_state": "Out of support scope",
			"package_name": "org.keycloak-keycloak-parent",
			"product_name": "Red Hat JBoss Enterprise Application Platform 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6",
			"fix_state": "Out of support scope",
			"package_name": "rh-sso7-keycloak",
			"product_name": "Red Hat JBoss Enterprise Application Platform 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7",
			"fix_state": "Affected",
			"package_name": "keycloak",
			"product_name": "Red Hat JBoss Enterprise Application Platform 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:8",
			"fix_state": "Affected",
			"package_name": "keycloak",
			"product_name": "Red Hat JBoss Enterprise Application Platform 8"
		},
		{
			"cpe": "cpe:/a:redhat:jbosseapxp",
			"fix_state": "Not affected",
			"package_name": "keycloak",
			"product_name": "Red Hat JBoss Enterprise Application Platform Expansion Pack"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"fix_state": "Not affected",
			"package_name": "keycloak",
			"product_name": "Red Hat JBoss Fuse 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7",
			"fix_state": "Affected",
			"package_name": "keycloak",
			"product_name": "Red Hat Process Automation 7"
		},
		{
			"cpe": "cpe:/a:redhat:amq_streams:1",
			"fix_state": "Not affected",
			"package_name": "keycloak",
			"product_name": "streams for Apache Kafka"
		}
	],
	"csaw": false
}
