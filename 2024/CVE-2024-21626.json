{
	"name": "CVE-2024-21626",
	"threat_severity": "Important",
	"public_date": "2024-01-31T20:01:00Z",
	"bugzilla": {
		"description": "runc: file descriptor leak",
		"id": "2258725",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2258725"
	},
	"cvss3": {
		"cvss3_base_score": "8.6",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-200",
	"details": [
		"A file descriptor leak issue was found in the runc package. While a user performs `O_CLOEXEC` all file descriptors before executing the container code, the file descriptor is open when performing `setcwd(2)`, which means that the reference can be kept alive in the container by configuring the working directory to be a path resolved through the file descriptor. The non-dumpable bit is unset after `execve`, meaning there are multiple ways to attack this other than bad configurations. The only way to defend against it entirely is to close all unneeded file descriptors."
	],
	"statement": "These vulnerabilities not only enable malicious actors to escape containerized environments but also allow for full control over the underlying host system. With the widespread adoption of containerization technologies in both development and production environments, such exploits pose significant risks to data integrity, confidentiality, and system stability.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-21626\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-21626\nhttps://github.com/opencontainers/runc/security/advisories/GHSA-xr7r-f8xq-vfvv"
	],
	"acknowledgement": "Red Hat would like to thank The Snyk Reseacher Team for reporting this issue.",
	"mitigation": {
		"lang": "en:us",
		"value": "Red Hat Enterprise Linux (RHEL) and OpenShift ships with SELinux in targeted enforcing mode, which prevents the container processes from accessing host content and mitigates this attack. Dockerfiles can be inspected on the 'RUN'Â and 'WORKDIR' directives to ensure that there are no escapes or malicious paths, which are an indication of compromise. Limiting access and only using trusted container images can help prevent unauthorized access and malicious attacks."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2024:0670",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"package": "runc-4:1.1.12-1.el9_3",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2024-02-02T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Affected",
			"package_name": "runc",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "container-tools:2.0/runc",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "container-tools:3.0/runc",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "container-tools:4.0/runc",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "container-tools:rhel8/runc",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Affected",
			"impact": "moderate",
			"package_name": "runc",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Affected",
			"impact": "moderate",
			"package_name": "runc",
			"product_name": "Red Hat OpenShift Container Platform 4"
		}
	],
	"upstream_fix": "runc 1.1.12",
	"csaw": true
}
