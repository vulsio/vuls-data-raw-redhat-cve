{
	"name": "CVE-2024-44996",
	"threat_severity": "Moderate",
	"public_date": "2024-09-04T00:00:00Z",
	"bugzilla": {
		"description": "kernel: vsock: fix recursive -&gt;recvmsg calls",
		"id": "2309859",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2309859"
	},
	"cvss3": {
		"cvss3_base_score": "5.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
		"status": "draft"
	},
	"cwe": "CWE-20",
	"details": [
		"In the Linux kernel, the following vulnerability has been resolved:\nvsock: fix recursive ->recvmsg calls\nAfter a vsock socket has been added to a BPF sockmap, its prot->recvmsg\nhas been replaced with vsock_bpf_recvmsg(). Thus the following\nrecursiion could happen:\nvsock_bpf_recvmsg()\n-> __vsock_recvmsg()\n-> vsock_connectible_recvmsg()\n-> prot->recvmsg()\n-> vsock_bpf_recvmsg() again\nWe need to fix it by calling the original ->recvmsg() without any BPF\nsockmap logic in __vsock_recvmsg().",
		"A vulnerability was found in the Linux kernel related to vsock, involving recursive calls due to BPF sockmap integration. When a vsock socket was added to a BPF sockmap, the prot->recvmsg function was replaced with vsock_bpf_recvmsg(). This could lead to recursion as vsock_bpf_recvmsg() called __vsock_recvmsg(), which then invokes vsock_connectible_recvmsg(), leading back to vsock_bpf_recvmsg()."
	],
	"statement": "This issue is classified as moderate severity rather than important because the recursive vulnerability in `vsock` primarily affects the handling of sockets within a specific context involving BPF sockmap integration. While it could lead to stack overflow and potential denial of service under certain conditions, it does not inherently allow for privilege escalation or arbitrary code execution. The recursion is constrained to the `vsock_bpf_recvmsg()` and `__vsock_recvmsg()` functions, and effective mitigation can be achieved by bypassing BPF logic when recursion is detected.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-44996\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-44996\nhttps://lore.kernel.org/linux-cve-announce/2024090448-CVE-2024-44996-8b26@gregkh/T"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
	},
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Will not fix",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Will not fix",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"csaw": false
}
