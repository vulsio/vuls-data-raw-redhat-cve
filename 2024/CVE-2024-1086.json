{
	"name": "CVE-2024-1086",
	"threat_severity": "Moderate",
	"public_date": "2024-01-31T00:00:00Z",
	"bugzilla": {
		"description": "kernel: nf_tables: use-after-free vulnerability in the nft_verdict_init() function",
		"id": "2262126",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2262126"
	},
	"cvss3": {
		"cvss3_base_score": "7.0",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-416",
	"details": [
		"A use-after-free vulnerability in the Linux kernel's netfilter: nf_tables component can be exploited to achieve local privilege escalation.\nThe nft_verdict_init() function allows positive values as drop error within the hook verdict, and hence the nf_hook_slow() function can cause a double free vulnerability when NF_DROP is issued with a drop error which resembles NF_ACCEPT.\nWe recommend upgrading past commit f342de4e2f33e0e39165d8639387aa6c19dff660.",
		"A flaw was found in the Netfilter subsystem in the Linux kernel. This issue occurs in the nft_verdict_init() function, allowing positive values as a drop error within the hook verdict, therefore, the nf_hook_slow() function can cause a double-free vulnerability when NF_DROP is issued with a drop error that resembles NF_ACCEPT. The nf_tables component can be exploited to achieve local privilege escalation."
	],
	"statement": "This flaw is rated as a having Moderate impact, because only local user can trigger it (and both only if user have access to netfilter).",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-1086\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-1086\nhttps://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=f342de4e2f33e0e39165d8639387aa6c19dff660\nhttps://kernel.dance/f342de4e2f33e0e39165d8639387aa6c19dff660"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "1. This flaw can be mitigated by preventing the affected netfilter (nf_tables) kernel module from being loaded. For instructions on how to blacklist a kernel module, please see https://access.redhat.com/solutions/41278.\n2. If the module cannot be disabled, on non-containerized deployments of Red Hat Enterprise Linux, the mitigation is to disable user namespaces:\n```\n# echo \"user.max_user_namespaces=0\" > /etc/sysctl.d/userns.conf\n# sysctl -p /etc/sysctl.d/userns.conf\n```\nOn containerized deployments, such as Red Hat OpenShift Container Platform, do not use the second mitigation (disabling user namespaces) as the functionality is needed to be enabled. The first mitigation (blacklisting nf_tables) is still viable for containerized deployments, providing the environment is not using netfilter."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2024:1332",
			"cpe": "cpe:/a:redhat:rhel_extras_rt:7",
			"package": "kernel-rt-0:3.10.0-1160.114.2.rt56.1266.el7",
			"product_name": "Red Hat Enterprise Linux 7",
			"release_date": "2024-03-14T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1249",
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"package": "kernel-0:3.10.0-1160.114.2.el7",
			"product_name": "Red Hat Enterprise Linux 7",
			"release_date": "2024-03-12T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:0930",
			"cpe": "cpe:/o:redhat:rhel_eus:8.6",
			"package": "kernel-0:4.18.0-372.93.1.el8_6",
			"product_name": "Red Hat Enterprise Linux 8.6 Extended Update Support",
			"release_date": "2024-02-21T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1018",
			"cpe": "cpe:/a:redhat:rhel_eus:9.2",
			"package": "kernel-0:5.14.0-284.55.1.el9_2",
			"product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
			"release_date": "2024-02-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1019",
			"cpe": "cpe:/a:redhat:rhel_eus:9.2::nfv",
			"package": "kernel-rt-0:5.14.0-284.55.1.rt14.340.el9_2",
			"product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
			"release_date": "2024-02-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:0930",
			"cpe": "cpe:/o:redhat:enterprise_linux:8::hypervisor",
			"package": "kernel-0:4.18.0-372.93.1.el8_6",
			"product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 8",
			"release_date": "2024-02-21T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "kernel 6.8-rc2",
	"csaw": false
}
