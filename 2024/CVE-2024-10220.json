{
	"name": "CVE-2024-10220",
	"threat_severity": "Important",
	"public_date": "2024-11-08T16:00:00Z",
	"bugzilla": {
		"description": "kubernetes: Arbitrary command execution through gitRepo volume",
		"id": "2323060",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2323060"
	},
	"cvss3": {
		"cvss3_base_score": "8.1",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
		"status": "draft"
	},
	"cwe": "CWE-653",
	"details": [
		"The Kubernetes kubelet component allows arbitrary command execution via specially crafted gitRepo volumes.This issue affects kubelet: through 1.28.11, from 1.29.0 through 1.29.6, from 1.30.0 through 1.30.2.",
		"A flaw was found in the Kubelet component from the Kubernetes package. This flaw allows an attacker to create a pod and an associated gitRepo volume to execute arbitrary commands outside the container, bypassing the intended isolation between the container and the host."
	],
	"statement": "This vulnerability is classified as important severity due to its potential to allow arbitrary command execution beyond the container boundary, which can lead to severe security breaches. By leveraging the hooks folder in the target repository associated with the gitRepo volume, an attacker can execute commands on the host system or other pods within the cluster. This can result in unauthorized access, data exfiltration, or privilege escalation, making it far more impactful than a moderate vulnerability.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-10220\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-10220"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Users can restrict the usage of gitRepo volumes in their cluster using policies such as `ValidatingAdmissionPolicy`.\nThe following CEL expression can be used as part of the policy to restrict the use of gitRepo volumes:\n~~~\nhas(object.spec.volumes) || !object.spec.volumes.exists(v, has(v.gitRepo))\n~~"
	},
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform",
			"fix_state": "Will not fix",
			"package_name": "ansible-tower",
			"product_name": "Red Hat Ansible Automation Platform 1.2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Affected",
			"package_name": "ansible-automation-platform-24/ee-supported-rhel8",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Will not fix",
			"package_name": "automation-controller",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:discovery:1.0::el8",
			"fix_state": "Affected",
			"package_name": "discovery-server-container",
			"product_name": "Red Hat Discovery"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Will not fix",
			"package_name": "fence-agents",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/cnf-tests-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Affected",
			"package_name": "openshift4/ose-ansible-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ztp-site-generate-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		}
	],
	"csaw": false
}
