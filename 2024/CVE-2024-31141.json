{
	"name": "CVE-2024-31141",
	"threat_severity": "Moderate",
	"public_date": "2024-11-19T08:40:50Z",
	"bugzilla": {
		"description": "kafka-clients: privilege escalation to filesystem read-access via automatic ConfigProvider",
		"id": "2327264",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2327264"
	},
	"cvss3": {
		"cvss3_base_score": "5.3",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N",
		"status": "draft"
	},
	"cwe": "(CWE-269|CWE-552)",
	"details": [
		"Files or Directories Accessible to External Parties, Improper Privilege Management vulnerability in Apache Kafka Clients.\nApache Kafka Clients accept configuration data for customizing behavior, and includes ConfigProvider plugins in order to manipulate these configurations. Apache Kafka also provides FileConfigProvider, DirectoryConfigProvider, and EnvVarConfigProvider implementations which include the ability to read from disk or environment variables.\nIn applications where Apache Kafka Clients configurations can be specified by an untrusted party, attackers may use these ConfigProviders to read arbitrary contents of the disk and environment variables.\nIn particular, this flaw may be used in Apache Kafka Connect to escalate from REST API access to filesystem/environment access, which may be undesirable in certain environments, including SaaS products.\nThis issue affects Apache Kafka Clients: from 2.3.0 through 3.5.2, 3.6.2, 3.7.0.\nUsers with affected applications are recommended to upgrade kafka-clients to version >=3.8.0, and set the JVM system property \"org.apache.kafka.automatic.config.providers=none\".\nUsers of Kafka Connect with one of the listed ConfigProvider implementations specified in their worker config are also recommended to add appropriate \"allowlist.pattern\" and \"allowed.paths\" to restrict their operation to appropriate bounds.\nFor users of Kafka Clients or Kafka Connect in environments that trust users with disk and environment variable access, it is not recommended to set the system property.\nFor users of the Kafka Broker, Kafka MirrorMaker 2.0, Kafka Streams, and Kafka command-line tools, it is not recommended to set the system property.",
		"A flaw was found in Apache Kafka Clients. Apache Kafka Clients accepts configuration data for customizing behavior and includes ConfigProvider plugins to manipulate these configurations. Apache Kafka also provides FileConfigProvider, DirectoryConfigProvider, and EnvVarConfigProvider implementations, which include the ability to read from disk or environment variables. In applications where an untrusted party can specify Apache Kafka Clients configurations, attackers may use these ConfigProviders to read arbitrary contents of the disk and environment variables."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-31141\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-31141\nhttps://lists.apache.org/thread/9whdzfr0zwdhr364604w5ssnzmg4v2lv"
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:a_mq_clients:2",
			"fix_state": "Not affected",
			"package_name": "org.apache.kafka/kafka-clients",
			"product_name": "A-MQ Clients 2"
		},
		{
			"cpe": "cpe:/a:redhat:logging:5",
			"fix_state": "Not affected",
			"package_name": "org.apache.kafka/kafka-clients",
			"product_name": "Logging Subsystem for Red Hat OpenShift"
		},
		{
			"cpe": "cpe:/a:redhat:camel_quarkus:3",
			"fix_state": "Affected",
			"package_name": "org.apache.kafka/kafka-clients",
			"product_name": "Red Hat build of Apache Camel for Quarkus"
		},
		{
			"cpe": "cpe:/a:redhat:camel_spring_boot:4",
			"fix_state": "Affected",
			"package_name": "org.apache.kafka/kafka-clients",
			"product_name": "Red Hat build of Apache Camel for Spring Boot 4"
		},
		{
			"cpe": "cpe:/a:redhat:service_registry:2",
			"fix_state": "Affected",
			"package_name": "org.apache.kafka/kafka-clients",
			"product_name": "Red Hat build of Apicurio Registry"
		},
		{
			"cpe": "cpe:/a:redhat:debezium:2",
			"fix_state": "Will not fix",
			"package_name": "org.apache.kafka/kafka-clients",
			"product_name": "Red Hat build of Debezium"
		},
		{
			"cpe": "cpe:/a:redhat:quarkus:3",
			"fix_state": "Affected",
			"package_name": "org.apache.kafka/kafka-clients",
			"product_name": "Red Hat build of Quarkus"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:8",
			"fix_state": "Affected",
			"package_name": "org.apache.kafka/kafka-clients",
			"product_name": "Red Hat Data Grid 8"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"fix_state": "Out of support scope",
			"package_name": "org.apache.kafka/kafka-clients",
			"product_name": "Red Hat Fuse 7"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Out of support scope",
			"package_name": "org.apache.kafka/kafka-clients",
			"product_name": "Red Hat Integration Camel K"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:7",
			"fix_state": "Out of support scope",
			"package_name": "org.apache.kafka/kafka-clients",
			"product_name": "Red Hat JBoss Data Grid 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7",
			"fix_state": "Not affected",
			"package_name": "org.apache.kafka/kafka-clients",
			"product_name": "Red Hat JBoss Enterprise Application Platform 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:8",
			"fix_state": "Not affected",
			"package_name": "org.apache.kafka/kafka-clients",
			"product_name": "Red Hat JBoss Enterprise Application Platform 8"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:8",
			"fix_state": "Affected",
			"package_name": "org.jboss.eap-jboss-eap-xp",
			"product_name": "Red Hat JBoss Enterprise Application Platform 8"
		},
		{
			"cpe": "cpe:/a:redhat:jbosseapxp",
			"fix_state": "Out of support scope",
			"package_name": "org.apache.kafka/kafka-clients",
			"product_name": "Red Hat JBoss Enterprise Application Platform Expansion Pack"
		},
		{
			"cpe": "cpe:/a:redhat:jbosseapxp",
			"fix_state": "Out of support scope",
			"package_name": "org.jboss.eap-jboss-eap-xp",
			"product_name": "Red Hat JBoss Enterprise Application Platform Expansion Pack"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7",
			"fix_state": "Out of support scope",
			"package_name": "org.apache.kafka/kafka-clients",
			"product_name": "Red Hat Process Automation 7"
		},
		{
			"cpe": "cpe:/a:redhat:amq_streams:1",
			"fix_state": "Out of support scope",
			"package_name": "org.apache.kafka/kafka-clients",
			"product_name": "streams for Apache Kafka"
		}
	],
	"csaw": false
}
