{
	"name": "CVE-2024-7348",
	"threat_severity": "Important",
	"public_date": "2024-08-08T00:00:00Z",
	"bugzilla": {
		"description": "postgresql: PostgreSQL relation replacement during pg_dump executes arbitrary SQL",
		"id": "2303682",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2303682"
	},
	"cvss3": {
		"cvss3_base_score": "7.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-367",
	"details": [
		"Time-of-check Time-of-use (TOCTOU) race condition in pg_dump in PostgreSQL allows an object creator to execute arbitrary SQL functions as the user running pg_dump, which is often a superuser. The attack involves replacing another relation type with a view or foreign table. The attack requires waiting for pg_dump to start, but winning the race condition is trivial if the attacker retains an open transaction. Versions before PostgreSQL 16.4, 15.8, 14.13, 13.16, and 12.20 are affected.",
		"A vulnerability was found in PostgreSQL. A Race condition in pg_dump allows an object creator to execute arbitrary SQL functions as the user running pg_dump, which is often a superuser."
	],
	"statement": "Satellite PostgreSQL is pulled through a base layered OS product and/or appstream repository and it is not shipped through this offering.\nThis TOCTOU race condition in pg_dump is a important severity issue because it enables a non-privileged database user to escalate their privileges and execute arbitrary SQL functions as the superuser, compromising the entire database system. The exploitation of this vulnerability is particularly dangerous due to the inherent privilege level associated with the pg_dump process, which typically operates with elevated rights to ensure comprehensive backups. The ease of exploitation—due to the trivial nature of winning the race condition by holding an open transaction—further amplifies the risk, making it a significant threat in environments running affected PostgreSQL versions.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-7348\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-7348\nhttps://www.postgresql.org/support/security/CVE-2024-7348/"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2024:5927",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "postgresql:16-8100020240814094432.489197e6",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2024-08-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:6000",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "postgresql:12-8100020240814102525.489197e6",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2024-08-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:6001",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "postgresql:15-8100020240814101911.489197e6",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2024-08-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:6018",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "postgresql:13-8100020240814102212.489197e6",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2024-08-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:5929",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"package": "postgresql:16-9040020240812093225.rhel9",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2024-08-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:5999",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"package": "postgresql-0:13.16-1.el9_4",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2024-08-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:6020",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"package": "postgresql:15-9040020240812115436.rhel9",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2024-08-29T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "postgresql",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Affected",
			"package_name": "postgresql",
			"product_name": "Red Hat Enterprise Linux 7"
		}
	],
	"csaw": false
}
