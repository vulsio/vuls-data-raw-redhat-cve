{
	"name": "CVE-2024-29180",
	"threat_severity": "Important",
	"public_date": "2024-03-21T00:00:00Z",
	"bugzilla": {
		"description": "webpack-dev-middleware: lack of URL validation may lead to file leak",
		"id": "2270863",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2270863"
	},
	"cvss3": {
		"cvss3_base_score": "7.4",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N",
		"status": "draft"
	},
	"cwe": "CWE-22",
	"details": [
		"Prior to versions 7.1.0, 6.1.2, and 5.3.4, the webpack-dev-middleware development middleware for devpack does not validate the supplied URL address sufficiently before returning the local file. It is possible to access any file on the developer's machine. The middleware can either work with the physical filesystem when reading the files or it can use a virtualized in-memory `memfs` filesystem. If `writeToDisk` configuration option is set to `true`, the physical filesystem is used. The `getFilenameFromUrl` method is used to parse URL and build the local file path. The public path prefix is stripped from the URL, and the `unsecaped` path suffix is appended to the `outputPath`. As the URL is not unescaped and normalized automatically before calling the midlleware, it is possible to use `%2e` and `%2f` sequences to perform path traversal attack.\nDevelopers using `webpack-dev-server` or `webpack-dev-middleware` are affected by the issue. When the project is started, an attacker might access any file on the developer's machine and exfiltrate the content. If the development server is listening on a public IP address (or `0.0.0.0`), an attacker on the local network can access the local files without any interaction from the victim (direct connection to the port). If the server allows access from third-party domains, an attacker can send a malicious link to the victim. When visited, the client side script can connect to the local server and exfiltrate the local files. Starting with fixed versions 7.1.0, 6.1.2, and 5.3.4, the URL is unescaped and normalized before any further processing.",
		"A flaw was found in the webpack-dev-middleware package, where it failed to validate the supplied URL address sufficiently before returning local files. This flaw allows an attacker to craft URLs to return arbitrary local files from the developer's machine. The lack of normalization before calling the middleware also allows the attacker to perform path traversal attacks on the target environment."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-29180\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-29180\nhttps://github.com/webpack/webpack-dev-middleware/security/advisories/GHSA-wr3j-pwj9-hqq6"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Currently, there's no available mitigation that matches Red Hat's mitigation criteria other than updating the affected packages."
	},
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:cryostat:2",
			"fix_state": "Under investigation",
			"package_name": "webpack-dev-middleware",
			"product_name": "Cryostat 2"
		},
		{
			"cpe": "cpe:/a:redhat:logging:5",
			"fix_state": "Under investigation",
			"package_name": "openshift-logging/kibana6-rhel8",
			"product_name": "Logging Subsystem for Red Hat OpenShift"
		},
		{
			"cpe": "cpe:/a:redhat:logging:5",
			"fix_state": "Under investigation",
			"package_name": "openshift-logging/logging-view-plugin-rhel8",
			"product_name": "Logging Subsystem for Red Hat OpenShift"
		},
		{
			"cpe": "cpe:/a:redhat:migration_toolkit_applications:6",
			"fix_state": "Under investigation",
			"package_name": "mta/mta-ui-rhel8",
			"product_name": "Migration Toolkit for Applications 6"
		},
		{
			"cpe": "cpe:/a:redhat:migration_toolkit_applications:6",
			"fix_state": "Under investigation",
			"package_name": "webpack-dev-middleware",
			"product_name": "Migration Toolkit for Applications 6"
		},
		{
			"cpe": "cpe:/a:redhat:migration_toolkit_applications:7",
			"fix_state": "Under investigation",
			"package_name": "mta/mta-cli-rhel9",
			"product_name": "Migration Toolkit for Applications 7"
		},
		{
			"cpe": "cpe:/a:redhat:migration_toolkit_applications:7",
			"fix_state": "Under investigation",
			"package_name": "mta/mta-ui-rhel9",
			"product_name": "Migration Toolkit for Applications 7"
		},
		{
			"cpe": "cpe:/a:redhat:rhmt",
			"fix_state": "Under investigation",
			"package_name": "rhmtc/openshift-migration-ui-rhel8",
			"product_name": "Migration Toolkit for Containers"
		},
		{
			"cpe": "cpe:/a:redhat:migration_toolkit_runtimes:1",
			"fix_state": "Under investigation",
			"package_name": "webpack-dev-middleware",
			"product_name": "Migration Toolkit for Runtimes"
		},
		{
			"cpe": "cpe:/a:redhat:migration_toolkit_virtualization:2",
			"fix_state": "Under investigation",
			"package_name": "migration-toolkit-virtualization/mtv-console-plugin-rhel9",
			"product_name": "Migration Toolkit for Virtualization"
		},
		{
			"cpe": "cpe:/a:redhat:multicluster_engine",
			"fix_state": "Affected",
			"package_name": "multicluster-engine/console-mce-rhel8",
			"product_name": "Multicluster Engine for Kubernetes"
		},
		{
			"cpe": "cpe:/a:redhat:multicluster_engine",
			"fix_state": "Affected",
			"package_name": "multicluster-engine/multicluster-engine-console-mce-rhel8",
			"product_name": "Multicluster Engine for Kubernetes"
		},
		{
			"cpe": "cpe:/a:redhat:network_observ_optr:1",
			"fix_state": "Under investigation",
			"package_name": "network-observability/network-observability-console-plugin-rhel8",
			"product_name": "Network Observability Operator"
		},
		{
			"cpe": "cpe:/a:redhat:workload_availability_node_healthcheck",
			"fix_state": "Under investigation",
			"package_name": "workload-availability/node-remediation-console-rhel8",
			"product_name": "Node HealthCheck Operator"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_pipelines:1",
			"fix_state": "Under investigation",
			"package_name": "openshift-pipelines/pipelines-hub-ui-rhel8",
			"product_name": "OpenShift Pipelines"
		},
		{
			"cpe": "cpe:/a:redhat:serverless:1",
			"fix_state": "Under investigation",
			"package_name": "webpack-dev-middleware",
			"product_name": "OpenShift Serverless"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:2",
			"fix_state": "Under investigation",
			"package_name": "openshift-service-mesh/kiali-rhel8",
			"product_name": "OpenShift Service Mesh 2"
		},
		{
			"cpe": "cpe:/a:redhat:red_hat_3scale_amp:2",
			"fix_state": "Under investigation",
			"package_name": "3scale-amp-system-container",
			"product_name": "Red Hat 3scale API Management Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Affected",
			"package_name": "rhacm2/console-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:advanced_cluster_security:3",
			"fix_state": "Under investigation",
			"package_name": "advanced-cluster-security/rhacs-main-rhel8",
			"product_name": "Red Hat Advanced Cluster Security 3"
		},
		{
			"cpe": "cpe:/a:redhat:advanced_cluster_security:4",
			"fix_state": "Under investigation",
			"package_name": "advanced-cluster-security/rhacs-main-rhel8",
			"product_name": "Red Hat Advanced Cluster Security 4"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Under investigation",
			"package_name": "ansible-automation-platform-23/aap-cloud-ui-rhel8",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Under investigation",
			"package_name": "ansible-automation-platform-23/azure-ui-rhel8",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Under investigation",
			"package_name": "automation-controller",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Under investigation",
			"package_name": "automation-eda-controller",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:rhboac_hawtio:4",
			"fix_state": "Under investigation",
			"package_name": "webpack-dev-middleware",
			"product_name": "Red Hat build of Apache Camel - HawtIO"
		},
		{
			"cpe": "cpe:/a:redhat:optaplanner:::el6",
			"fix_state": "Under investigation",
			"package_name": "webpack-dev-middleware",
			"product_name": "Red Hat build of OptaPlanner 8"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:8",
			"fix_state": "Under investigation",
			"package_name": "webpack-dev-middleware",
			"product_name": "Red Hat Data Grid 8"
		},
		{
			"cpe": "cpe:/a:redhat:rhdh:1",
			"fix_state": "Under investigation",
			"package_name": "rhdh-hub-container",
			"product_name": "Red Hat Developer Hub"
		},
		{
			"cpe": "cpe:/a:redhat:discovery:1.0::el8",
			"fix_state": "Affected",
			"package_name": "discovery/discovery-server-rhel8",
			"product_name": "Red Hat Discovery"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "firefox",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "thunderbird",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Under investigation",
			"package_name": "firefox",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Under investigation",
			"package_name": "thunderbird",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Under investigation",
			"package_name": "mozjs60",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Under investigation",
			"package_name": "pcs",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Under investigation",
			"package_name": "gjs",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Under investigation",
			"package_name": "pcs",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Under investigation",
			"package_name": "polkit",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Under investigation",
			"package_name": "webpack-dev-middleware",
			"product_name": "Red Hat Integration Camel K"
		},
		{
			"cpe": "cpe:/a:redhat:service_registry:2",
			"fix_state": "Under investigation",
			"package_name": "webpack-dev-middleware",
			"product_name": "Red Hat Integration Service Registry"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"fix_state": "Under investigation",
			"package_name": "webpack-dev-middleware",
			"product_name": "Red Hat JBoss Fuse 7"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Under investigation",
			"package_name": "openshift4/nmstate-console-plugin-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Under investigation",
			"package_name": "openshift4/ose-console",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Under investigation",
			"package_name": "openshift4/ose-monitoring-plugin-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Under investigation",
			"package_name": "odf4/odf-console-rhel8",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_science",
			"fix_state": "Under investigation",
			"package_name": "rhods/odh-dashboard-rhel8",
			"product_name": "Red Hat OpenShift Data Science (RHODS)"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_science",
			"fix_state": "Under investigation",
			"package_name": "rhods/odh-operator-rhel8",
			"product_name": "Red Hat OpenShift Data Science (RHODS)"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_science",
			"fix_state": "Under investigation",
			"package_name": "rhods/odh-rhel8-operator",
			"product_name": "Red Hat OpenShift Data Science (RHODS)"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_devspaces:3::el8",
			"fix_state": "Under investigation",
			"package_name": "devspaces/traefik-rhel8",
			"product_name": "Red Hat OpenShift Dev Spaces"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:2",
			"fix_state": "Under investigation",
			"package_name": "rhosdt/jaeger-agent-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 2"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_gitops:1",
			"fix_state": "Under investigation",
			"package_name": "openshift-gitops-1/argocd-rhel8",
			"product_name": "Red Hat OpenShift GitOps"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_gitops:1",
			"fix_state": "Under investigation",
			"package_name": "openshift-gitops-1/argo-rollouts-rhel8",
			"product_name": "Red Hat OpenShift GitOps"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_gitops:1",
			"fix_state": "Under investigation",
			"package_name": "openshift-gitops-1/console-plugin-rhel8",
			"product_name": "Red Hat OpenShift GitOps"
		},
		{
			"cpe": "cpe:/a:redhat:container_native_virtualization:4",
			"fix_state": "Under investigation",
			"package_name": "container-native-virtualization/kubevirt-console-plugin",
			"product_name": "Red Hat OpenShift Virtualization 4"
		},
		{
			"cpe": "cpe:/a:redhat:container_native_virtualization:4",
			"fix_state": "Under investigation",
			"package_name": "container-native-virtualization/kubevirt-console-plugin-rhel9",
			"product_name": "Red Hat OpenShift Virtualization 4"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7",
			"fix_state": "Under investigation",
			"package_name": "webpack-dev-middleware",
			"product_name": "Red Hat Process Automation 7"
		},
		{
			"cpe": "cpe:/a:redhat:quay:3",
			"fix_state": "Under investigation",
			"package_name": "quay/quay-rhel8",
			"product_name": "Red Hat Quay 3"
		}
	],
	"upstream_fix": "webpack-dev-middleware 5.3.4, webpack-dev-middleware 6.1.2, webpack-dev-middleware 7.1.0",
	"csaw": false
}
