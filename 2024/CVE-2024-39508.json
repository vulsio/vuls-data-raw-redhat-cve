{
	"name": "CVE-2024-39508",
	"threat_severity": "Moderate",
	"public_date": "2024-07-12T00:00:00Z",
	"bugzilla": {
		"description": "kernel: io_uring/io-wq: Use set_bit() and test_bit() at worker->flags",
		"id": "2297480",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2297480"
	},
	"cvss3": {
		"cvss3_base_score": "7.0",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
		"status": "draft"
	},
	"cwe": "(CWE-367|CWE-364)",
	"details": [
		"In the Linux kernel, the following vulnerability has been resolved:\nio_uring/io-wq: Use set_bit() and test_bit() at worker->flags\nUtilize set_bit() and test_bit() on worker->flags within io_uring/io-wq\nto address potential data races.\nThe structure io_worker->flags may be accessed through various data\npaths, leading to concurrency issues. When KCSAN is enabled, it reveals\ndata races occurring in io_worker_handle_work and\nio_wq_activate_free_worker functions.\nBUG: KCSAN: data-race in io_worker_handle_work / io_wq_activate_free_worker\nwrite to 0xffff8885c4246404 of 4 bytes by task 49071 on cpu 28:\nio_worker_handle_work (io_uring/io-wq.c:434 io_uring/io-wq.c:569)\nio_wq_worker (io_uring/io-wq.c:?)\n<snip>\nread to 0xffff8885c4246404 of 4 bytes by task 49024 on cpu 5:\nio_wq_activate_free_worker (io_uring/io-wq.c:? io_uring/io-wq.c:285)\nio_wq_enqueue (io_uring/io-wq.c:947)\nio_queue_iowq (io_uring/io_uring.c:524)\nio_req_task_submit (io_uring/io_uring.c:1511)\nio_handle_tw_list (io_uring/io_uring.c:1198)\n<snip>\nLine numbers against commit 18daea77cca6 (\"Merge tag 'for-linus' of\ngit://git.kernel.org/pub/scm/virt/kvm/kvm\").\nThese races involve writes and reads to the same memory location by\ndifferent tasks running on different CPUs. To mitigate this, refactor\nthe code to use atomic operations such as set_bit(), test_bit(), and\nclear_bit() instead of basic \"and\" and \"or\" operations. This ensures\nthread-safe manipulation of worker flags.\nAlso, move `create_index` to avoid holes in the structure."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-39508\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-39508\nhttps://lore.kernel.org/linux-cve-announce/2024071206-CVE-2024-39508-20c3@gregkh/T"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
	},
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "kernel 6.6.35, kernel 6.9.6, kernel 6.10-rc1",
	"csaw": false
}
