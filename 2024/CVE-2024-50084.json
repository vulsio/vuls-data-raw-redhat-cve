{
	"name": "CVE-2024-50084",
	"threat_severity": "Moderate",
	"public_date": "2024-10-29T00:00:00Z",
	"bugzilla": {
		"description": "kernel: net: microchip: vcap api: Fix memory leaks in vcap_api_encode_rule_test()",
		"id": "2322304",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2322304"
	},
	"cvss3": {
		"cvss3_base_score": "5.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
		"status": "draft"
	},
	"cwe": "CWE-401",
	"details": [
		"In the Linux kernel, the following vulnerability has been resolved:\nnet: microchip: vcap api: Fix memory leaks in vcap_api_encode_rule_test()\nCommit a3c1e45156ad (\"net: microchip: vcap: Fix use-after-free error in\nkunit test\") fixed the use-after-free error, but introduced below\nmemory leaks by removing necessary vcap_free_rule(), add it to fix it.\nunreferenced object 0xffffff80ca58b700 (size 192):\ncomm \"kunit_try_catch\", pid 1215, jiffies 4294898264\nhex dump (first 32 bytes):\n00 12 7a 00 05 00 00 00 0a 00 00 00 64 00 00 00  ..z.........d...\n00 00 00 00 00 00 00 00 00 04 0b cc 80 ff ff ff  ................\nbacktrace (crc 9c09c3fe):\n[<0000000052a0be73>] kmemleak_alloc+0x34/0x40\n[<0000000043605459>] __kmalloc_cache_noprof+0x26c/0x2f4\n[<0000000040a01b8d>] vcap_alloc_rule+0x3cc/0x9c4\n[<000000003fe86110>] vcap_api_encode_rule_test+0x1ac/0x16b0\n[<00000000b3595fc4>] kunit_try_run_case+0x13c/0x3ac\n[<0000000010f5d2bf>] kunit_generic_run_threadfn_adapter+0x80/0xec\n[<00000000c5d82c9a>] kthread+0x2e8/0x374\n[<00000000f4287308>] ret_from_fork+0x10/0x20\nunreferenced object 0xffffff80cc0b0400 (size 64):\ncomm \"kunit_try_catch\", pid 1215, jiffies 4294898265\nhex dump (first 32 bytes):\n80 04 0b cc 80 ff ff ff 18 b7 58 ca 80 ff ff ff  ..........X.....\n39 00 00 00 02 00 00 00 06 05 04 03 02 01 ff ff  9...............\nbacktrace (crc daf014e9):\n[<0000000052a0be73>] kmemleak_alloc+0x34/0x40\n[<0000000043605459>] __kmalloc_cache_noprof+0x26c/0x2f4\n[<000000000ff63fd4>] vcap_rule_add_key+0x2cc/0x528\n[<00000000dfdb1e81>] vcap_api_encode_rule_test+0x224/0x16b0\n[<00000000b3595fc4>] kunit_try_run_case+0x13c/0x3ac\n[<0000000010f5d2bf>] kunit_generic_run_threadfn_adapter+0x80/0xec\n[<00000000c5d82c9a>] kthread+0x2e8/0x374\n[<00000000f4287308>] ret_from_fork+0x10/0x20\nunreferenced object 0xffffff80cc0b0700 (size 64):\ncomm \"kunit_try_catch\", pid 1215, jiffies 4294898265\nhex dump (first 32 bytes):\n80 07 0b cc 80 ff ff ff 28 b7 58 ca 80 ff ff ff  ........(.X.....\n3c 00 00 00 00 00 00 00 01 2f 03 b3 ec ff ff ff  <......../......\nbacktrace (crc 8d877792):\n[<0000000052a0be73>] kmemleak_alloc+0x34/0x40\n[<0000000043605459>] __kmalloc_cache_noprof+0x26c/0x2f4\n[<000000006eadfab7>] vcap_rule_add_action+0x2d0/0x52c\n[<00000000323475d1>] vcap_api_encode_rule_test+0x4d4/0x16b0\n[<00000000b3595fc4>] kunit_try_run_case+0x13c/0x3ac\n[<0000000010f5d2bf>] kunit_generic_run_threadfn_adapter+0x80/0xec\n[<00000000c5d82c9a>] kthread+0x2e8/0x374\n[<00000000f4287308>] ret_from_fork+0x10/0x20\nunreferenced object 0xffffff80cc0b0900 (size 64):\ncomm \"kunit_try_catch\", pid 1215, jiffies 4294898266\nhex dump (first 32 bytes):\n80 09 0b cc 80 ff ff ff 80 06 0b cc 80 ff ff ff  ................\n7d 00 00 00 01 00 00 00 00 00 00 00 ff 00 00 00  }...............\nbacktrace (crc 34181e56):\n[<0000000052a0be73>] kmemleak_alloc+0x34/0x40\n[<0000000043605459>] __kmalloc_cache_noprof+0x26c/0x2f4\n[<000000000ff63fd4>] vcap_rule_add_key+0x2cc/0x528\n[<00000000991e3564>] vcap_val_rule+0xcf0/0x13e8\n[<00000000fc9868e5>] vcap_api_encode_rule_test+0x678/0x16b0\n[<00000000b3595fc4>] kunit_try_run_case+0x13c/0x3ac\n[<0000000010f5d2bf>] kunit_generic_run_threadfn_adapter+0x80/0xec\n[<00000000c5d82c9a>] kthread+0x2e8/0x374\n[<00000000f4287308>] ret_from_fork+0x10/0x20\nunreferenced object 0xffffff80cc0b0980 (size 64):\ncomm \"kunit_try_catch\", pid 1215, jiffies 4294898266\nhex dump (first 32 bytes):\n18 b7 58 ca 80 ff ff ff 00 09 0b cc 80 ff ff ff  ..X.............\n67 00 00 00 00 00 00 00 01 01 74 88 c0 ff ff ff  g.........t.....\nbacktrace (crc 275fd9be):\n[<0000000052a0be73>] kmemleak_alloc+0x34/0x40\n[<0000000043605459>] __kmalloc_cache_noprof+0x26c/0x2f4\n[<000000000ff63fd4>] vcap_rule_add_key+0x2cc/0x528\n[<000000001396a1a2>] test_add_de\n---truncated---"
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-50084\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-50084\nhttps://lore.kernel.org/linux-cve-announce/2024102937-CVE-2024-50084-daf1@gregkh/T"
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"csaw": false
}
