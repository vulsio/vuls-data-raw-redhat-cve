{
	"name": "CVE-2024-1085",
	"threat_severity": "Important",
	"public_date": "2024-01-31T00:00:00Z",
	"bugzilla": {
		"description": "kernel: nf_tables: use-after-free vulnerability in the nft_setelem_catchall_deactivate() function",
		"id": "2262127",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2262127"
	},
	"cvss3": {
		"cvss3_base_score": "7.8",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
		"status": "draft"
	},
	"cwe": "CWE-416",
	"details": [
		"A flaw was found in the Netfilter subsystem in the Linux kernel. This issue occurs in the nft_setelem_catchall_deactivate() function, where it checks whether the catch-all set element is active in the current generation instead of the next generation before freeing it, but only flags it inactive in the next generation, making it possible to free the element multiple times, leading to a double-free vulnerability. The nf_tables component can be exploited to achieve local privilege escalation."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-1085\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-1085\nhttps://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7\nhttps://kernel.dance/b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "To mitigate this issue, it is possible to prevent the affected code from being loaded by blacklisting the kernel netfilter module. \nFor instructions relating to how to blacklist a kernel module refer to: https://access.redhat.com/solutions/41278"
	},
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "kernel 6.8-rc1",
	"csaw": false
}
