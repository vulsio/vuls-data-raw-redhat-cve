{
	"name": "CVE-2024-45614",
	"threat_severity": "Moderate",
	"public_date": "2024-09-19T23:15:11Z",
	"bugzilla": {
		"description": "rubygem-puma: Header normalization allows for client to clobber proxy set headers",
		"id": "2313672",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2313672"
	},
	"cvss3": {
		"cvss3_base_score": "5.9",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
		"status": "draft"
	},
	"cwe": "CWE-639",
	"details": [
		"Puma is a Ruby/Rack web server built for parallelism. In affected versions clients could clobber values set by intermediate proxies (such as X-Forwarded-For) by providing a underscore version of the same header (X-Forwarded_For). Any users relying on proxy set variables is affected. v6.4.3/v5.6.9 now discards any headers using underscores if the non-underscore version also exists. Effectively, allowing the proxy defined headers to always win. Users are advised to upgrade. Nginx has a underscores_in_headers configuration variable to discard these headers at the proxy level as a mitigation. Any users that are implicitly trusting the proxy defined headers for security should immediately cease doing so until upgraded to the fixed versions.",
		"A flaw was found in rubygem-puma. In affected versions, clients could clobber values set by intermediate proxies (such as X-Forwarded-For) by providing an underscore version of the same header (X-Forwarded_For). Any users relying on proxy set variables are affected. v6.4.3/v5.6.9 now discards any headers using underscores if the non-underscore version also exists. Effectively, allowing the proxy defined headers to always win. Users are advised to upgrade. As a mitigation, Nginx has an underscores_in_headers configuration variable to discard these headers at the proxy level. Any users that are implicitly trusting the proxy defined headers for security should immediately cease doing so until upgraded to the fixed versions."
	],
	"statement": "This issue is classified as moderate severity rather than important because, while it allows clients to manipulate proxy-set headers like `X-Forwarded-For`, its exploitability depends on specific conditions. The vulnerability only affects applications that rely on these headers for security purposes, such as IP-based access controls or logging, and is mitigated by proper server configurations (e.g., using `underscores_in_headers off` in Nginx). Furthermore, it does not directly compromise the server's integrity or enable arbitrary code execution.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-45614\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-45614\nhttps://github.com/puma/puma/security/advisories/GHSA-9hf4-67fc-4vf4\nhttps://nginx.org/en/docs/http/ngx_http_core_module.html#underscores_in_headers"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
	},
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "pcs",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "pcs",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Affected",
			"package_name": "rubygem-puma",
			"product_name": "Red Hat Satellite 6"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Affected",
			"package_name": "satellite:el8/rubygem-puma",
			"product_name": "Red Hat Satellite 6"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Affected",
			"package_name": "rubygem-puma",
			"product_name": "Red Hat Storage 3"
		}
	],
	"csaw": false
}
