{
	"name": "CVE-2024-7143",
	"threat_severity": "Moderate",
	"public_date": "2024-08-07T13:50:03Z",
	"bugzilla": {
		"description": "pulpcore: RBAC permissions incorrectly assigned in tasks that create objects",
		"id": "2300125",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2300125"
	},
	"cvss3": {
		"cvss3_base_score": "6.7",
		"cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:L",
		"status": "draft"
	},
	"cwe": "CWE-277",
	"details": [
		"A flaw was found in the Pulp package. When a role-based access control (RBAC) object in Pulp is set to assign permissions on its creation, it uses the `AutoAddObjPermsMixin` (typically the add_roles_for_object_creator method). This method finds the object creator by checking the current authenticated user. For objects that are created within a task, this current user is set by the first user with any permissions on the task object. This means the oldest user with model/domain-level task permissions will always be set as the current user of a task, even if they didn't dispatch the task. Therefore, all objects created in tasks will have their permissions assigned to this oldest user, and the creating user will receive nothing.",
		"A flaw was found in the Pulp package. When a role-based access control (RBAC) object in Pulp is set to assign permissions on its creation, it uses the `AutoAddObjPermsMixin` (typically the add_roles_for_object_creator method). This method finds the object creator by checking the current authenticated user. For objects that are created within a task, this current user is set by the first user with any permissions on the task object. This means the oldest user with model/domain-level task permissions will always be set as the current user of a task, even if they didn't dispatch the task. Therefore, all objects created in tasks will have their permissions assigned to this oldest user, and the creating user will receive nothing."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-7143\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-7143\nhttps://github.com/pulp/pulpcore/blob/93f241f34c503da0fbac94bdba739feda2636e12/pulpcore/tasking/_util.py#L108"
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Affected",
			"package_name": "python3x-pulpcore",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Affected",
			"package_name": "python-pulpcore",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Affected",
			"package_name": "python-pulpcore",
			"product_name": "Red Hat Satellite 6"
		},
		{
			"cpe": "cpe:/a:redhat:rhui:4::el8",
			"fix_state": "Affected",
			"package_name": "python-pulpcore",
			"product_name": "Red Hat Update Infrastructure 4 for Cloud Providers"
		}
	],
	"csaw": false
}
