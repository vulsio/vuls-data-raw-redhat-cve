{
	"name": "CVE-2024-42161",
	"threat_severity": "Moderate",
	"public_date": "2024-07-30T00:00:00Z",
	"bugzilla": {
		"description": "kernel: bpf: Avoid uninitialized value in BPF_CORE_READ_BITFIELD",
		"id": "2301539",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2301539"
	},
	"cvss3": {
		"cvss3_base_score": "6.3",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:L/I:H/A:H",
		"status": "draft"
	},
	"cwe": "CWE-457",
	"details": [
		"In the Linux kernel, the following vulnerability has been resolved:\nbpf: Avoid uninitialized value in BPF_CORE_READ_BITFIELD\n[Changes from V1:\n- Use a default branch in the switch statement to initialize `val'.]\nGCC warns that `val' may be used uninitialized in the\nBPF_CRE_READ_BITFIELD macro, defined in bpf_core_read.h as:\n[...]\nunsigned long long val;      \\\n[...]      \\\nswitch (__CORE_RELO(s, field, BYTE_SIZE)) {      \\\ncase 1: val = *(const unsigned char *)p; break;      \\\ncase 2: val = *(const unsigned short *)p; break;      \\\ncase 4: val = *(const unsigned int *)p; break;      \\\ncase 8: val = *(const unsigned long long *)p; break;      \\\n}             \\\n[...]\nval;      \\\n}      \\\nThis patch adds a default entry in the switch statement that sets\n`val' to zero in order to avoid the warning, and random values to be\nused in case __builtin_preserve_field_info returns unexpected values\nfor BPF_FIELD_BYTE_SIZE.\nTested in bpf-next master.\nNo regressions.",
		"A vulnerability was found in the Linux kernel in the bpf_enum_value_kind() function, where a lack of proper checks could lead to an uninitialized variable being used. This issue could lead to undefined behavior or memory corruption."
	],
	"statement": "Red Hat believes this flaw to be of Moderate severity because this vulnerability impacts the core code of the BPF component. To have access to this component's functionality, a user would require elevated privileges (CAP_SYS_ADMIN). Successful exploit of this vulnerability would have a low impact on confidentiality, as a crash would not necessarily expose sensitive information.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-42161\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-42161\nhttps://lore.kernel.org/linux-cve-announce/2024073036-CVE-2024-42161-7104@gregkh/T"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
	},
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Will not fix",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Will not fix",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "kernel 5.10.222, kernel 5.15.163, kernel 6.1.98, kernel 6.6.39, kernel 6.9.9, kernel 6.10",
	"csaw": false
}
