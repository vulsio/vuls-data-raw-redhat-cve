{
	"name": "CVE-2024-23334",
	"threat_severity": "Moderate",
	"public_date": "2024-01-30T00:00:00Z",
	"bugzilla": {
		"description": "aiohttp: follow_symlinks directory traversal vulnerability",
		"id": "2261887",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2261887"
	},
	"cvss3": {
		"cvss3_base_score": "5.9",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
		"status": "verified"
	},
	"cwe": "CWE-22",
	"details": [
		"aiohttp is an asynchronous HTTP client/server framework for asyncio and Python. When using aiohttp as a web server and configuring static routes, it is necessary to specify the root path for static files. Additionally, the option 'follow_symlinks' can be used to determine whether to follow symbolic links outside the static root directory. When 'follow_symlinks' is set to True, there is no validation to check if reading a file is within the root directory. This can lead to directory traversal vulnerabilities, resulting in unauthorized access to arbitrary files on the system, even when symlinks are not present.  Disabling follow_symlinks and using a reverse proxy are encouraged mitigations.  Version 3.9.2 fixes this issue.",
		"A flaw was found in aiohttp. When using aiohttp as a web server and configuring static routes, it is necessary to specify the root path for static files. Additionally, the option 'follow_symlinks' can be used to determine whether to follow symbolic links outside the static root directory. When 'follow_symlinks' is set to True, there is no validation to check if a given file path is within the root directory. This issue can lead to a directory traversal vulnerability, resulting in unauthorized access to arbitrary files on the system, even when symlinks are not present."
	],
	"statement": "This vulnerability has been rated as having a moderate impact. There is a non-default precondition which is required to exploit it: the follow_symlinks setting needs to be enabled.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-23334\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-23334\nhttps://github.com/aio-libs/aiohttp/security/advisories/GHSA-5h86-8mv2-jq9f"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "If using follow_symlinks=True outside of a restricted local development environment, disable the option immediately. This option is NOT needed to follow symlinks that point to a location within the static root directory; it is only intended to allow a symlink to break out of the static directory. Even with this CVE fixed, there is still a substantial risk of misconfiguration when using this option on a server that accepts requests from remote users.\nAdditionally, aiohttp has always recommended using a reverse proxy server (such as nginx) to handle static resources and not to use these static resources in aiohttp for production environments. Doing so also protects against this vulnerability, and is why we expect the number of affected users to be very low."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2024:1640",
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2.4::el8",
			"package": "automation-controller-0:4.5.5-2.el8ap",
			"product_name": "Red Hat Ansible Automation Platform 2.4 for RHEL 8",
			"release_date": "2024-04-02T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1640",
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2.4::el8",
			"package": "python3x-aiohttp-0:3.9.3-1.el8ap",
			"product_name": "Red Hat Ansible Automation Platform 2.4 for RHEL 8",
			"release_date": "2024-04-02T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1640",
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2.4::el9",
			"package": "automation-controller-0:4.5.5-2.el9ap",
			"product_name": "Red Hat Ansible Automation Platform 2.4 for RHEL 9",
			"release_date": "2024-04-02T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1640",
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2.4::el9",
			"package": "python-aiohttp-0:3.9.3-1.el9ap",
			"product_name": "Red Hat Ansible Automation Platform 2.4 for RHEL 9",
			"release_date": "2024-04-02T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1536",
			"cpe": "cpe:/a:redhat:satellite:6.14::el8",
			"package": "python-aiohttp-0:3.9.2-0.1.el8pc",
			"product_name": "Red Hat Satellite 6.14 for RHEL 8",
			"release_date": "2024-03-27T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1536",
			"cpe": "cpe:/a:redhat:satellite_capsule:6.14::el8",
			"package": "python-aiohttp-0:3.9.2-0.1.el8pc",
			"product_name": "Red Hat Satellite 6.14 for RHEL 8",
			"release_date": "2024-03-27T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:2010",
			"cpe": "cpe:/a:redhat:satellite:6.15::el8",
			"package": "python-aiohttp-0:3.9.2-1.el8pc",
			"product_name": "Red Hat Satellite 6.15 for RHEL 8",
			"release_date": "2024-04-23T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:2010",
			"cpe": "cpe:/a:redhat:satellite_capsule:6.15::el8",
			"package": "python-aiohttp-0:3.9.2-1.el8pc",
			"product_name": "Red Hat Satellite 6.15 for RHEL 8",
			"release_date": "2024-04-23T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1878",
			"cpe": "cpe:/a:redhat:rhui:4::el8",
			"package": "python-aiohttp-0:3.9.2-1.el8ui",
			"product_name": "RHUI 4 for RHEL 8",
			"release_date": "2024-04-18T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform",
			"fix_state": "Out of support scope",
			"package_name": "ansible-tower",
			"product_name": "Red Hat Ansible Automation Platform 1.2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Not affected",
			"package_name": "ansible-automation-platform-24/ansible-builder-rhel8",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Not affected",
			"package_name": "ansible-automation-platform-24/ee-cloud-services-rhel8",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Not affected",
			"package_name": "ansible-automation-platform-24/ee-dellemc-openmanage-rhel8",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Not affected",
			"package_name": "ansible-automation-platform-24/ee-minimal-rhel8",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Not affected",
			"package_name": "ansible-automation-platform-24/ee-supported-rhel8",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Not affected",
			"package_name": "ansible-automation-platform-24/platform-resource-runner-rhel8",
			"product_name": "Red Hat Ansible Automation Platform 2"
		}
	],
	"upstream_fix": "aiohttp 3.9.2",
	"csaw": false
}
