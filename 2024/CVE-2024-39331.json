{
	"name": "CVE-2024-39331",
	"threat_severity": "Moderate",
	"public_date": "2024-06-23T00:00:00Z",
	"bugzilla": {
		"description": "emacs: org-link-expand-abbrev: Do not evaluate arbitrary unsafe Elisp code",
		"id": "2293942",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2293942"
	},
	"cvss3": {
		"cvss3_base_score": "7.8",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-95",
	"details": [
		"In Emacs before 29.4, org-link-expand-abbrev in lisp/ol.el expands a %(...) link abbrev even when it specifies an unsafe function, such as shell-command-to-string. This affects Org Mode before 9.7.5.",
		"A flaw was found in Emacs. Arbitrary shell commands can be executed without prompting when an Org mode file is opened or when the Org mode is enabled, when Emacs is used as an email client, this issue can be triggered when previewing email attachments."
	],
	"statement": "To exploit this flaw, an attacker needs to trick a user into opening a crafted Org mode file or previewing a crafted email attachment. For this reason, this flaw has been rated with a Moderate security impact.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-39331\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-39331\nhttps://www.openwall.com/lists/oss-security/2024/06/23/1"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Do not open Org mode files or preview email attachments from untrusted sources."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2024:4971",
			"cpe": "cpe:/a:redhat:rhel_aus:8.6",
			"package": "emacs-1:26.1-7.el8_6.5",
			"product_name": "Red Hat Enterprise Linux 8.6 Advanced Mission Critical Update Support",
			"release_date": "2024-08-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4971",
			"cpe": "cpe:/a:redhat:rhel_tus:8.6",
			"package": "emacs-1:26.1-7.el8_6.5",
			"product_name": "Red Hat Enterprise Linux 8.6 Telecommunications Update Service",
			"release_date": "2024-08-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:4971",
			"cpe": "cpe:/a:redhat:rhel_e4s:8.6",
			"package": "emacs-1:26.1-7.el8_6.5",
			"product_name": "Red Hat Enterprise Linux 8.6 Update Services for SAP Solutions",
			"release_date": "2024-08-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:6203",
			"cpe": "cpe:/a:redhat:rhel_eus:8.8",
			"package": "emacs-1:26.1-10.el8_8.6",
			"product_name": "Red Hat Enterprise Linux 8.8 Extended Update Support",
			"release_date": "2024-09-03T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "emacs",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "emacs",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "emacs",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "emacs",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "emacs 29.4",
	"csaw": false
}
