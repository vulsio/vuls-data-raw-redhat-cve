{
	"name": "CVE-2024-26603",
	"threat_severity": "Low",
	"public_date": "2024-02-24T00:00:00Z",
	"bugzilla": {
		"description": "kernel: x86/fpu: Stop relying on userspace for info to fault in xsave buffer that cause loop forever",
		"id": "2265833",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2265833"
	},
	"cvss3": {
		"cvss3_base_score": "5.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
		"status": "verified"
	},
	"cwe": "CWE-835",
	"details": [
		"In the Linux kernel, the following vulnerability has been resolved:\nx86/fpu: Stop relying on userspace for info to fault in xsave buffer\nBefore this change, the expected size of the user space buffer was\ntaken from fx_sw->xstate_size. fx_sw->xstate_size can be changed\nfrom user-space, so it is possible construct a sigreturn frame where:\n* fx_sw->xstate_size is smaller than the size required by valid bits in\nfx_sw->xfeatures.\n* user-space unmaps parts of the sigrame fpu buffer so that not all of\nthe buffer required by xrstor is accessible.\nIn this case, xrstor tries to restore and accesses the unmapped area\nwhich results in a fault. But fault_in_readable succeeds because buf +\nfx_sw->xstate_size is within the still mapped area, so it goes back and\ntries xrstor again. It will spin in this loop forever.\nInstead, fault in the maximum size which can be touched by XRSTOR (taken\nfrom fpstate->user_size).\n[ dhansen: tweak subject / changelog ]",
		"A flaw was found in the Linux kernel's x86/fpu module, which revolves around an issue with relying on user space for critical information regarding the xsave buffer. In the affected scenario, the expected size of the user space buffer is derived from user-controlled data, specifically, fx_sw->xstate_size. By manipulating this value, an attacker could construct a malicious sigreturn frame where the indicated size is smaller than required by valid bits in fx_sw->xfeatures. Furthermore, the attacker could unmap portions of the fpu buffer in the user space, rendering them inaccessible to xrstor.\nThis manipulation leads to a situation where xrstor repeatedly attempts to restore and access an unmapped area, causing a fault. However, the fault_in_readable function erroneously succeeds because the accessed region, buf + fx_sw->xstate_size, remains within the mapped area. Consequently, the system enters a perpetual loop as xrstor continually retries the operation."
	],
	"statement": "This vulnerability, while technically significant due to its potential for exploitation, is classified as Low severity for several reasons. First, successful exploitation requires a precise set of conditions, including the ability to manipulate the fx_sw->xstate_size parameter, which may not always be feasible. Additionally, the exploit's impact is limited to a specific subsystem (x86/fpu) within the Linux kernel, thereby reducing its overall scope and potential for widespread harm. Moreover, the loop resulting from the fault condition does not result in a system compromise or escalation of privileges but rather leads to a denial-of-service situation, which can be mitigated through a system reboot or other administrative actions.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-26603\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-26603\nhttps://lore.kernel.org/linux-cve-announce/2024022415-CVE-2024-26603-42c2@gregkh/T/#u"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2024:3627",
			"cpe": "cpe:/a:redhat:enterprise_linux:8::nfv",
			"package": "kernel-rt-0:4.18.0-553.5.1.rt7.346.el8_10",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2024-06-05T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:3618",
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"package": "kernel-0:4.18.0-553.5.1.el8_10",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2024-06-05T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:9315",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"package": "kernel-0:5.14.0-503.11.1.el9_5",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2024-11-12T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:9315",
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"package": "kernel-0:5.14.0-503.11.1.el9_5",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2024-11-12T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "kernel 6.1.79, kernel 6.6.18, kernel 6.7.6, kernel 6.8-rc4",
	"csaw": false
}
