{
	"name": "CVE-2024-45806",
	"threat_severity": "Moderate",
	"public_date": "2024-09-20T00:15:02Z",
	"bugzilla": {
		"description": "envoy: Potential to manipulate `x-envoy` headers from external sources",
		"id": "2313683",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2313683"
	},
	"cvss3": {
		"cvss3_base_score": "7.4",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N",
		"status": "draft"
	},
	"cwe": "CWE-639",
	"details": [
		"Envoy is a cloud-native high-performance edge/middle/service proxy. A security vulnerability in Envoy allows external clients to manipulate Envoy headers, potentially leading to unauthorized access or other malicious actions within the mesh. This issue arises due to Envoy's default configuration of internal trust boundaries, which considers all RFC1918 private address ranges as internal. The default behavior for handling internal addresses in Envoy has been changed. Previously, RFC1918 IP addresses were automatically considered internal, even if the internal_address_config was empty.  The default configuration of Envoy will continue to trust internal addresses while in this release and it will not trust them by default in next release. If you have tooling such as probes on your private network which need to be treated as trusted (e.g. changing arbitrary x-envoy headers) please explicitly include those addresses or CIDR ranges into `internal_address_config`. Successful exploitation could allow attackers to bypass security controls, access sensitive data, or disrupt services within the mesh, like Istio. This issue has been addressed in versions 1.31.2, 1.30.6, 1.29.9, and 1.28.7. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
		"A vulnerability was found in Envoy that allows external clients to manipulate Envoy headers, potentially leading to unauthorized access or other malicious actions within the mesh. This issue arises due to Envoy's default configuration of internal trust boundaries, which considers all RFC1918 private address ranges as internal. The default behavior for handling internal addresses in Envoy has been changed. Previously, RFC1918 IP addresses were automatically considered internal, even if the internal_address_config was empty. The default configuration of Envoy will continue to trust internal addresses while in this release and it will not trust them by default in next release. If you have tooling such as probes on your private network which need to be treated as trusted such as changing arbitrary x-envoy headers, please explicitly include those addresses or CIDR ranges into `internal_address_config`. Successful exploitation could allow attackers to bypass security controls, access sensitive data, or disrupt services within the mesh, like Istio."
	],
	"statement": "Red Hat's CVSS score and impact are specific to our product and may not match those of upstream. This is due to how envoy is configured and used within our OpenShift Service Mesh product.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-45806\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-45806\nhttps://github.com/envoyproxy/envoy/security/advisories/GHSA-ffhv-fvxq-r6mf"
	],
	"acknowledgement": "This issue was discovered by James Force (Red Hat) and Mike Whale.",
	"mitigation": {
		"lang": "en:us",
		"value": "This flaw can be mitigated by configuring envoy to treat all IPs as external. This is done by setting the internal_address_config range for envoy to `0.0.0.0/32`."
	},
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:service_mesh:2",
			"fix_state": "Not affected",
			"package_name": "openshift-service-mesh/istio-cni-rhel8",
			"product_name": "OpenShift Service Mesh 2"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:2",
			"fix_state": "Not affected",
			"package_name": "openshift-service-mesh/pilot-rhel8",
			"product_name": "OpenShift Service Mesh 2"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:2",
			"fix_state": "Will not fix",
			"package_name": "openshift-service-mesh/proxyv2-rhel8",
			"product_name": "OpenShift Service Mesh 2"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:2",
			"fix_state": "Affected",
			"package_name": "openshift-service-mesh/proxyv2-rhel9",
			"product_name": "OpenShift Service Mesh 2"
		}
	],
	"csaw": false
}
