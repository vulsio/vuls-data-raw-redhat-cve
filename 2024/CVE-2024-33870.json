{
	"name": "CVE-2024-33870",
	"threat_severity": "Moderate",
	"public_date": "2024-05-16T00:00:00Z",
	"bugzilla": {
		"description": "ghostscript: path traversal to arbitrary files if the current directory is in the permitted paths",
		"id": "2293959",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2293959"
	},
	"cvss3": {
		"cvss3_base_score": "6.8",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:L",
		"status": "draft"
	},
	"cwe": "CWE-23",
	"details": [
		"An issue was discovered in Artifex Ghostscript before 10.03.1. There is path traversal (via a crafted PostScript document) to arbitrary files if the current directory is in the permitted paths. For example, there can be a transformation of ../../foo to ./../../foo and this will grant access if ./ is permitted.",
		"A flaw was found in Ghostscript. When the `gp_validate_path_len` function validates a path, it distinguishes between absolute and relative paths. In the case of relative paths, it will check the path with and without the current-directory-prefix (\"foo\" and \"./foo\"). This does not take into account paths with a parent-directory-prefix. Therefore, a path like \"../../foo\" is also tested as \"./../../foo\" and if the current directory \"./\" is in the permitted paths, it will pass the check, which may allow arbitrary file access."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-33870\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-33870"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
	},
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "ghostscript",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "ghostscript",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Will not fix",
			"package_name": "ghostscript",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "gimp:flatpak/ghostscript",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "ghostscript",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "ghostscript 10.03.1",
	"csaw": false
}
