{
	"name": "CVE-2024-28219",
	"threat_severity": "Moderate",
	"public_date": "2024-04-01T00:00:00Z",
	"bugzilla": {
		"description": "python-pillow: buffer overflow in _imagingcms.c",
		"id": "2272563",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2272563"
	},
	"cvss3": {
		"cvss3_base_score": "8.2",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H",
		"status": "draft"
	},
	"cwe": "CWE-20->CWE-120",
	"details": [
		"In _imagingcms.c in Pillow before 10.3.0, a buffer overflow exists because strcpy is used instead of strncpy.",
		"A flaw was found in Pillow. The cms_transform_new function in src/_imagingcms.c does not validate the length of its parameters before copying them into fixed-size buffers, leading to a buffer overflow, resulting in a denial of service."
	],
	"statement": "This flaw can be triggered when the ImageCms.buildTransform function is called with the InMode or OutMode arguments with a string larger than 8 bytes. An application is not vulnerable if these parameters are not controlled by the user or are validated before the function is called. Additionally, the Pillow ImageCms module functions should not be exposed to untrusted usage without input validation. For this reason, this flaw has been rated with a moderate impact.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-28219\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-28219"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Make sure the ImageCms.buildTransform function is not called with the InMode or OutMode arguments with a string bigger than 8 bytes."
	},
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Affected",
			"package_name": "python3x-pillow",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Affected",
			"package_name": "python-pillow",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "python-pillow",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "python-pillow",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/a:redhat:quay:3",
			"fix_state": "Affected",
			"package_name": "quay/quay-rhel8",
			"product_name": "Red Hat Quay 3"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Affected",
			"package_name": "python-pillow",
			"product_name": "Red Hat Satellite 6"
		}
	],
	"upstream_fix": "pillow 10.3.0",
	"csaw": false
}
