{
	"name": "CVE-2024-29510",
	"threat_severity": "Moderate",
	"public_date": "2024-05-16T00:00:00Z",
	"bugzilla": {
		"description": "ghostscript: format string injection leads to shell command execution (SAFER bypass)",
		"id": "2293950",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2293950"
	},
	"cvss3": {
		"cvss3_base_score": "5.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N",
		"status": "draft"
	},
	"cwe": "CWE-20",
	"details": [
		"Artifex Ghostscript before 10.03.1 allows memory corruption, and SAFER sandbox bypass, via format string injection with a uniprint device.",
		"A flaw was found in Ghostscript. The `uniprint` device allows the user to provide various string fragments as device options, which are later appended to the output file. Two parameters, `upWriteComponentCommands` and `upYMoveCommand,` are treated as format strings, specifically for `gp_fprintf` and `gs_snprintf.` This was designed for the user to include just one format specifier in the string, but there is no logic preventing arbitrary format strings with multiple specifiers from being used. In certain circumstances, an attacker may be able to exploit this to leak data from the stack and perform memory corruption."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-29510\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-29510"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Passing the -dSAFER safety argument on the command line prevents the issue by locking security-related variables after Ghostscript's initialization. In RHEL 9, -dSAFER is enabled by default, ensuring that insecure commands are rejected in a safer environment. In RHEL 7 and 8, the SAFER environment variable is not enabled by default meaning the vulnerability (focused on bypassing the SAFER environment) is not applicable.  If the SAFER environment variable is enabled, then the proposed mitigation is to explicitly pass -dSAFER on the command line, addressing the vulnerability that allows insecure commands within PostScript files. Since the OPVP device cannot be removed, we recommend to use -dSAFER in RHEL 7 and 8 as a practical security measure."
	},
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "ghostscript",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "ghostscript",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "ghostscript",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Will not fix",
			"package_name": "gimp:flatpak/ghostscript",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "ghostscript",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "ghostscript 10.03.1",
	"csaw": false
}
