{
	"name": "CVE-2024-46981",
	"threat_severity": "Important",
	"public_date": "2025-01-06T21:11:51Z",
	"bugzilla": {
		"description": "redis: Redis' Lua library commands may lead to remote code execution",
		"id": "2336004",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2336004"
	},
	"cvss3": {
		"cvss3_base_score": "7.0",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-416",
	"details": [
		"Redis is an open source, in-memory database that persists on disk. An authenticated user may use a specially crafted Lua script to manipulate the garbage collector and potentially lead to remote code execution. The problem is fixed in 7.4.2, 7.2.7, and 6.2.17. An additional workaround to mitigate the problem without patching the redis-server executable is to prevent users from executing Lua scripts. This can be done using ACL to restrict EVAL and EVALSHA commands.",
		"A flaw was found in the Redis server. This flaw allows an authenticated user to use a specially crafted Lua script to manipulate the garbage collector, potentially leading to remote code execution."
	],
	"statement": "The problem exists in all versions of Redis with Lua scripting.\nThis vulnerability in Redis is classified as high severity rather than moderate due to its potential impact and exploitation scope. By manipulating the Lua garbage collector through crafted scripts, an authenticated attacker can achieve remote code execution (RCE), allowing them to execute arbitrary commands on the host system. This compromises not only the integrity and confidentiality of the data stored in Redis but also the underlying server itself. Furthermore, the exploitation does not require direct access to the server binary, making it feasible for attackers to execute through legitimate, albeit malicious, commands.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-46981\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-46981\nhttps://github.com/redis/redis/releases/tag/6.2.17\nhttps://github.com/redis/redis/releases/tag/7.2.7\nhttps://github.com/redis/redis/releases/tag/7.4.2\nhttps://github.com/redis/redis/security/advisories/GHSA-39h2-x6c4-6w4c"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "A workaround to mitigate the problem without patching the redis-server executable is to prevent users from executing Lua scripts. This can be done using ACL to restrict EVAL and EVALSHA commands."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2025:0400",
			"cpe": "cpe:/a:redhat:rhel_e4s:9.0",
			"package": "redis-0:6.2.6-1.el9_0.1",
			"product_name": "Red Hat Enterprise Linux 9.0 Update Services for SAP Solutions",
			"release_date": "2025-01-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2025:0398",
			"cpe": "cpe:/a:redhat:rhel_eus:9.2",
			"package": "redis-0:6.2.7-1.el9_2.1",
			"product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
			"release_date": "2025-01-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2025:0399",
			"cpe": "cpe:/a:redhat:rhel_eus:9.4",
			"package": "redis-0:6.2.7-1.el9_4.1",
			"product_name": "Red Hat Enterprise Linux 9.4 Extended Update Support",
			"release_date": "2025-01-20T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:openshift_lightspeed:0.2",
			"fix_state": "Affected",
			"package_name": "openshift-lightspeed-tech-preview/lightspeed-service-api-rhel9",
			"product_name": "OpenShift Lightspeed"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform",
			"fix_state": "Will not fix",
			"package_name": "ansible-tower",
			"product_name": "Red Hat Ansible Automation Platform 1.2"
		},
		{
			"cpe": "cpe:/a:redhat:discovery:1.0::el8",
			"fix_state": "Affected",
			"package_name": "discovery-server-container",
			"product_name": "Red Hat Discovery"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "redis:6/redis",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "redis",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "redis:7/redis",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:enterprise_linux_ai:1",
			"fix_state": "Affected",
			"package_name": "rhelai1/bootc-amd-rhel9",
			"product_name": "Red Hat Enterprise Linux AI (RHEL AI)"
		},
		{
			"cpe": "cpe:/a:redhat:enterprise_linux_ai:1",
			"fix_state": "Affected",
			"package_name": "rhelai1/bootc-azure-amd-rhel9",
			"product_name": "Red Hat Enterprise Linux AI (RHEL AI)"
		},
		{
			"cpe": "cpe:/a:redhat:enterprise_linux_ai:1",
			"fix_state": "Affected",
			"package_name": "rhelai1/instructlab-amd-rhel9",
			"product_name": "Red Hat Enterprise Linux AI (RHEL AI)"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"fix_state": "Not affected",
			"package_name": "io.hawt-hawtio-integration",
			"product_name": "Red Hat Fuse 7"
		},
		{
			"cpe": "cpe:/a:redhat:quay:3",
			"fix_state": "Affected",
			"package_name": "quay/quay-rhel8",
			"product_name": "Red Hat Quay 3"
		}
	],
	"csaw": false
}
