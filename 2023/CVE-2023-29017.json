{
	"name": "CVE-2023-29017",
	"threat_severity": "Critical",
	"public_date": "2023-04-06T00:00:00Z",
	"bugzilla": {
		"description": "vm2: sandbox escape",
		"id": "2185374",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2185374"
	},
	"cvss3": {
		"cvss3_base_score": "9.8",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-755",
	"details": [
		"vm2 is a sandbox that can run untrusted code with whitelisted Node's built-in modules. Prior to version 3.9.15, vm2 was not properly handling host objects passed to `Error.prepareStackTrace` in case of unhandled async errors. A threat actor could bypass the sandbox protections to gain remote code execution rights on the host running the sandbox. This vulnerability was patched in the release of version 3.9.15 of vm2. There are no known workarounds.",
		"A flaw was found in vm2 where the component was not properly handling asynchronous errors. This flaw allows a remote, unauthenticated attacker to escape the restrictions of the sandbox and execute code on the host."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2023-29017\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-29017\nhttps://github.com/patriksimek/vm2/issues/515\nhttps://github.com/patriksimek/vm2/security/advisories/GHSA-7jxr-cg7f-gpgv"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base, or stability."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2023:1893",
			"cpe": "cpe:/a:redhat:multicluster_engine:2.0::el8",
			"package": "multicluster-engine-console-mce-container",
			"product_name": "Multicluster Engine for Kubernetes",
			"release_date": "2023-04-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:1894",
			"cpe": "cpe:/a:redhat:multicluster_engine:2.1::el8",
			"package": "multicluster-engine-console-mce-container",
			"product_name": "Multicluster Engine for Kubernetes",
			"release_date": "2023-04-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:1887",
			"cpe": "cpe:/a:redhat:multicluster_engine:2.2::el8",
			"package": "multicluster-engine/console-mce-rhel8:v2.2.3-13",
			"product_name": "multicluster engine for Kubernetes 2.2 for RHEL 8",
			"release_date": "2023-04-19T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:1887",
			"cpe": "cpe:/a:redhat:multicluster_engine:2.2::el8",
			"package": "multicluster-engine/multicluster-engine-console-mce-rhel8:v2.2.3-13",
			"product_name": "multicluster engine for Kubernetes 2.2 for RHEL 8",
			"release_date": "2023-04-19T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:1896",
			"cpe": "cpe:/a:redhat:acm:2.5::el8",
			"package": "console-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2023-04-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:1897",
			"cpe": "cpe:/a:redhat:acm:2.6::el8",
			"package": "console-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2023-04-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:1888",
			"cpe": "cpe:/a:redhat:acm:2.7::el8",
			"package": "rhacm2/console-rhel8:v2.7.3-16",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.7 for RHEL 8",
			"release_date": "2023-04-20T00:00:00Z"
		}
	],
	"upstream_fix": "vm2 3.9.15",
	"csaw": false
}
