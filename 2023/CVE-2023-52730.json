{
	"name": "CVE-2023-52730",
	"threat_severity": "Low",
	"public_date": "2024-05-21T00:00:00Z",
	"bugzilla": {
		"description": "kernel: mmc: sdio: fix possible resource leaks in some error paths",
		"id": "2282640",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2282640"
	},
	"cvss3": {
		"cvss3_base_score": "4.4",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H",
		"status": "verified"
	},
	"cwe": "CWE-402",
	"details": [
		"In the Linux kernel, the following vulnerability has been resolved:\nmmc: sdio: fix possible resource leaks in some error paths\nIf sdio_add_func() or sdio_init_func() fails, sdio_remove_func() can\nnot release the resources, because the sdio function is not presented\nin these two cases, it won't call of_node_put() or put_device().\nTo fix these leaks, make sdio_func_present() only control whether\ndevice_del() needs to be called or not, then always call of_node_put()\nand put_device().\nIn error case in sdio_init_func(), the reference of 'card->dev' is\nnot get, to avoid redundant put in sdio_free_func_cis(), move the\nget_device() to sdio_alloc_func() and put_device() to sdio_release_func(),\nit can keep the get/put function be balanced.\nWithout this patch, while doing fault inject test, it can get the\nfollowing leak reports, after this fix, the leak is gone.\nunreferenced object 0xffff888112514000 (size 2048):\ncomm \"kworker/3:2\", pid 65, jiffies 4294741614 (age 124.774s)\nhex dump (first 32 bytes):\n00 e0 6f 12 81 88 ff ff 60 58 8d 06 81 88 ff ff  ..o.....`X......\n10 40 51 12 81 88 ff ff 10 40 51 12 81 88 ff ff  .@Q......@Q.....\nbacktrace:\n[<000000009e5931da>] kmalloc_trace+0x21/0x110\n[<000000002f839ccb>] mmc_alloc_card+0x38/0xb0 [mmc_core]\n[<0000000004adcbf6>] mmc_sdio_init_card+0xde/0x170 [mmc_core]\n[<000000007538fea0>] mmc_attach_sdio+0xcb/0x1b0 [mmc_core]\n[<00000000d4fdeba7>] mmc_rescan+0x54a/0x640 [mmc_core]\nunreferenced object 0xffff888112511000 (size 2048):\ncomm \"kworker/3:2\", pid 65, jiffies 4294741623 (age 124.766s)\nhex dump (first 32 bytes):\n00 40 51 12 81 88 ff ff e0 58 8d 06 81 88 ff ff  .@Q......X......\n10 10 51 12 81 88 ff ff 10 10 51 12 81 88 ff ff  ..Q.......Q.....\nbacktrace:\n[<000000009e5931da>] kmalloc_trace+0x21/0x110\n[<00000000fcbe706c>] sdio_alloc_func+0x35/0x100 [mmc_core]\n[<00000000c68f4b50>] mmc_attach_sdio.cold.18+0xb1/0x395 [mmc_core]\n[<00000000d4fdeba7>] mmc_rescan+0x54a/0x640 [mmc_core]"
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2023-52730\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-52730\nhttps://lore.kernel.org/linux-cve-announce/2024052158-CVE-2023-52730-1c8f@gregkh/T"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2024:5102",
			"cpe": "cpe:/a:redhat:enterprise_linux:8::nfv",
			"package": "kernel-rt-0:4.18.0-553.16.1.rt7.357.el8_10",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2024-08-08T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:5101",
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"package": "kernel-0:4.18.0-553.16.1.el8_10",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2024-08-08T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:9315",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"package": "kernel-0:5.14.0-503.11.1.el9_5",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2024-11-12T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:9315",
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"package": "kernel-0:5.14.0-503.11.1.el9_5",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2024-11-12T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "kernel 4.14.306, kernel 4.19.273, kernel 5.4.232, kernel 5.10.169, kernel 5.15.95, kernel 6.1.13, kernel 6.2",
	"csaw": false
}
