{
	"name": "CVE-2023-34454",
	"threat_severity": "Moderate",
	"public_date": "2023-06-15T00:00:00Z",
	"bugzilla": {
		"description": "snappy-java: Integer overflow in compress leads to DoS",
		"id": "2215394",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2215394"
	},
	"cvss3": {
		"cvss3_base_score": "5.9",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
		"status": "verified"
	},
	"cwe": "CWE-190",
	"details": [
		"snappy-java is a fast compressor/decompressor for Java. Due to unchecked multiplications, an integer overflow may occur in versions prior to 1.1.10.1, causing an unrecoverable fatal error.\nThe function `compress(char[] input)` in the file `Snappy.java` receives an array of characters and compresses it. It does so by multiplying the length by 2 and passing it to the rawCompress` function.\nSince the length is not tested, the multiplication by two can cause an integer overflow and become negative. The rawCompress function then uses the received length and passes it to the natively compiled maxCompressedLength function, using the returned value to allocate a byte array.\nSince the maxCompressedLength function treats the length as an unsigned integer, it doesn’t care that it is negative, and it returns a valid value, which is casted to a signed integer by the Java engine. If the result is negative, a `java.lang.NegativeArraySizeException` exception will be raised while trying to allocate the array `buf`. On the other side, if the result is positive, the `buf` array will successfully be allocated, but its size might be too small to use for the compression, causing a fatal Access Violation error.\nThe same issue exists also when using the `compress` functions that receive double, float, int, long and short, each using a different multiplier that may cause the same issue. The issue most likely won’t occur when using a byte array, since creating a byte array of size 0x80000000 (or any other negative value) is impossible in the first place.\nVersion 1.1.10.1 contains a patch for this issue.",
		"A flaw was found in Snappy-java's shuffle function, which does not check input sizes before beginning operations. This issue could allow an attacker to send malicious input to trigger an overflow error that crashes the program, resulting in a denial of service."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2023-34454\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-34454"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2023:5165",
			"cpe": "cpe:/a:redhat:amq_streams:2",
			"product_name": "Red Hat AMQ Streams 2.5.0",
			"release_date": "2023-09-14T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:7700",
			"cpe": "cpe:/a:redhat:quarkus:2.13::el8",
			"package": "org.xerial.snappy/snappy-java:1.1.10.5-redhat-00001",
			"product_name": "Red Hat build of Quarkus 2.13.9.Final",
			"release_date": "2023-12-07T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:logging:5",
			"fix_state": "Not affected",
			"package_name": "openshift-logging/elasticsearch6-rhel9",
			"product_name": "Logging Subsystem for Red Hat OpenShift"
		},
		{
			"cpe": "cpe:/a:redhat:serverless:1",
			"fix_state": "Affected",
			"package_name": "snappy-java",
			"product_name": "OpenShift Serverless"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Will not fix",
			"package_name": "log4j:2/log4j",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Will not fix",
			"package_name": "log4j",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:6",
			"fix_state": "Will not fix",
			"package_name": "snappy-java-all",
			"product_name": "Red Hat JBoss Fuse 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:6",
			"fix_state": "Will not fix",
			"package_name": "snappy-java-all-repolib",
			"product_name": "Red Hat JBoss Fuse 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse_service_works:6",
			"fix_state": "Out of support scope",
			"package_name": "snappy-java-all",
			"product_name": "Red Hat JBoss Fuse Service Works 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse_service_works:6",
			"fix_state": "Out of support scope",
			"package_name": "snappy-java-all-repolib",
			"product_name": "Red Hat JBoss Fuse Service Works 6"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Out of support scope",
			"package_name": "openshift3/metrics-cassandra",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Out of support scope",
			"package_name": "openshift3/ose-metrics-cassandra",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Not affected",
			"package_name": "snappy-java",
			"product_name": "Red Hat Satellite 6"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Not affected",
			"package_name": "snappy-java-debuginfo",
			"product_name": "Red Hat Satellite 6"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:3",
			"fix_state": "Will not fix",
			"package_name": "snappy-java",
			"product_name": "Red Hat Software Collections"
		},
		{
			"cpe": "cpe:/a:redhat:amq_streams:1",
			"fix_state": "Affected",
			"package_name": "snappy-java",
			"product_name": "streams for Apache Kafka"
		},
		{
			"cpe": "cpe:/a:redhat:amq_streams:1",
			"fix_state": "Affected",
			"package_name": "snappy-java-debuginfo",
			"product_name": "streams for Apache Kafka"
		},
		{
			"cpe": "cpe:/a:redhat:amq_streams:1",
			"fix_state": "Affected",
			"package_name": "snappy-java-repolib",
			"product_name": "streams for Apache Kafka"
		}
	],
	"upstream_fix": "snappy-java 1.1.10.1",
	"csaw": false
}
