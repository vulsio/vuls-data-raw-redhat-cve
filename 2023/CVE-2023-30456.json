{
	"name": "CVE-2023-30456",
	"threat_severity": "Moderate",
	"public_date": "2023-04-10T00:00:00Z",
	"bugzilla": {
		"description": "kernel: KVM: nVMX: missing consistency checks for CR0 and CR4",
		"id": "2188468",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2188468"
	},
	"cvss3": {
		"cvss3_base_score": "6.0",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:N/I:N/A:H",
		"status": "verified"
	},
	"cwe": "CWE-358",
	"details": [
		"An issue was discovered in arch/x86/kvm/vmx/nested.c in the Linux kernel before 6.2.8. nVMX on x86_64 lacks consistency checks for CR0 and CR4.",
		"A flaw was found in the KVM's Intel nested virtualization feature (nVMX). The effective values of the guest CR0 and CR4 registers could differ from those included in the VMCS12. In rare circumstances (i.e., kvm_intel module loaded with parameters nested=1 and ept=0) this could allow a malicious guest to crash the host system, causing a denial of service."
	],
	"statement": "Red Hat currently provides the nested virtualization feature as a Technology Preview. Nested virtualization is therefore unsupported for production use. For more information please refer to https://access.redhat.com/solutions/21101 and https://access.redhat.com/support/offerings/techpreview.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2023-30456\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-30456"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "This vulnerability can be mitigated by disabling the nested virtualization feature:\n```\n# modprobe -r kvm_intel\n# modprobe kvm_intel nested=0\n```"
	},
	"affected_release": [
		{
			"advisory": "RHSA-2023:6901",
			"cpe": "cpe:/a:redhat:enterprise_linux:8::nfv",
			"package": "kernel-rt-0:4.18.0-513.5.1.rt7.307.el8_9",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2023-11-14T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:7077",
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"package": "kernel-0:4.18.0-513.5.1.el8_9",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2023-11-14T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:0930",
			"cpe": "cpe:/o:redhat:rhel_eus:8.6",
			"package": "kernel-0:4.18.0-372.93.1.el8_6",
			"product_name": "Red Hat Enterprise Linux 8.6 Extended Update Support",
			"release_date": "2024-02-21T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:1404",
			"cpe": "cpe:/o:redhat:rhel_eus:8.8",
			"package": "kernel-0:4.18.0-477.51.1.el8_8",
			"product_name": "Red Hat Enterprise Linux 8.8 Extended Update Support",
			"release_date": "2024-03-19T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:6583",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"package": "kernel-0:5.14.0-362.8.1.el9_3",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2023-11-07T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:6583",
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"package": "kernel-0:5.14.0-362.8.1.el9_3",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2023-11-07T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:0930",
			"cpe": "cpe:/o:redhat:rhev_hypervisor:4.4::el8",
			"package": "kernel-0:4.18.0-372.93.1.el8_6",
			"product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 8",
			"release_date": "2024-02-21T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "kernel 6.3-rc3",
	"csaw": false
}
