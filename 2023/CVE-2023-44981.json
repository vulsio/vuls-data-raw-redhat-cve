{
	"name": "CVE-2023-44981",
	"threat_severity": "Critical",
	"public_date": "2023-10-11T00:00:00Z",
	"bugzilla": {
		"description": "zookeeper: Authorization Bypass in Apache ZooKeeper",
		"id": "2243436",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2243436"
	},
	"cvss3": {
		"cvss3_base_score": "9.1",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
		"status": "verified"
	},
	"cwe": "CWE-639",
	"details": [
		"Authorization Bypass Through User-Controlled Key vulnerability in Apache ZooKeeper. If SASL Quorum Peer authentication is enabled in ZooKeeper (quorum.auth.enableSasl=true), the authorization is done by verifying that the instance part in SASL authentication ID is listed in zoo.cfg server list. The instance part in SASL auth ID is optional and if it's missing, like 'eve@EXAMPLE.COM', the authorization check will be skipped. As a result an arbitrary endpoint could join the cluster and begin propagating counterfeit changes to the leader, essentially giving it complete read-write access to the data tree. Quorum Peer authentication is not enabled by default. Users are recommended to upgrade to version 3.9.1, 3.8.3, 3.7.2, which fixes the issue. Alternately ensure the ensemble election/quorum communication is protected by a firewall as this will mitigate the issue. See the documentation for more details on correct cluster administration.",
		"A flaw was found in Apache ZooKeeper. Authorization bypass through user-controlled key is available iff SASL Quorum Peer authentication is enabled in ZooKeeper via quorum.auth.enableSasl=true configuration. A malicious user could bypass the authentication controller by using a non-existing instance part in SASL authentication ID (which is optional), therefore, the server would skip this check and as a result, join the cluster and propagate information with complete read and write access."
	],
	"statement": "Red Hat Business Process Manager and Red Hat AMQ Streams are rated as a Important impact since ZooKeeper authentication is not enabled by default.\nRed Hat AMQ 7 ships Zookeeper but uses only the Zookeeper client hence the Moderate Impact",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2023-44981\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-44981\nhttps://lists.apache.org/thread/wf0yrk84dg1942z1o74kd8nycg6pgm5b"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "According to Apache's document: Ensure the ensemble election/quorum communication is protected by a firewall as this will mitigate the issue."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2024:0903",
			"cpe": "cpe:/a:redhat:amq_broker:7.10",
			"impact": "moderate",
			"package": "zookeeper",
			"product_name": "AMQ Broker 7.10.6",
			"release_date": "2024-02-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:0705",
			"cpe": "cpe:/a:redhat:amq_broker:7.11",
			"impact": "moderate",
			"package": "zookeeper",
			"product_name": "Red Hat AMQ Broker 7.11.6",
			"release_date": "2024-02-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:7678",
			"cpe": "cpe:/a:redhat:amq_streams:2",
			"impact": "important",
			"package": "zookeeper",
			"product_name": "Red Hat AMQ Streams 2.6.0",
			"release_date": "2023-12-06T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:6",
			"fix_state": "Out of support scope",
			"package_name": "zookeeper",
			"product_name": "Red Hat BPM Suite 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7",
			"fix_state": "Affected",
			"impact": "important",
			"package_name": "zookeeper",
			"product_name": "Red Hat Decision Manager 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_amq:6",
			"fix_state": "Out of support scope",
			"package_name": "zookeeper",
			"product_name": "Red Hat JBoss A-MQ 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:6",
			"fix_state": "Out of support scope",
			"package_name": "zookeeper",
			"product_name": "Red Hat JBoss BRMS 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_virtualization:6",
			"fix_state": "Out of support scope",
			"package_name": "zookeeper",
			"product_name": "Red Hat JBoss Data Virtualization 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:6",
			"fix_state": "Out of support scope",
			"package_name": "zookeeper",
			"product_name": "Red Hat JBoss Fuse 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"fix_state": "Not affected",
			"package_name": "zookeeper",
			"product_name": "Red Hat JBoss Fuse 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse_service_works:6",
			"fix_state": "Out of support scope",
			"package_name": "zookeeper",
			"product_name": "Red Hat JBoss Fuse Service Works 6"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_application_runtimes:1.0",
			"fix_state": "Out of support scope",
			"package_name": "zookeeper",
			"product_name": "Red Hat OpenShift Application Runtimes"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7",
			"fix_state": "Not affected",
			"package_name": "zookeeper",
			"product_name": "Red Hat Process Automation 7"
		}
	],
	"upstream_fix": "zookeeper 3.9.1, zookeeper 3.8.3, zookeeper 3.7.2",
	"csaw": false
}
