{
	"name": "CVE-2023-6563",
	"threat_severity": "Important",
	"public_date": "2023-12-14T00:00:00Z",
	"bugzilla": {
		"description": "keycloak: offline session token DoS",
		"id": "2253308",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2253308"
	},
	"cvss3": {
		"cvss3_base_score": "7.7",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H",
		"status": "draft"
	},
	"cwe": "CWE-770",
	"details": [
		"An unconstrained memory consumption vulnerability was discovered in Keycloak. It can be triggered in environments which have millions of offline tokens (> 500,000 users with each having at least 2 saved sessions). If an attacker creates two or more user sessions and then open the \"consents\" tab of the admin User Interface, the UI attempts to load a huge number of offline client sessions leading to excessive memory and CPU consumption which could potentially crash the entire system."
	],
	"statement": "While this vulnerability can enable complete compromise of system availability, it is not possible to be triggered in every environment. The impact is rated as Important due to several preconditions (number of users and how many sessions each user has) which are beyond an attacker's control.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2023-6563\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-6563\nhttps://github.com/keycloak/keycloak/issues/13340"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "There are three main options to prevent exploitation:\n1) If you are using a reverse proxy, block the consents URL.\n2) This option is less effective: remove the consents application tab from the account console theme.\n3) This option has a significant negative impact on end users: entirely disable offline user profiles."
	},
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:keycloak:22",
			"fix_state": "Under investigation",
			"package_name": "keycloak-core",
			"product_name": "Red Hat Build of Keycloak"
		},
		{
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7",
			"fix_state": "Affected",
			"package_name": "keycloak-core",
			"product_name": "Red Hat Single Sign-On 7"
		}
	],
	"upstream_fix": "keycloak 21.0.0",
	"csaw": false
}
