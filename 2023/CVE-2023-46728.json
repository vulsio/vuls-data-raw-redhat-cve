{
	"name": "CVE-2023-46728",
	"threat_severity": "Important",
	"public_date": "2023-09-26T00:00:00Z",
	"bugzilla": {
		"description": "squid: NULL pointer dereference in the gopher protocol code",
		"id": "2248521",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2248521"
	},
	"cvss3": {
		"cvss3_base_score": "7.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
		"status": "draft"
	},
	"cwe": "CWE-476",
	"details": [
		"Squid is a caching proxy for the Web supporting HTTP, HTTPS, FTP, and more. Due to a NULL pointer dereference bug Squid is vulnerable to a Denial of Service attack against Squid's Gopher gateway. The gopher protocol is always available and enabled in Squid prior to Squid 6.0.1. Responses triggering this bug are possible to be received from any gopher server, even those without malicious intent. Gopher support has been removed in Squid version 6.0.1. Users are advised to upgrade. Users unable to upgrade should reject all gopher URL requests.",
		"Squid is a caching proxy for the Web supporting HTTP, HTTPS, FTP, and more. Due to a NULL pointer dereference bug Squid is vulnerable to a Denial of Service attack against Squid's Gopher gateway. The gopher protocol is always available and enabled in Squid. This issue may lead to a remote denial of service via gopher URL requests."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2023-46728\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-46728\nhttps://github.com/squid-cache/squid/security/advisories/GHSA-cg5h-v6vc-w33f\nhttps://megamansec.github.io/Squid-Security-Audit/gopher-nullpointer.html"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "To mitigate this issue, create an access list configuration to reject all gopher URL requests:\nSet ACL directives in your squid.conf file (or equivalent) as follows:\nacl gopher proto gopher\nhttp_access deny gopher\nImportant: This sequence must be placed above any lines starting with \"http_access allow\" in your configuration.\nObservation: Some loss of performance may occur with this configuration."
	},
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "squid",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "squid34",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Affected",
			"package_name": "squid",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "squid:4/squid",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "squid",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "squid 6.0.1",
	"csaw": false
}
