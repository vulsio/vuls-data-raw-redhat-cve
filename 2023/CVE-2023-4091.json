{
	"name": "CVE-2023-4091",
	"threat_severity": "Moderate",
	"public_date": "2023-10-10T00:00:00Z",
	"bugzilla": {
		"description": "samba: SMB clients can truncate files with read-only permissions",
		"id": "2241882",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2241882"
	},
	"cvss3": {
		"cvss3_base_score": "6.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
		"status": "verified"
	},
	"cwe": "CWE-276",
	"details": [
		"A vulnerability was discovered in Samba, where the flaw allows SMB clients to truncate files, even with read-only permissions when the Samba VFS module \"acl_xattr\" is configured with \"acl_xattr:ignore system acls = yes\". The SMB protocol allows opening files when the client requests read-only access but then implicitly truncates the opened file to 0 bytes if the client specifies a separate OVERWRITE create disposition request. The issue arises in configurations that bypass kernel file system permissions checks, relying solely on Samba's permissions.",
		"A vulnerability was discovered in Samba, where the flaw allows SMB clients to truncate files, even with read-only permissions when the Samba VFS module \"acl_xattr\" is configured with \"acl_xattr:ignore system acls = yes\". The SMB protocol allows opening files when the client requests read-only access but then implicitly truncates the opened file to 0 bytes if the client specifies a separate OVERWRITE create disposition request. The issue arises in configurations that bypass kernel file system permissions checks, relying solely on Samba's permissions."
	],
	"statement": "The vulnerability primarily affects Samba configurations using the \"acl_xattr\" module with the \"acl_xattr:ignore system acls = yes\" setting.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2023-4091\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-4091\nhttps://bugzilla.samba.org/show_bug.cgi?id=15439\nhttps://www.samba.org/samba/security/CVE-2023-4091.html"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "The vulnerability is most commonly associated with the \"acl_xattr\" module and can be mitigated by setting:\n~~~\n\"acl_xattr:ignore system acls = no\"\n~~~"
	},
	"affected_release": [
		{
			"advisory": "RHSA-2023:7467",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "samba-0:4.18.6-2.el8_9",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2023-11-22T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:7467",
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"package": "samba-0:4.18.6-2.el8_9",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2023-11-22T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:7408",
			"cpe": "cpe:/a:redhat:rhel_eus:8.6",
			"package": "samba-0:4.15.5-13.el8_6",
			"product_name": "Red Hat Enterprise Linux 8.6 Extended Update Support",
			"release_date": "2023-11-21T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:7464",
			"cpe": "cpe:/a:redhat:rhel_eus:8.8",
			"package": "samba-0:4.17.5-4.el8_8",
			"product_name": "Red Hat Enterprise Linux 8.8 Extended Update Support",
			"release_date": "2023-11-22T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:6744",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"package": "samba-0:4.18.6-101.el9_3",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2023-11-07T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:6744",
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"package": "samba-0:4.18.6-101.el9_3",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2023-11-07T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:6209",
			"cpe": "cpe:/a:redhat:rhel_eus:9.0",
			"package": "samba-0:4.15.5-111.el9_0",
			"product_name": "Red Hat Enterprise Linux 9.0 Extended Update Support",
			"release_date": "2023-10-31T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:7371",
			"cpe": "cpe:/a:redhat:rhel_eus:9.2",
			"package": "samba-0:4.17.5-104.el9_2",
			"product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
			"release_date": "2023-11-21T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:7408",
			"cpe": "cpe:/o:redhat:enterprise_linux:8::hypervisor",
			"package": "samba-0:4.15.5-13.el8_6",
			"product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 8",
			"release_date": "2023-11-21T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "samba",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "samba4",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "samba",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Affected",
			"package_name": "samba",
			"product_name": "Red Hat Storage 3"
		}
	],
	"upstream_fix": "samba 4.19.1, samba 4.18.8, samba 4.17.12",
	"csaw": false
}
