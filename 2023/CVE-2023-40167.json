{
	"name": "CVE-2023-40167",
	"threat_severity": "Moderate",
	"public_date": "2023-09-19T00:00:00Z",
	"bugzilla": {
		"description": "jetty: Improper validation of HTTP/1 content-length",
		"id": "2239634",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2239634"
	},
	"cvss3": {
		"cvss3_base_score": "5.3",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
		"status": "verified"
	},
	"cwe": "CWE-130",
	"details": [
		"Jetty is a Java based web server and servlet engine. Prior to versions 9.4.52, 10.0.16, 11.0.16, and 12.0.1, Jetty accepts the `+` character proceeding the content-length value in a HTTP/1 header field. This is more permissive than allowed by the RFC and other servers routinely reject such requests with 400 responses. There is no known exploit scenario, but it is conceivable that request smuggling could result if jetty is used in combination with a server that does not close the connection after sending such a 400 response. Versions 9.4.52, 10.0.16, 11.0.16, and 12.0.1 contain a patch for this issue. There is no workaround as there is no known exploit scenario.",
		"A flaw was found in Jetty that permits a plus sign (+) preceding the content-length value in a HTTP/1 header field, which is non-standard and more permissive than RFC. This issue could allow an attacker to request smuggling in conjunction with a server that does not close connections after 400 responses."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2023-40167\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-40167\nhttps://github.com/eclipse/jetty.project/security/advisories/GHSA-hmr7-m48g-48f6\nhttps://www.rfc-editor.org/rfc/rfc9110#section-8.6"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2023:7697",
			"cpe": "cpe:/a:redhat:amq_clients:2023_q4",
			"package": "jetty-http",
			"product_name": "AMQ Clients",
			"release_date": "2023-12-07T00:00:00Z"
		},
		{
			"advisory": "RHSA-2024:0778",
			"cpe": "cpe:/a:redhat:ocp_tools:4.12::el8",
			"package": "jenkins-0:2.426.3.1706515686-3.el8",
			"product_name": "OpenShift Developer Tools and Services for OCP 4.12",
			"release_date": "2024-02-12T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:5946",
			"cpe": "cpe:/a:redhat:amq_broker:7",
			"package": "jetty-http",
			"product_name": "Red Hat AMQ Broker 7",
			"release_date": "2023-10-19T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:7678",
			"cpe": "cpe:/a:redhat:amq_streams:2",
			"package": "jetty-http",
			"product_name": "Red Hat AMQ Streams 2.6.0",
			"release_date": "2023-12-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:7247",
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"package": "jetty",
			"product_name": "Red Hat Fuse 7.12.1",
			"release_date": "2023-11-15T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:7247",
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"package": "jetty-http",
			"product_name": "Red Hat Fuse 7.12.1",
			"release_date": "2023-11-15T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:5780",
			"cpe": "cpe:/a:redhat:camel_quarkus:2.13",
			"package": "jetty-http",
			"product_name": "Red Hat Integration Camel Quarkus",
			"release_date": "2023-10-17T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:5441",
			"cpe": "cpe:/a:redhat:camel_spring_boot:4.0.0",
			"package": "jetty-http",
			"product_name": "RHINT Camel-Springboot 4.0.0",
			"release_date": "2023-10-04T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:a_mq_clients:2",
			"fix_state": "Affected",
			"package_name": "jetty-http",
			"product_name": "A-MQ Clients 2"
		},
		{
			"cpe": "cpe:/a:redhat:migration_toolkit_applications:6",
			"fix_state": "Not affected",
			"package_name": "commons-io-commons-io",
			"product_name": "Migration Toolkit for Applications 6"
		},
		{
			"cpe": "cpe:/a:redhat:migration_toolkit_runtimes:1",
			"fix_state": "Not affected",
			"package_name": "commons-io-commons-io",
			"product_name": "Migration Toolkit for Runtimes"
		},
		{
			"cpe": "cpe:/a:redhat:serverless:1",
			"fix_state": "Will not fix",
			"package_name": "org.kie.kogito-kogito-apps",
			"product_name": "OpenShift Serverless"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "jetty",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Will not fix",
			"package_name": "jetty",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "jetty",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:camel_spring_boot:3",
			"fix_state": "Affected",
			"package_name": "jetty-http",
			"product_name": "Red Hat Integration Camel for Spring Boot"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_amq:6",
			"fix_state": "Out of support scope",
			"package_name": "jetty-http",
			"product_name": "Red Hat JBoss A-MQ 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:7",
			"fix_state": "Out of support scope",
			"package_name": "jetty-http",
			"product_name": "Red Hat JBoss Data Grid 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:6",
			"fix_state": "Out of support scope",
			"package_name": "jetty",
			"product_name": "Red Hat JBoss Fuse 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:6",
			"fix_state": "Out of support scope",
			"package_name": "jetty-http",
			"product_name": "Red Hat JBoss Fuse 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse_service_works:6",
			"fix_state": "Out of support scope",
			"package_name": "jetty-http",
			"product_name": "Red Hat JBoss Fuse Service Works 6"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Affected",
			"package_name": "openshift4/ose-metering-hadoop",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Affected",
			"package_name": "openshift4/ose-metering-hive",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Affected",
			"package_name": "openshift4/ose-metering-presto",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_devspaces:3::el8",
			"fix_state": "Not affected",
			"package_name": "jetty-http",
			"product_name": "Red Hat OpenShift Dev Spaces"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7",
			"fix_state": "Out of support scope",
			"package_name": "jetty-http",
			"product_name": "Red Hat Process Automation 7"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Affected",
			"package_name": "jetty",
			"product_name": "Red Hat Satellite 6"
		},
		{
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7",
			"fix_state": "Affected",
			"package_name": "jetty-http",
			"product_name": "Red Hat Single Sign-On 7"
		}
	],
	"upstream_fix": "jetty 9.4.52, jetty 10.0.16, jetty 11.0.6, jetty 12.0.1",
	"csaw": false
}
