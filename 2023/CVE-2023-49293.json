{
	"name": "CVE-2023-49293",
	"threat_severity": "Moderate",
	"public_date": "2023-12-05T00:00:00Z",
	"bugzilla": {
		"description": "vitejs: XSS vulnerability in `server.transformIndexHtml` via URL payload",
		"id": "2252893",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2252893"
	},
	"cvss3": {
		"cvss3_base_score": "6.1",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
		"status": "draft"
	},
	"cwe": "CWE-79",
	"details": [
		"Vite is a website frontend framework. When Vite's HTML transformation is invoked manually via `server.transformIndexHtml`, the original request URL is passed in unmodified, and the `html` being transformed contains inline module scripts (`<script type=\"module\">...</script>`), it is possible to inject arbitrary HTML into the transformed output by supplying a malicious URL query string to `server.transformIndexHtml`. Only apps using `appType: 'custom'` and using the default Vite HTML middleware are affected. The HTML entry must also contain an inline script. The attack requires a user to click on a malicious URL while running the dev server. Restricted files aren't exposed to the attacker. This issue has been addressed in vite@5.0.5, vite@4.5.1, and vite@4.4.12. There are no known workarounds for this vulnerability.",
		"A cross-site scripting (XSS) vulnerability was found in vitejs that can be triggered by sending a malicious payload through server.transformIndexHtml."
	],
	"statement": "The vulnerability within Vite's HTML transformation process poses a moderate severity issue due to its potential for exploitation in specific development environments. While it requires certain conditions to be met, such as utilizing the appType: 'custom' configuration and containing inline module scripts in the HTML, the impact can still be significant. Attackers can inject arbitrary HTML into the transformed output by manipulating the request URL, leading to Cross-Site Scripting (XSS) attacks. Although exploitation relies on users clicking on malicious URLs during development server runtime, the ability to inject arbitrary code into the transformed output could facilitate further attacks or unauthorized access to sensitive data.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2023-49293\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-49293\nhttps://github.com/vitejs/vite/security/advisories/GHSA-92r3-m2mg-pj97"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
	},
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Not affected",
			"package_name": "automation-controller",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Not affected",
			"package_name": "automation-eda-controller",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:build_keycloak:22",
			"fix_state": "Will not fix",
			"package_name": "vitejs",
			"product_name": "Red Hat Build of Keycloak"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:8",
			"fix_state": "Affected",
			"package_name": "vitejs",
			"product_name": "Red Hat JBoss Enterprise Application Platform 8"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:2",
			"fix_state": "Affected",
			"package_name": "rhosdt/jaeger-agent-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 2"
		}
	],
	"upstream_fix": "vite 4.4.12, vite 4.5.0, vite 4.5.1, vite 5.0.0, vite 5.0.5",
	"csaw": false
}
