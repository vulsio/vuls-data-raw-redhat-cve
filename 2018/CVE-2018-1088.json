{
	"name": "CVE-2018-1088",
	"threat_severity": "Important",
	"public_date": "2018-04-18T00:00:00Z",
	"bugzilla": {
		"description": "glusterfs: Privilege escalation via gluster_shared_storage when snapshot scheduling is enabled",
		"id": "1558721",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1558721"
	},
	"cvss3": {
		"cvss3_base_score": "8.3",
		"cvss3_scoring_vector": "CVSS:3.0/AV:A/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-266",
	"details": [
		"A privilege escalation flaw was found in gluster 3.x snapshot scheduler. Any gluster client allowed to mount gluster volumes could also mount shared gluster storage volume and escalate privileges by scheduling malicious cronjob via symlink.",
		"A privilege escalation flaw was found in gluster snapshot scheduler. Any gluster client allowed to mount gluster volumes could also mount shared gluster storage volume and escalate privileges by scheduling malicious cronjob via symlink."
	],
	"statement": "This vulnerability affects gluster servers that have, or have previously had, Gluster volume snapshot scheduling enabled from the CLI. Red Hat Enterprise Virtualization supports volume snapshot scheduling from the Web UI, which uses a distinct mechanism that is not subject to this vulnerability. VM snapshots are not impacted by this flaw. For more information, please see the Vulnerability Article linked under External References.\nThis issue did not affect the versions of glusterfs as shipped with Red Hat Enterprise Linux 6, and 7 because only gluster client is shipped in these products. CVE-2018-1088 affects glusterfs-server package as shipped with Red Hat Gluster Storage 3.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2018-1088\nhttps://nvd.nist.gov/vuln/detail/CVE-2018-1088\nhttps://access.redhat.com/articles/3414511"
	],
	"acknowledgement": "This issue was discovered by John Strunk (Red Hat).",
	"mitigation": {
		"lang": "en:us",
		"value": "To limit exposure of gluster server nodes :  \n1. gluster server should be on LAN and not reachable from public networks.  \n2. Use gluster auth.allow and auth.reject.  \n3. Use TLS certificates between gluster server nodes and clients.  \nCaveat: This would only mitigate attacks from unauthorized malicious clients. gluster clients allowed by auth.allow or having signed TLS client certificates would still be able to trigger this attack."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2018:1137",
			"cpe": "cpe:/a:redhat:storage:3:client:el6",
			"package": "glusterfs-0:3.8.4-54.7.el6",
			"product_name": "Native Client for RHEL 6 for Red Hat Storage",
			"release_date": "2018-04-18T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:1136",
			"cpe": "cpe:/a:redhat:storage:3:client:el7",
			"package": "glusterfs-0:3.8.4-54.6.el7",
			"product_name": "Native Client for RHEL 7 for Red Hat Storage",
			"release_date": "2018-04-18T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:1137",
			"cpe": "cpe:/a:redhat:storage:3.3:server:el6",
			"package": "glusterfs-0:3.8.4-54.7.el6rhs",
			"product_name": "Red Hat Gluster Storage 3.3 for RHEL 6",
			"release_date": "2018-04-18T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:1136",
			"cpe": "cpe:/a:redhat:storage:3.3:server:el7",
			"package": "glusterfs-0:3.8.4-54.6.el7rhgs",
			"product_name": "Red Hat Gluster Storage 3.3 for RHEL 7",
			"release_date": "2018-04-18T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:1136",
			"cpe": "cpe:/o:redhat:enterprise_linux:7::hypervisor",
			"impact": "low",
			"package": "glusterfs-0:3.8.4-54.6.el7",
			"product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 7",
			"release_date": "2018-04-18T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:1275",
			"cpe": "cpe:/o:redhat:enterprise_linux:7::hypervisor",
			"impact": "low",
			"package": "redhat-release-virtualization-host-0:4.1-11.0.el7",
			"product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 7",
			"release_date": "2018-05-02T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:1275",
			"cpe": "cpe:/o:redhat:enterprise_linux:7::hypervisor",
			"impact": "low",
			"package": "redhat-virtualization-host-0:4.1-20180426.0",
			"product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 7",
			"release_date": "2018-05-02T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:1524",
			"cpe": "cpe:/o:redhat:enterprise_linux:7::hypervisor",
			"impact": "low",
			"package": "imgbased-0:1.0.16-0.1.el7ev",
			"product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 7",
			"release_date": "2018-05-15T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:1524",
			"cpe": "cpe:/o:redhat:enterprise_linux:7::hypervisor",
			"impact": "low",
			"package": "ovirt-node-ng-0:4.2.0-0.20170814.0.el7",
			"product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 7",
			"release_date": "2018-05-15T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:1524",
			"cpe": "cpe:/o:redhat:enterprise_linux:7::hypervisor",
			"impact": "low",
			"package": "redhat-release-virtualization-host-0:4.2-3.0.el7",
			"product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 7",
			"release_date": "2018-05-15T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:1524",
			"cpe": "cpe:/o:redhat:enterprise_linux:7::hypervisor",
			"impact": "low",
			"package": "redhat-virtualization-host-0:4.2-20180508.0",
			"product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 7",
			"release_date": "2018-05-15T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "glusterfs",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "glusterfs",
			"product_name": "Red Hat Enterprise Linux 7"
		}
	],
	"csaw": false
}
