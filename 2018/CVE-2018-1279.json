{
	"name": "CVE-2018-1279",
	"threat_severity": "Important",
	"public_date": "2018-12-20T00:00:00Z",
	"bugzilla": {
		"description": "CVE-2018-1279 rabbitmq-server: Deterministically generated cookie shared between all machines",
		"id": "1661092",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1661092"
	},
	"cvss3": {
		"cvss3_base_score": "6.5",
		"cvss3_scoring_vector": "CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
		"status": "draft"
	},
	"cwe": "CWE-330->CWE-290",
	"details": [
		"Pivotal RabbitMQ for PCF, all versions, uses a deterministically generated cookie that is shared between all machines when configured in a multi-tenant cluster. A remote attacker who can gain information about the network topology can guess this cookie and, if they have access to the right ports on any server in the MQ cluster can use this cookie to gain full control over the entire cluster.",
		"RabbitMQ, versions up to and including 3.7.9, use an insecure method for generating authentication cookies when configuring clustered operations. It is possible to determine the cookie given adequate network topology information. Using the default cookie generated by RabbitMQ when forming a RabbitMQ cluster may lead to privileged access if the cookie is determined."
	],
	"statement": "OpenShift Online:\nRabbitMQ is only used by the Ansible Tower, which is not a standard part of the OpenShift product, however is deployed as a management tool.\nThis is set as deferred as it has no impact to customers and is not deployed in a clustered configuration. A cluster using an Erlang-generated cookie would be required for cookie guessing to provide and environmental leverage.\nOpenStack:\nFor RHOSP10+, the rabbit cookie is set to a random string during deployment, rather than relying on Erlang to generate the cookie, if the cookie has not been overridden in the deployment configuration. In either case, this avoids the predictable Erlang cookie generation highlighted by this flaw, meaning RHOSP10+ is not vulnerable. Further mitigating the flaw, is the fact that RabbitMQ, in an OpenStack context, is deployed to the admin network and as such should only be accessible to OpenStack services, not public users via an external network.\nFor RHOSP8+9, when deployed with Director (TripleO), the RabbitMQ salt is initialized via the Heat RandomString function, also bypassing this vulnerability. RHOSP8+9 however did not use Director as the default deployment mechanism. When installing RHOSP manually in these versions, our installation documentation does not provide guidance for configuring clustered RabbitMQ. It is safe to assume that some customers may have this configured in an insecure way, despite the fact that we would not have told them how to install and configure a cluster in a vulnerable way.\nAnsible Tower:\nIn Tower we do not use the programmatic cookie generation that gives rise to this vulnerability. Instead we use cookiemonster. So this issue does not affect Ansible Tower.\nCloudForms (CFME):\nRabbitMQ shipped with CloudForms is exclusively used by Ansible Tower. Since Ansible Tower is not vulnerable, due to the reasons described above, then CloudForms isn't, as well.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2018-1279\nhttps://nvd.nist.gov/vuln/detail/CVE-2018-1279\nhttps://pivotal.io/security/cve-2018-1279"
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:cloudforms_managementengine:5",
			"fix_state": "Not affected",
			"package_name": "rabbitmq-server",
			"product_name": "CloudForms Management Engine 5"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_tower:3",
			"fix_state": "Not affected",
			"package_name": "rabbitmq-server",
			"product_name": "Red Hat Ansible Tower 3"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:10",
			"fix_state": "Out of support scope",
			"package_name": "rabbitmq-server",
			"product_name": "Red Hat OpenStack Platform 10 (Newton)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:13",
			"fix_state": "Will not fix",
			"package_name": "rabbitmq-server",
			"product_name": "Red Hat OpenStack Platform 13 (Queens)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:14",
			"fix_state": "Out of support scope",
			"package_name": "rabbitmq-server",
			"product_name": "Red Hat OpenStack Platform 14 (Rocky)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:8",
			"fix_state": "Out of support scope",
			"package_name": "rabbitmq-server",
			"product_name": "Red Hat OpenStack Platform 8 (Liberty)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:9",
			"fix_state": "Out of support scope",
			"package_name": "rabbitmq-server",
			"product_name": "Red Hat OpenStack Platform 9 (Mitaka)"
		}
	],
	"csaw": false
}
