{
	"name": "CVE-2018-19044",
	"threat_severity": "Moderate",
	"public_date": "2018-11-08T00:00:00Z",
	"bugzilla": {
		"description": "CVE-2018-19044 keepalived: Improper pathname validation allows for overwrite of arbitrary filenames via symlinks",
		"id": "1651863",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1651863"
	},
	"cvss3": {
		"cvss3_base_score": "7.0",
		"cvss3_scoring_vector": "CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-59",
	"details": [
		"keepalived 2.0.8 didn't check for pathnames with symlinks when writing data to a temporary file upon a call to PrintData or PrintStats. This allowed local users to overwrite arbitrary files if fs.protected_symlinks is set to 0, as demonstrated by a symlink from /tmp/keepalived.data or /tmp/keepalived.stats to /etc/passwd."
	],
	"statement": "This issue affects the versions of keepalived as shipped with Red Hat Enterprise Linux 6 and 7.\nRed Hat Enterprise Linux 6 is now in Maintenance Support 2 Phase of the support and maintenance life cycle. This has been rated as having a security impact of Moderate, and is not currently planned to be addressed in future updates. For additional information, refer to the Red Hat Enterprise Linux Life Cycle: https://access.redhat.com/support/policy/updates/errata/.\nThe keepalived packages shipped with Red Hat Enterprise Linux 6 and 7 are not built with dbus support, therefore vulnerable PrintData and PrintStats methods are not compiled in resulting RPM, which means this issue cannot be exploited via dbus messages on Red Hat Enterprise Linux 6 and 7. However, creation of pidfiles is also vulnerable to symlink attack and it is possible for local attacker to overwrite arbitrary file with the process identifiers of keepalived processes, but only if keepalived was launched with option to change pidfile location pointing to unsafe location and attacker is able to exploit Time-of-check Time-of-use race condition and create a symlink during a very small time frame in the same location the pidfile was specified. The default location used for pidfiles is safe. Red Hat Enterprise Linux 7 is by default configured with fs.protected_symlinks=1 which largely mitigates symlink attacks.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2018-19044\nhttps://nvd.nist.gov/vuln/detail/CVE-2018-19044"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2019:2285",
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"package": "keepalived-0:1.3.5-16.el7",
			"product_name": "Red Hat Enterprise Linux 7",
			"release_date": "2019-08-06T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Will not fix",
			"package_name": "keepalived",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "keepalived",
			"product_name": "Red Hat Enterprise Linux 8"
		}
	],
	"upstream_fix": "keepalived 2.0.9",
	"csaw": false
}
