{
	"name": "CVE-2018-20852",
	"threat_severity": "Moderate",
	"public_date": "2018-10-31T00:00:00Z",
	"bugzilla": {
		"description": "CVE-2018-20852 python: Cookie domain check returns incorrect results",
		"id": "1740347",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1740347"
	},
	"cvss3": {
		"cvss3_base_score": "5.3",
		"cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
		"status": "verified"
	},
	"cwe": "CWE-20",
	"details": [
		"http.cookiejar.DefaultPolicy.domain_return_ok in Lib/http/cookiejar.py in Python before 3.7.3 does not correctly validate the domain: it can be tricked into sending existing cookies to the wrong server. An attacker may abuse this flaw by using a server with a hostname that has another valid hostname as a suffix (e.g., pythonicexample.com to steal cookies for example.com). When a program uses http.cookiejar.DefaultPolicy and tries to do an HTTP connection to an attacker-controlled server, existing cookies can be leaked to the attacker. This affects 2.x through 2.7.16, 3.x before 3.4.10, 3.5.x before 3.5.7, 3.6.x before 3.6.9, and 3.7.x before 3.7.3."
	],
	"statement": "This issue affects the versions of python as shipped with Red Hat Enterprise Linux 5, 6, and 7. This issue affects the versions of python3 as shipped with Red Hat Enterprise Linux 7 and 8. This issue affects the versions of python2 and python36 as shipped with Red Hat Enterprise Linux 8.\nRed Hat Enterprise Linux 5 is now in Extended Life Phase of the support and maintenance life cycle. This issue is not currently planned to be addressed in future updates. For additional information, refer to the Red Hat Enterprise Linux Life Cycle: https://access.redhat.com/support/policy/updates/errata/.\nRed Hat Enterprise Linux 6 is now in Maintenance Support 2 Phase of the support and maintenance life cycle. This has been rated as having a security impact of Moderate, and is not currently planned to be addressed in future updates. For additional information, refer to the Red Hat Enterprise Linux Life Cycle: https://access.redhat.com/support/policy/updates/errata/.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2018-20852\nhttps://nvd.nist.gov/vuln/detail/CVE-2018-20852"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "A potentially simple workaround in the absence of patch on affected versions is to set DomainStrict in the cookiepolicy that would make sure a literal match against domain. The disadvantage would be that cookie set on example.com would not be shared with subdomain which might break workflow."
	},
	"affected_release": [
		{
			"advisory": "RHBA-2020:1539",
			"cpe": "cpe:/a:redhat:ansible_tower:3.5::el7",
			"package": "ansible-tower-35/ansible-tower:3.5.6-1",
			"product_name": "Red Hat Ansible Tower 3.5 for RHEL 7",
			"release_date": "2020-04-22T00:00:00Z"
		},
		{
			"advisory": "RHBA-2020:1540",
			"cpe": "cpe:/a:redhat:ansible_tower:3.6::el7",
			"package": "ansible-tower-36/ansible-tower:3.6.4-1",
			"product_name": "Red Hat Ansible Tower 3.6 for RHEL 7",
			"release_date": "2020-04-22T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:1131",
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"package": "python-0:2.7.5-88.el7",
			"product_name": "Red Hat Enterprise Linux 7",
			"release_date": "2020-03-31T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:1132",
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"package": "python3-0:3.6.8-13.el7",
			"product_name": "Red Hat Enterprise Linux 7",
			"release_date": "2020-03-31T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:1605",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "python27:2.7-8020020200117110429.90f98d4f",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2020-04-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:1764",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "python3-0:3.6.8-23.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2020-04-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:1764",
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"package": "python3-0:3.6.8-23.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2020-04-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3725",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el6",
			"package": "rh-python36-python-0:3.6.9-2.el6",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6",
			"release_date": "2019-11-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3948",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el6",
			"package": "python27-python-0:2.7.17-2.el6",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6",
			"release_date": "2019-11-25T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3725",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python36-python-0:3.6.9-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2019-11-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3948",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "python27-python-0:2.7.17-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2019-11-25T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3725",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python36-python-0:3.6.9-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
			"release_date": "2019-11-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3948",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "python27-python-0:2.7.17-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
			"release_date": "2019-11-25T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3725",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python36-python-0:3.6.9-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
			"release_date": "2019-11-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3948",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "python27-python-0:2.7.17-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
			"release_date": "2019-11-25T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3725",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python36-python-0:3.6.9-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2019-11-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3948",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "python27-python-0:2.7.17-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2019-11-25T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:5",
			"fix_state": "Out of support scope",
			"package_name": "python",
			"product_name": "Red Hat Enterprise Linux 5"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "python",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "python36:3.6/python36",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/a:redhat:quay:3",
			"fix_state": "Not affected",
			"package_name": "python27",
			"product_name": "Red Hat Quay 3"
		}
	],
	"upstream_fix": "Python 3.7.3, Python 3.5.7, Python 3.6.9, Python 3.4.10",
	"csaw": false
}
