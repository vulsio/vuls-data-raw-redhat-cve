{
	"name": "CVE-2018-20839",
	"threat_severity": "Moderate",
	"public_date": "2019-05-17T00:00:00Z",
	"bugzilla": {
		"description": "systemd: mishandling of the current keyboard mode check leading to passwords being disclosed in cleartext to attacker",
		"id": "1716955",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1716955"
	},
	"cvss3": {
		"cvss3_base_score": "4.3",
		"cvss3_scoring_vector": "CVSS:3.0/AV:P/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N",
		"status": "draft"
	},
	"cwe": "CWE-200",
	"details": [
		"systemd 242 changes the VT1 mode upon a logout, which allows attackers to read cleartext passwords in certain circumstances, such as watching a shutdown, or using Ctrl-Alt-F1 and Ctrl-Alt-F2. This occurs because the KDGKBMODE (aka current keyboard mode) check is mishandled."
	],
	"statement": "This vulnerability is rated as moderate rather than important because its exploitation requires specific local conditions that limit its impact and accessibility. The issue arises only under scenarios where user home directories become inaccessible, causing the login process to expose password input on a virtual terminal (VT1). To exploit this, an attacker needs local physical access (AV:P) or authenticated remote access (such as through SSH) to the system, and direct user interaction is necessary (UI:R) to actively switch between virtual terminals using `Ctrl+Alt+F1` and `Ctrl+Alt+F2`. Furthermore, the vulnerability is confined to compromising the confidentiality of password inputs (C:H), with no effect on the system's integrity (I:N) or availability (A:N). It does not grant elevated privileges, modify system state, or interfere with ongoing system operations. The combination of requiring physical proximity, specific environmental conditions, and manual toggling significantly reduces the likelihood and broader exploitability of this vulnerability, thus categorizing it as moderate severity rather than important.\nFurther complications occur in this issue: the initial fix provided by upstream introduced a regression and was reverted. In the process of managing a new fix, other contributory issues were reported against Xorg and Plymouth. Plymouth's issue was resolved. The ostensible fix versions of systemd (v243) and Plymouth (v0.9.4) are both fixed in RHEL-9, therefore RHEL-9 has been determined to be Not Affected by this flaw. Because of uncertainties and unknowns surrounding the purported fixes, the issue will not be corrected in RHEL-8.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2018-20839\nhttps://nvd.nist.gov/vuln/detail/CVE-2018-20839"
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "systemd",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Will not fix",
			"package_name": "systemd",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "systemd",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"csaw": false
}
