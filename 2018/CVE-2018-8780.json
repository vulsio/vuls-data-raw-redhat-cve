{
	"name": "CVE-2018-8780",
	"threat_severity": "Moderate",
	"public_date": "2018-03-28T00:00:00Z",
	"bugzilla": {
		"description": "ruby: Unintentional directory traversal by poisoned NULL byte in Dir",
		"id": "1561949",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1561949"
	},
	"cvss3": {
		"cvss3_base_score": "6.5",
		"cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
		"status": "verified"
	},
	"cwe": "CWE-626->CWE-22",
	"details": [
		"In Ruby before 2.2.10, 2.3.x before 2.3.7, 2.4.x before 2.4.4, 2.5.x before 2.5.1, and 2.6.0-preview1, the Dir.open, Dir.new, Dir.entries and Dir.empty? methods do not check NULL characters. When using the corresponding method, unintentional directory traversal may be performed.",
		"It was found that the methods from the Dir class did not properly handle strings containing the NULL byte. An attacker, able to inject NULL bytes in a path, could possibly trigger an unspecified behavior of the ruby script."
	],
	"statement": "This issue affects the versions of ruby as shipped with Red Hat CloudForms 4. Red Hat Product Security has rated this issue as having security impact of Moderate. A future update may address this issue. For additional information, refer to the Issue Severity Classification: https://access.redhat.com/security/updates/classification/.\nThis issue affects the versions of ruby as shipped with Red Hat Subscription Asset Manager 1. Red Hat Product Security has rated this issue as having security impact of Moderate. A future update may address this issue. For additional information, refer to the Issue Severity Classification: https://access.redhat.com/security/updates/classification/.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2018-8780\nhttps://nvd.nist.gov/vuln/detail/CVE-2018-8780\nhttps://www.ruby-lang.org/en/news/2018/03/28/poisoned-nul-byte-dir-cve-2018-8780/"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "It is possible to test for presence of the NULL byte manually prior to call a Dir method with an untrusted string."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2019:2028",
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"package": "ruby-0:2.0.0.648-36.el7",
			"product_name": "Red Hat Enterprise Linux 7",
			"release_date": "2019-08-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:0591",
			"cpe": "cpe:/o:redhat:rhel_aus:7.4",
			"package": "ruby-0:2.0.0.648-35.el7_4",
			"product_name": "Red Hat Enterprise Linux 7.4 Advanced Update Support",
			"release_date": "2020-02-25T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:0591",
			"cpe": "cpe:/o:redhat:rhel_tus:7.4",
			"package": "ruby-0:2.0.0.648-35.el7_4",
			"product_name": "Red Hat Enterprise Linux 7.4 Telco Extended Update Support",
			"release_date": "2020-02-25T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:0591",
			"cpe": "cpe:/o:redhat:rhel_e4s:7.4",
			"package": "ruby-0:2.0.0.648-35.el7_4",
			"product_name": "Red Hat Enterprise Linux 7.4 Update Services for SAP Solutions",
			"release_date": "2020-02-25T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:0542",
			"cpe": "cpe:/o:redhat:rhel_eus:7.5",
			"package": "ruby-0:2.0.0.648-35.el7_5",
			"product_name": "Red Hat Enterprise Linux 7.5 Extended Update Support",
			"release_date": "2020-02-19T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:0663",
			"cpe": "cpe:/o:redhat:rhel_eus:7.6",
			"package": "ruby-0:2.0.0.648-36.el7_6",
			"product_name": "Red Hat Enterprise Linux 7.6 Extended Update Support",
			"release_date": "2020-03-03T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:3729",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el6",
			"package": "rh-ruby23-ruby-0:2.3.8-69.el6",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6",
			"release_date": "2018-11-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:3730",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el6",
			"package": "rh-ruby24-ruby-0:2.4.5-91.el6",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6",
			"release_date": "2018-11-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:3729",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-ruby23-ruby-0:2.3.8-69.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2018-11-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:3730",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-ruby24-ruby-0:2.4.5-91.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2018-11-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:3731",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-ruby25-ruby-0:2.5.3-6.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2018-11-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:3729",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-ruby23-ruby-0:2.3.8-69.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.4 EUS",
			"release_date": "2018-11-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:3730",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-ruby24-ruby-0:2.4.5-91.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.4 EUS",
			"release_date": "2018-11-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:3731",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-ruby25-ruby-0:2.5.3-6.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.4 EUS",
			"release_date": "2018-11-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:3729",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-ruby23-ruby-0:2.3.8-69.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
			"release_date": "2018-11-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:3730",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-ruby24-ruby-0:2.4.5-91.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
			"release_date": "2018-11-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:3731",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-ruby25-ruby-0:2.5.3-6.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
			"release_date": "2018-11-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:3729",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-ruby23-ruby-0:2.3.8-69.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
			"release_date": "2018-11-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:3730",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-ruby24-ruby-0:2.4.5-91.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
			"release_date": "2018-11-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2018:3731",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-ruby25-ruby-0:2.5.3-6.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
			"release_date": "2018-11-29T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:cloudforms_managementengine:5",
			"fix_state": "Affected",
			"package_name": "rh-ruby22-ruby",
			"product_name": "CloudForms Management Engine 5"
		},
		{
			"cpe": "cpe:/a:redhat:cloudforms_managementengine:5",
			"fix_state": "Affected",
			"package_name": "ruby-200-ruby",
			"product_name": "CloudForms Management Engine 5"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:5",
			"fix_state": "Will not fix",
			"package_name": "ruby",
			"product_name": "Red Hat Enterprise Linux 5"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Will not fix",
			"package_name": "ruby",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "ruby",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:3",
			"fix_state": "Will not fix",
			"package_name": "rh-ruby22-ruby",
			"product_name": "Red Hat Software Collections"
		},
		{
			"cpe": "cpe:/a:rhel_sam:1",
			"fix_state": "Will not fix",
			"package_name": "ruby193-ruby",
			"product_name": "Red Hat Subscription Asset Manager"
		}
	],
	"upstream_fix": "ruby 2.2.10, ruby 2.3.7, ruby 2.4.4, ruby 2.5.1",
	"csaw": false
}
