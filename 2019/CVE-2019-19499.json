{
	"name": "CVE-2019-19499",
	"threat_severity": "Moderate",
	"public_date": "2020-08-27T00:00:00Z",
	"bugzilla": {
		"description": "grafana: arbitrary file read via MySQL data source",
		"id": "1873615",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1873615"
	},
	"cvss3": {
		"cvss3_base_score": "6.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
		"status": "verified"
	},
	"cwe": "CWE-88->CWE-200",
	"details": [
		"Grafana <= 6.4.3 has an Arbitrary File Read vulnerability, which could be exploited by an authenticated attacker that has privileges to modify the data source configurations.",
		"Grafana has an Arbitrary File Read vulnerability, which could be exploited by an authenticated attacker that has privileges to modify the data source configurations."
	],
	"statement": "A vulnerable version of Grafana is shipped in OpenShift 3.11 and OpenShift ServiceMesh, however Prometheus is used as a data source and modification to MySQL requires full control of the grafana component. Access is restricted to authenticated users only by OpenShift OAuth. As OpenShift and OpenShift ServiceMesh still packages the vulnerable code, the components are affected but with impact Low. \nRed Hat Ceph Storage 3 and 4 ships an older version of the affected code, which is still possible to exploit. However, Ceph 3 and 4 do not use mysql as a datasource, therefore, the impact is low.\nRed Hat Gluster Storage 3 ships vulnerable version of grafana, however Graphite is the only supported data source and hence this issue has been rated as having a security impact of Low.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2019-19499\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-19499\nhttps://swarm.ptsecurity.com/grafana-6-4-3-arbitrary-file-read/"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2020:4682",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "grafana-0:6.7.4-3.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2020-11-04T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:service_mesh:1",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "servicemesh-grafana",
			"product_name": "OpenShift Service Mesh 1"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:2",
			"fix_state": "Out of support scope",
			"package_name": "grafana",
			"product_name": "Red Hat Ceph Storage 2"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:3",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "grafana",
			"product_name": "Red Hat Ceph Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:3",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "grafana-container",
			"product_name": "Red Hat Ceph Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:4",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "rhceph/rhceph-4-dashboard-rhel8",
			"product_name": "Red Hat Ceph Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "openshift3/grafana",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-grafana",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "grafana",
			"product_name": "Red Hat Storage 3"
		}
	],
	"upstream_fix": "grafana 6.4.4",
	"csaw": false
}
