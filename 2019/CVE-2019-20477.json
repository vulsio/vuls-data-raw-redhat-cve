{
	"name": "CVE-2019-20477",
	"threat_severity": "Moderate",
	"public_date": "2019-11-18T00:00:00Z",
	"bugzilla": {
		"description": "CVE-2019-20477 PyYAML: command execution through python/object/apply constructor in FullLoader",
		"id": "1806005",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1806005"
	},
	"cvss3": {
		"cvss3_base_score": "9.8",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-502",
	"details": [
		"PyYAML 5.1 through 5.1.2 has insufficient restrictions on the load and load_all functions because of a class deserialization issue, e.g., Popen is a class in the subprocess module. NOTE: this issue exists because of an incomplete fix for CVE-2017-18342.",
		"A vulnerability was discovered in the PyYAML library, where it is susceptible to arbitrary code execution when it processes untrusted YAML files through the full_load method or with the FullLoader loader. Applications that use the library to process untrusted input may be vulnerable to this flaw. An attacker could use this flaw to execute arbitrary code on the system by abusing the python/object/apply constructor."
	],
	"statement": "This issue did not affect the versions of PyYAML as shipped with Red Hat Enterprise Linux 7, and 8 as they did not include the class FullLoader, which contains this vulnerability.\nThe PyYAML libary that is provided in the Red Hat OpenStack repositories is vulnerable. However, because there are no instances where this library is used in a way which exposes the vulnerability, the impact to OpenStack products has been reduced to 'low' and Red Hat will not be providing a fix at this time.  Any updates will be through RHEL channels.\nRed Hat Quay 3.2 uses the vulnerable load function, but only to parse the Nginx configuration file, which only contains trusted data.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2019-20477\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-20477"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Use `yaml.safe_load` or the SafeLoader loader when you parse untrusted input."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2020:4641",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "python38:3.8-8030020200818121840.4190259b",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2020-11-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:0420",
			"cpe": "cpe:/a:redhat:quay:3::el8",
			"impact": "low",
			"package": "quay/clair-rhel8:v3.4.0-25",
			"product_name": "Red Hat Quay 3",
			"release_date": "2021-02-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:0420",
			"cpe": "cpe:/a:redhat:quay:3::el8",
			"impact": "low",
			"package": "quay/quay-bridge-operator-bundle:v3.4.0-3",
			"product_name": "Red Hat Quay 3",
			"release_date": "2021-02-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:0420",
			"cpe": "cpe:/a:redhat:quay:3::el8",
			"impact": "low",
			"package": "quay/quay-bridge-operator-rhel8:v3.4.0-17",
			"product_name": "Red Hat Quay 3",
			"release_date": "2021-02-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:0420",
			"cpe": "cpe:/a:redhat:quay:3::el8",
			"impact": "low",
			"package": "quay/quay-builder-qemu-rhcos-rhel8:v3.4.0-17",
			"product_name": "Red Hat Quay 3",
			"release_date": "2021-02-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:0420",
			"cpe": "cpe:/a:redhat:quay:3::el8",
			"impact": "low",
			"package": "quay/quay-builder-rhel8:v3.4.0-18",
			"product_name": "Red Hat Quay 3",
			"release_date": "2021-02-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:0420",
			"cpe": "cpe:/a:redhat:quay:3::el8",
			"impact": "low",
			"package": "quay/quay-container-security-operator-bundle:v3.4.0-2",
			"product_name": "Red Hat Quay 3",
			"release_date": "2021-02-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:0420",
			"cpe": "cpe:/a:redhat:quay:3::el8",
			"impact": "low",
			"package": "quay/quay-container-security-operator-rhel8:v3.4.0-2",
			"product_name": "Red Hat Quay 3",
			"release_date": "2021-02-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:0420",
			"cpe": "cpe:/a:redhat:quay:3::el8",
			"impact": "low",
			"package": "quay/quay-openshift-bridge-rhel8-operator:v3.4.0-17",
			"product_name": "Red Hat Quay 3",
			"release_date": "2021-02-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:0420",
			"cpe": "cpe:/a:redhat:quay:3::el8",
			"impact": "low",
			"package": "quay/quay-operator-bundle:v3.4.0-89",
			"product_name": "Red Hat Quay 3",
			"release_date": "2021-02-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:0420",
			"cpe": "cpe:/a:redhat:quay:3::el8",
			"impact": "low",
			"package": "quay/quay-operator-rhel8:v3.4.0-132",
			"product_name": "Red Hat Quay 3",
			"release_date": "2021-02-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:0420",
			"cpe": "cpe:/a:redhat:quay:3::el8",
			"impact": "low",
			"package": "quay/quay-rhel8:v3.4.0-51",
			"product_name": "Red Hat Quay 3",
			"release_date": "2021-02-04T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "PyYAML",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "PyYAML",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "python27:2.7/PyYAML",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "PyYAML",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:10",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "PyYAML",
			"product_name": "Red Hat OpenStack Platform 10 (Newton)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:13",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "PyYAML",
			"product_name": "Red Hat OpenStack Platform 13 (Queens)"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:3",
			"fix_state": "Not affected",
			"package_name": "python27-PyYAML",
			"product_name": "Red Hat Software Collections"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:3",
			"fix_state": "Not affected",
			"package_name": "rh-python36-PyYAML",
			"product_name": "Red Hat Software Collections"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:3",
			"fix_state": "Not affected",
			"package_name": "rh-python38-PyYAML",
			"product_name": "Red Hat Software Collections"
		}
	],
	"upstream_fix": "pyYAML 5.2",
	"csaw": false
}
