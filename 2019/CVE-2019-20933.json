{
	"name": "CVE-2019-20933",
	"threat_severity": "Important",
	"public_date": "2019-03-27T00:00:00Z",
	"bugzilla": {
		"description": "authentication bypass because a JWT token may have an empty SharedSecret",
		"id": "1900078",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1900078"
	},
	"cvss3": {
		"cvss3_base_score": "8.6",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L",
		"status": "draft"
	},
	"cwe": "CWE-20->CWE-287",
	"details": [
		"InfluxDB before 1.7.6 has an authentication bypass vulnerability in the authenticate function in services/httpd/handler.go because a JWT token may have an empty SharedSecret (aka shared secret).",
		"An authentication bypass vulnerability was found in InfluxDB. By default, when using JWT authentication, InfluxDB does not generate a signing secret or state in the documentation that a JWT secret must be generated. If InfluxDB is left in the default state, this flaw allows an attacker to generate their own JWT token and log into the InfluxDBinstance, potentially escalating privileges and gaining access to sensitive information."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2019-20933\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-20933\nhttps://github.com/influxdata/influxdb/issues/12927"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "For versions before 1.7.6, as per the documentation updated by influxdb, ensure that a default shared-secret has be defined when enabling JWT authentication:\nhttps://docs.influxdata.com/influxdb/v1.8/administration/authentication_and_authorization/#1-add-a-shared-secret-in-your-influxdb-configuration-file \nVersions including the fix will return an error if the secret is left empty."
	},
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:jaeger:1.17::el7",
			"fix_state": "Not affected",
			"package_name": "jaeger-rhel8-operator",
			"product_name": "Distributed Tracing Jaeger"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:1",
			"fix_state": "Not affected",
			"package_name": "servicemesh-prometheus",
			"product_name": "OpenShift Service Mesh 1"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "influxdb",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Not affected",
			"package_name": "camel-influxdb",
			"product_name": "Red Hat Integration Camel K"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Not affected",
			"package_name": "camel-quarkus-influxdb-deployment",
			"product_name": "Red Hat Integration Camel K"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Not affected",
			"package_name": "camel-quarkus-influxdb-integration-test",
			"product_name": "Red Hat Integration Camel K"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Not affected",
			"package_name": "influxdb-java",
			"product_name": "Red Hat Integration Camel K"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:6",
			"fix_state": "Not affected",
			"package_name": "influxdb-java",
			"product_name": "Red Hat JBoss Fuse 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"fix_state": "Not affected",
			"package_name": "camel-influxdb",
			"product_name": "Red Hat JBoss Fuse 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"fix_state": "Not affected",
			"package_name": "camel-influxdb-starter",
			"product_name": "Red Hat JBoss Fuse 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"fix_state": "Not affected",
			"package_name": "influxdb-java",
			"product_name": "Red Hat JBoss Fuse 7"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "golang-github-prometheus-prometheus-container",
			"product_name": "Red Hat OpenShift Container Platform 4"
		}
	],
	"upstream_fix": "influxdb 1.7.6",
	"csaw": false
}
