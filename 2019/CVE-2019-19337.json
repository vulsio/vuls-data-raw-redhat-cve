{
	"name": "CVE-2019-19337",
	"threat_severity": "Moderate",
	"public_date": "2019-12-19T17:07:00Z",
	"bugzilla": {
		"description": "CVE-2019-19337 ceph: denial of service in RGW daemon",
		"id": "1781170",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1781170"
	},
	"cvss3": {
		"cvss3_base_score": "6.5",
		"cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
		"status": "verified"
	},
	"cwe": "CWE-20",
	"details": [
		"A flaw was found in Red Hat Ceph Storage version 3 in the way the Ceph RADOS Gateway daemon handles S3 requests. An authenticated attacker can abuse this flaw by causing a remote denial of service by sending a specially crafted HTTP Content-Length header to the Ceph RADOS Gateway server.",
		"A flaw was found in the way the Ceph RADOS Gateway daemon handles S3 requests. An authenticated attacker can abuse this flaw by causing a remote denial of service by sending a specially crafted HTTP Content-Length header to the Ceph RADOS Gateway server."
	],
	"statement": "This flaw only affects Red Hat Ceph Storage 3, upstream versions of ceph are not affected.\nThe ceph package distributed by Red Hat Enterprise Linux 7 and 8 are not affected by this issue, as it doesn't ship any server-side library.\nRed Hat OpenStack now consumes fixes directly from the base ceph channels . Therefore the ceph package provided by Red Hat OpenStack 13 has been marked as 'will not fix'.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2019-19337\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-19337"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "1. By default system will use /etc/init.d/ceph-radosgw, stop this service by\n~]# /etc/init.d/ceph-radosgw stop\n2. Create systemd service, and change command line parameters according to the environment where Ceph radosgw is running.\n~]# cat /usr/lib/systemd/system/ceph-rgw.service\n[Unit]\nDescription=Ceph RGW daemon\n[Service]\nType=forking\nExecStart=/bin/radosgw -n client.rgw.$(HOSTNAME REDACTED)\nRestart=on-abnormal\nRestartSec=1s\n[Install]\nWantedBy=multi-user.target\n3. Run systemd service 'ceph-rgw.service'\nCaveat: It still takes +1-2 sec to get service back online. After applying above mentioned mitigation, the malicious IP can be blocked by a firewall rule if there are continuous attempts to launch remote denial of service. This mitigation is of limited use if the attack is launched from multiple IPs. It is recommended to limit the exposure of ceph RGW server to known clients."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2019:4353",
			"cpe": "cpe:/a:redhat:ceph_storage:3::el7",
			"package": "ceph-2:12.2.12-84.el7cp",
			"product_name": "Red Hat Ceph Storage 3.3",
			"release_date": "2019-12-19T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:4353",
			"cpe": "cpe:/a:redhat:ceph_storage:3::el7",
			"package": "ceph-ansible-0:3.2.38-1.el7cp",
			"product_name": "Red Hat Ceph Storage 3.3",
			"release_date": "2019-12-19T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:4353",
			"cpe": "cpe:/a:redhat:ceph_storage:3::el7",
			"package": "cephmetrics-0:2.0.9-1.el7cp",
			"product_name": "Red Hat Ceph Storage 3.3",
			"release_date": "2019-12-19T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:4357",
			"cpe": "cpe:/a:redhat:ceph_storage:3::ubuntu16.04",
			"package": "ceph",
			"product_name": "Red Hat Ceph Storage 3 for Ubuntu",
			"release_date": "2019-12-19T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:ceph_storage:2",
			"fix_state": "Not affected",
			"package_name": "ceph",
			"product_name": "Red Hat Ceph Storage 2"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:4",
			"fix_state": "Not affected",
			"package_name": "ceph",
			"product_name": "Red Hat Ceph Storage 4"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "ceph-common",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "ceph",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:13",
			"fix_state": "Will not fix",
			"package_name": "ceph",
			"product_name": "Red Hat OpenStack Platform 13 (Queens)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:15",
			"fix_state": "Not affected",
			"package_name": "ceph",
			"product_name": "Red Hat OpenStack Platform 15 (Stein)"
		}
	],
	"upstream_fix": "ceph-12.2.12-83.el7cp ceph_12.2.12-76redhat1",
	"csaw": false
}
