{
	"name": "CVE-2019-2386",
	"threat_severity": "Moderate",
	"public_date": "2019-08-06T00:00:00Z",
	"bugzilla": {
		"description": "Improper invalidation of authorization sessions for deleted users",
		"id": "1746132",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1746132"
	},
	"cvss3": {
		"cvss3_base_score": "7.1",
		"cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H",
		"status": "draft"
	},
	"cwe": "CWE-613",
	"details": [
		"After user deletion in MongoDB Server the improper invalidation of authorization sessions allows an authenticated user's session to persist and become conflated with new accounts, if those accounts reuse the names of deleted ones. This issue affects MongoDB Server v4.0 versions prior to 4.0.9; MongoDB Server v3.6 versions prior to 3.6.13 and MongoDB Server v3.4 versions prior to 3.4.22.\nWorkaround: \nAfter deleting one or more users, restart any nodes which may have had active user authorization sessions.\nRefrain from creating user accounts with the same name as previously deleted accounts.",
		"A session expiration flaw was discovered in MongoDB. After a user is deleted, the session tokens for that user do not expire and can be reused if a new user is created with the same name. An attacker with access to a MongoDB user could exploit this flaw to gain access to the new user account."
	],
	"statement": "The supported versions of Red Hat Satellite do not ship the affected MongoDB and are only consumed through Red Hat Software Collections (RHSCL) repository. However, the product is not affected by the vulnerability because the usage of MongoDB does not add or delete users on a recurring basis.\nThis issue does affect the versions of MongoDB as shipped with Red Hat Update Infrastructure for Cloud Providers, but the service is only accessible by users who already have access to the Red Hat Update Appliance (RHUA).",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2019-2386\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-2386\nhttps://jira.mongodb.org/browse/SERVER-38984"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "This vulnerability can be mitigated by either of two administrative practices:\n* Whenever a user is deleted, restart all nodes where that user may have an active session\n* When a user is deleted, ensure than a new user with the same name will never be created\nIf your mongodb instance is deployed in a situation where users never need to be deleted, or one of the above mitigations can be applied, this vulnerability can not be exploited."
	},
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:openstack:10",
			"fix_state": "Will not fix",
			"package_name": "mongodb",
			"product_name": "Red Hat OpenStack Platform 10 (Newton)"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:3",
			"fix_state": "Will not fix",
			"package_name": "rh-mongodb34-mongodb",
			"product_name": "Red Hat Software Collections"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:3",
			"fix_state": "Will not fix",
			"package_name": "rh-mongodb36-mongodb",
			"product_name": "Red Hat Software Collections"
		},
		{
			"cpe": "cpe:/a:redhat:rhui:3",
			"fix_state": "Will not fix",
			"package_name": "mongodb",
			"product_name": "Red Hat Update Infrastructure 3 for Cloud Providers"
		}
	],
	"upstream_fix": "mongodb 4.0.9, mongodb 3.6.13, mongodb 3.4.22",
	"csaw": false
}
