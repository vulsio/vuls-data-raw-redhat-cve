{
	"name": "CVE-2019-10197",
	"threat_severity": "Moderate",
	"public_date": "2019-09-03T00:00:00Z",
	"bugzilla": {
		"description": "samba: Combination of parameters and permissions can allow user to escape from the share path definition",
		"id": "1746225",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1746225"
	},
	"cvss3": {
		"cvss3_base_score": "6.5",
		"cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
		"status": "verified"
	},
	"cwe": "CWE-22",
	"details": [
		"A flaw was found in samba versions 4.9.x up to 4.9.13, samba 4.10.x up to 4.10.8 and samba 4.11.x up to 4.11.0rc3, when certain parameters were set in the samba configuration file. An unauthenticated attacker could use this flaw to escape the shared directory and access the contents of directories outside the share.",
		"A flaw was found in samba when certain parameters were set in the samba configuration file. An unauthenticated attacker could use this flaw to escape the shared directory and access the contents of directories outside of the share."
	],
	"statement": "Only samba configurations where 'wide links' option is explicitly set to 'yes' is affected by this flaw. Therefore default configurations of samba package shipped with Red Hat Products are not affected.\nThis vulnerability exists in the samba server, client side packages are not affected.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2019-10197\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-10197\nhttps://www.samba.org/samba/security/CVE-2019-10197.html"
	],
	"acknowledgement": "Red Hat would like to thank Stefan Metzmacher (SerNet) for reporting this issue.",
	"mitigation": {
		"lang": "en:us",
		"value": "The following methods can be used as a mitigation (only one is needed):\n1. Use the 'sharesec' tool to configure a security descriptor for the share that's at least as strict as the permissions on the share root  directory.\n2. Use the 'valid users' option to allow only users/groups which are able to enter the share root directory.\n3. Remove 'wide links = yes' if it's not really needed.\n4. In some situations it might be an option to use 'chmod a+x' on the share root directory, but you need to make sure that files and subdirectories are protected by stricter permissions. You may also want to 'chmod a-w' in order to prevent new top level files and directories, which may have less restrictive permissions."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2020:1084",
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"package": "samba-0:4.10.4-10.el7",
			"product_name": "Red Hat Enterprise Linux 7",
			"release_date": "2020-03-31T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:1878",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "openchange-0:2.3-24.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2020-04-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:1878",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "samba-0:4.11.2-13.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2020-04-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:1878",
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"package": "openchange-0:2.3-24.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2020-04-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:1878",
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"package": "samba-0:4.11.2-13.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2020-04-28T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:4023",
			"cpe": "cpe:/a:redhat:storage:3.5:samba:el6",
			"package": "samba-0:4.9.8-110.el6rhs",
			"product_name": "Red Hat Gluster Storage 3.5 for RHEL 6",
			"release_date": "2019-12-02T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3253",
			"cpe": "cpe:/a:redhat:storage:3.5:samba:el7",
			"package": "samba-0:4.9.8-109.el7rhgs",
			"product_name": "Red Hat Gluster Storage 3.5 for RHEL 7",
			"release_date": "2019-10-30T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "samba",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "samba4",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/a:redhat:enterprise_linux:8::hypervisor",
			"fix_state": "Not affected",
			"package_name": "redhat-virtualization-host",
			"product_name": "Red Hat Virtualization 4"
		}
	],
	"upstream_fix": "samba 4.9.13, samba 4.10.8, samba 4.11.0rc3",
	"csaw": false
}
