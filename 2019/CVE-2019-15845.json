{
	"name": "CVE-2019-15845",
	"threat_severity": "Moderate",
	"public_date": "2019-10-01T00:00:00Z",
	"bugzilla": {
		"description": "CVE-2019-15845 ruby: NUL injection vulnerability of File.fnmatch and File.fnmatch?",
		"id": "1789407",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1789407"
	},
	"cvss3": {
		"cvss3_base_score": "6.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
		"status": "verified"
	},
	"cwe": "CWE-626->CWE-41",
	"details": [
		"Ruby through 2.4.7, 2.5.x through 2.5.6, and 2.6.x through 2.6.4 mishandles path checking within File.fnmatch functions.",
		"A flaw was discovered in Ruby in the way certain functions handled strings containing NULL bytes. Specifically, the built-in methods File.fnmatch and its alias File.fnmatch? did not properly handle path patterns containing the NULL byte. A remote attacker could exploit this flaw to make a Ruby script access unexpected files and to bypass intended file system access restrictions."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2019-15845\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-15845\nhttps://www.ruby-lang.org/en/news/2019/10/01/nul-injection-file-fnmatch-cve-2019-15845/"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "It is possible to test for presence of the NULL byte manually prior to call the affected methods with an untrusted string."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2021:2587",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "ruby:2.5-8040020200923213910.522a0ee4",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2021-06-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:2588",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "ruby:2.6-8040020210430142949.522a0ee4",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2021-06-29T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0581",
			"cpe": "cpe:/a:redhat:rhel_e4s:8.1",
			"package": "ruby:2.6-8010020220201152941.c27ad7f8",
			"product_name": "Red Hat Enterprise Linux 8.1 Update Services for SAP Solutions",
			"release_date": "2022-02-21T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0582",
			"cpe": "cpe:/a:redhat:rhel_eus:8.2",
			"package": "ruby:2.6-8020020220201131207.4cda2c84",
			"product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
			"release_date": "2022-02-21T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:2104",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-ruby25-ruby-0:2.5.9-9.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2021-05-26T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:2230",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-ruby26-ruby-0:2.6.7-119.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2021-06-03T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:2104",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-ruby25-ruby-0:2.5.9-9.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
			"release_date": "2021-05-26T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:2104",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-ruby25-ruby-0:2.5.9-9.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2021-05-26T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:2230",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-ruby26-ruby-0:2.6.7-119.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2021-06-03T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:red_hat_3scale_amp:2",
			"fix_state": "Will not fix",
			"package_name": "3amp-system",
			"product_name": "Red Hat 3scale API Management Platform 2"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:5",
			"fix_state": "Out of support scope",
			"package_name": "ruby",
			"product_name": "Red Hat Enterprise Linux 5"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "ruby",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Will not fix",
			"package_name": "ruby",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:3",
			"fix_state": "Will not fix",
			"package_name": "rh-ruby24-ruby",
			"product_name": "Red Hat Software Collections"
		}
	],
	"upstream_fix": "ruby 2.4.8, ruby 2.7.0, ruby 2.6.5, ruby 2.5.7",
	"csaw": false
}
