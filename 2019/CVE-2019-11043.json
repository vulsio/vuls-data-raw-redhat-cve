{
	"name": "CVE-2019-11043",
	"threat_severity": "Critical",
	"public_date": "2019-10-24T00:00:00Z",
	"bugzilla": {
		"description": "underflow in env_path_info in fpm_main.c",
		"id": "1766378",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1766378"
	},
	"cvss3": {
		"cvss3_base_score": "8.1",
		"cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-20->CWE-787",
	"details": [
		"In PHP versions 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11 in certain configurations of FPM setup it is possible to cause FPM module to write past allocated buffers into the space reserved for FCGI protocol data, thus opening the possibility of remote code execution."
	],
	"statement": "This issue only affects instances running php-fpm under nginx server software as environment paths and parameters are handled by different code pieces depending on the server php-fpm is running under. The code where this issue is found is used exclusively when php-fpm detects the request came through an nginx server.\nRed Hat Product Security team rated this issue as having a Critical security impact as an attacker may take advantage from the existing bug to cause Remote Code Execution on network exposed software.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2019-11043\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-11043\nhttps://www.nginx.com/blog/php-fpm-cve-2019-11043-vulnerability-nginx/"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "1)  Check your nginx configuration files, specially the ones related to php-fpm for presence of pattern bellow on fastcgi_split_path_info regex and PATH_INFO parameter:\n~~~\nfastcgi_split_path_info     ^(.+?\\.php)(/.*)$;\nfastcgi_param    PATH_INFO  $fastcgi_path_info;\n~~~\n2) If fastcgi_split_path_info regex matches with the one above, for each fastcgi_param PATH_INFO entry perform the following change:\n~~~\nfastcgi_param    PATH_INFO  $fastcgi_path_info if_not_empty;\n~~~\nThis step will allow you to safely continue using PATH_INFO parameter while the patch is not applied.\n3) Restart your nginx instance:\n~~~\nsystemctl restart nginx\n~~~"
	},
	"affected_release": [
		{
			"advisory": "RHSA-2019:3287",
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"package": "php-0:5.3.3-50.el6_10",
			"product_name": "Red Hat Enterprise Linux 6",
			"release_date": "2019-10-31T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3286",
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"package": "php-0:5.4.16-46.1.el7_7",
			"product_name": "Red Hat Enterprise Linux 7",
			"release_date": "2019-10-31T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:2835",
			"cpe": "cpe:/o:redhat:rhel_eus:7.6",
			"package": "php-0:5.4.16-46.1.el7_6",
			"product_name": "Red Hat Enterprise Linux 7.6 Extended Update Support",
			"release_date": "2020-07-07T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3735",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "php:7.2-8010020191030112723.dcfb48bd",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2019-11-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3736",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "php:7.3-8010020191030161321.dcfb48bd",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2019-11-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:0322",
			"cpe": "cpe:/a:redhat:rhel_e4s:8.0",
			"package": "php:7.2-8000020191113103901.5d58a046",
			"product_name": "Red Hat Enterprise Linux 8.0 Update Services for SAP Solutions",
			"release_date": "2020-02-03T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3724",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el6",
			"package": "rh-php70-php-0:7.0.27-2.el6",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6",
			"release_date": "2019-11-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3299",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-php72-php-0:7.2.24-1.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2019-11-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3300",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-php71-php-0:7.1.30-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2019-11-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3724",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-php70-php-0:7.0.27-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2019-11-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3299",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-php72-php-0:7.2.24-1.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
			"release_date": "2019-11-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3300",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-php71-php-0:7.1.30-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
			"release_date": "2019-11-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3724",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-php70-php-0:7.0.27-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
			"release_date": "2019-11-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3299",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-php72-php-0:7.2.24-1.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
			"release_date": "2019-11-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3300",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-php71-php-0:7.1.30-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
			"release_date": "2019-11-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3724",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-php70-php-0:7.0.27-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.6 EUS",
			"release_date": "2019-11-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3299",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-php72-php-0:7.2.24-1.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2019-11-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3300",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-php71-php-0:7.1.30-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2019-11-01T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3724",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-php70-php-0:7.0.27-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2019-11-06T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:5",
			"fix_state": "Not affected",
			"package_name": "php",
			"product_name": "Red Hat Enterprise Linux 5"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:5",
			"fix_state": "Not affected",
			"package_name": "php53",
			"product_name": "Red Hat Enterprise Linux 5"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:3",
			"fix_state": "Not affected",
			"package_name": "rh-php73-php",
			"product_name": "Red Hat Software Collections"
		}
	],
	"upstream_fix": "php 7.2.24, php 7.1.33, php 7.3.11",
	"csaw": false
}
