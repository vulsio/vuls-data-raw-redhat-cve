{
	"acknowledgement": "This issue was discovered by Carlos Goncalves (Red Hat).",
	"affected_release": [
		{
			"advisory": "RHSA-2019:1742",
			"cpe": "cpe:/a:redhat:openstack:13::el7",
			"package": "openstack-tripleo-common-0:8.6.8-11.el7ost",
			"product_name": "Red Hat OpenStack Platform 13.0 (Queens)",
			"release_date": "2019-07-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:1683",
			"cpe": "cpe:/a:redhat:openstack:14::el7",
			"package": "openstack-tripleo-common-0:9.5.0-5.el7ost",
			"product_name": "Red Hat OpenStack Platform 14.0 (Rocky)",
			"release_date": "2019-07-02T00:00:00Z"
		}
	],
	"bugzilla": {
		"description": "CVE-2019-3895 openstack-tripleo-common: Allows running new amphorae based on arbitrary images",
		"id": "1694608",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1694608"
	},
	"csaw": false,
	"cvss3": {
		"cvss3_base_score": "5.5",
		"cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L",
		"status": "verified"
	},
	"cwe": "CWE-284",
	"details": [
		"An access-control flaw was found in the Octavia service when the cloud platform was deployed using Red Hat OpenStack Platform Director. An attacker could cause new amphorae to run based on any arbitrary image. This meant that a remote attacker could upload a new amphorae image and, if requested to spawn new amphorae, Octavia would then pick up the compromised image.",
		"An access-control flaw was found in the Octavia service when the cloud platform was deployed using Red Hat OpenStack Platform Director. An attacker could cause new amphorae to run based on any arbitrary image. This meant that a remote attacker could upload a new amphorae image and, if requested to spawn new amphorae, Octavia would then pick up the compromised image."
	],
	"mitigation": {
		"lang": "en:us",
		"value": "To prevent this vulnerability:\n1. Update Octavia's configuration setting (octavia.conf) to `amp_image_owner_id = $UUID_OF_SERVICE_PROJECT` on all Octavia nodes. \n2. Enable the new configuration by restarting both `octavia_worker` and `octavia_health_manager`."
	},
	"name": "CVE-2019-3895",
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:openstack:15",
			"fix_state": "Not affected",
			"package_name": "openstack-tripleo-common",
			"product_name": "Red Hat OpenStack Platform 15 (Stein)"
		}
	],
	"public_date": "2019-05-27T00:00:00Z",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2019-3895\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-3895\nhttps://bugs.launchpad.net/tripleo/+bug/1830607\nhttps://github.com/openstack/tripleo-common/commit/e7c5eab712e0f70ecbc6d225d4766e0fe0f3f884"
	],
	"threat_severity": "Moderate",
	"upstream_fix": "openstack-tripleo-common-8.6.8 9, openstack-tripleo-common-9.5.0 5"
}
