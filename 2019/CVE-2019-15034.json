{
	"bugzilla": {
		"description": "CVE-2019-15034 qemu: hw/display/bochs-display.c does not ensure a sufficient PCI config space allocation leading to a buffer overflow involving the PCIe extended config space",
		"id": "1812659",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1812659"
	},
	"csaw": false,
	"cvss3": {
		"cvss3_base_score": "5.8",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:H",
		"status": "draft"
	},
	"cwe": "CWE-120",
	"details": [
		"hw/display/bochs-display.c in QEMU 4.0.0 does not ensure a sufficient PCI config space allocation, leading to a buffer overflow involving the PCIe extended config space.",
		"A buffer overflow flaw was found in the way the Bochs display driver of QEMU handled the PCIe extended configuration space when the device is connected to a PCIe bus. Accessing the PCIe extended config space could overflow the conventional PCI config space buffer due to limited memory allocation. As the PCIe config space is guest writeable, this flaw allows a local attacker to gain access and potentially execute arbitrary code on the host with the privileges of the QEMU process."
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Use `-device bochs-display` as conventional PCI device only."
	},
	"name": "CVE-2019-15034",
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:5",
			"fix_state": "Not affected",
			"package_name": "kvm",
			"product_name": "Red Hat Enterprise Linux 5"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:5",
			"fix_state": "Not affected",
			"package_name": "xen",
			"product_name": "Red Hat Enterprise Linux 5"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "qemu-kvm",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "qemu-kvm",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "qemu-kvm-ma",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "qemu-kvm-rhev",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "virt:rhel/qemu-kvm",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/a:redhat:advanced_virtualization:8::el8",
			"fix_state": "Not affected",
			"package_name": "virt:8.1/qemu-kvm",
			"product_name": "Red Hat Enterprise Linux 8 Advanced Virtualization"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:10",
			"fix_state": "Not affected",
			"package_name": "qemu-kvm-rhev",
			"product_name": "Red Hat OpenStack Platform 10 (Newton)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:13",
			"fix_state": "Not affected",
			"package_name": "qemu-kvm-rhev",
			"product_name": "Red Hat OpenStack Platform 13 (Queens)"
		}
	],
	"public_date": "2019-08-12T00:00:00Z",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2019-15034\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-15034"
	],
	"statement": "This flaw does not affect the module stream`virt:8.1/qemu-kvm` as shipped with RHEL Advanced Virtualization, as it already includes the patch.\nSeveral other packages are unaffected because they do not include PCIe support:\n* `kvm` and `xen` as shipped with Red Hat Enterprise Linux 5\n* `qemu-kvm` as shipped with Red Hat Enterprise Linux 6 and 7\n* `qemu-kvm-rhev` as shipped with Red Hat Enterprise Linux 7\n* `virt:rhel/qemu-kvm` as shipped with Red Hat Enterprise Linux 8\n* `qemu-kvm-rhev` as shipped with Red Hat OpenStack Platform 10 and 13",
	"threat_severity": "Important",
	"upstream_fix": "qemu 4.1.0"
}
