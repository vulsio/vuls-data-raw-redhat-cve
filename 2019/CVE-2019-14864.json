{
	"name": "CVE-2019-14864",
	"threat_severity": "Moderate",
	"public_date": "2019-10-22T00:00:00Z",
	"bugzilla": {
		"description": "Ansible: Splunk and Sumologic callback plugins leak sensitive data in logs",
		"id": "1764148",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1764148"
	},
	"cvss3": {
		"cvss3_base_score": "5.7",
		"cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N",
		"status": "verified"
	},
	"cwe": "CWE-117->CWE-532",
	"details": [
		"Ansible, versions 2.9.x before 2.9.1, 2.8.x before 2.8.7 and Ansible versions 2.7.x before 2.7.15, is not respecting the flag no_log set it to True when Sumologic and Splunk callback plugins are used send tasks results events to collectors. This would discloses and collects any sensitive data.",
		"A data disclosure flaw was found in Ansible when using the Splunk and Sumologic modules, as they are not respecting when the flag no_log is enabled. This flaw can disclose and collect sensitive data from the system and expose it to an attacker."
	],
	"statement": "* The exploitation of this flaw depends on the use of either Sumo Logic or Splunk callback plugins. However, because Red Hat OpenStack Platform (RHOSP) does not use Sumo Logic or Splunk, Red Hat will not be providing a fix for RHOSP Ansible at this time.\n* Red Hat Gluster Storage no more maintains its own version of Ansible, pre-requisite is to enable ansible repository. The fix will be consumed from core Ansible.\n* Ansible Tower’s Splunk logging integration uses the Splunk HTTP Collector and Ansible Engine.\n* The exploitation of this flaw depends on the use of either Sumo Logic or Splunk callback plugins. However, because Red Hat Satellite 6.4 and 6.5 do not use Sumo Logic or Splunk, Red Hat will not be providing a fix for Satellite 6.4 and 6.5 and Ansible at this time. Users may upgrade to Satellite 6.6 or later which includes the resolution to this bug if desired.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2019-14864\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-14864"
	],
	"acknowledgement": "This issue was discovered by Abhijeet Kasurde (Red Hat) and Patrick O’Brien (The Trade Desk Inc).",
	"affected_release": [
		{
			"advisory": "RHSA-2019:3925",
			"cpe": "cpe:/a:redhat:ansible_engine:2.7::el7",
			"impact": "moderate",
			"package": "ansible-0:2.7.15-1.el7ae",
			"product_name": "Red Hat Ansible Engine 2.7 for RHEL 7",
			"release_date": "2019-11-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3926",
			"cpe": "cpe:/a:redhat:ansible_engine:2.8::el7",
			"impact": "moderate",
			"package": "ansible-0:2.8.7-1.el7ae",
			"product_name": "Red Hat Ansible Engine 2.8 for RHEL 7",
			"release_date": "2019-11-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3926",
			"cpe": "cpe:/a:redhat:ansible_engine:2.8::el8",
			"impact": "moderate",
			"package": "ansible-0:2.8.7-1.el8ae",
			"product_name": "Red Hat Ansible Engine 2.8 for RHEL 8",
			"release_date": "2019-11-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3927",
			"cpe": "cpe:/a:redhat:ansible_engine:2.9::el7",
			"impact": "moderate",
			"package": "ansible-0:2.9.1-1.el7",
			"product_name": "Red Hat Ansible Engine 2.9 for RHEL 7",
			"release_date": "2019-11-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3927",
			"cpe": "cpe:/a:redhat:ansible_engine:2.9::el8",
			"impact": "moderate",
			"package": "ansible-0:2.9.1-1.el8",
			"product_name": "Red Hat Ansible Engine 2.9 for RHEL 8",
			"release_date": "2019-11-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3928",
			"cpe": "cpe:/a:redhat:ansible_engine:2::el7",
			"impact": "moderate",
			"package": "ansible-0:2.9.1-1.el7",
			"product_name": "Red Hat Ansible Engine 2 for RHEL 7",
			"release_date": "2019-11-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2019:3928",
			"cpe": "cpe:/a:redhat:ansible_engine:2::el8",
			"impact": "moderate",
			"package": "ansible-0:2.9.1-1.el8",
			"product_name": "Red Hat Ansible Engine 2 for RHEL 8",
			"release_date": "2019-11-20T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:cloudforms_managementengine:5",
			"fix_state": "Not affected",
			"package_name": "ansible",
			"product_name": "CloudForms Management Engine 5"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_tower:3",
			"fix_state": "Not affected",
			"impact": "moderate",
			"package_name": "ansible",
			"product_name": "Red Hat Ansible Tower 3"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:2",
			"fix_state": "Out of support scope",
			"package_name": "ansible",
			"product_name": "Red Hat Ceph Storage 2"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:3",
			"fix_state": "Will not fix",
			"package_name": "ansible",
			"product_name": "Red Hat Ceph Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:10",
			"fix_state": "Will not fix",
			"package_name": "ansible",
			"product_name": "Red Hat OpenStack Platform 10 (Newton)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:13",
			"fix_state": "Will not fix",
			"package_name": "ansible",
			"product_name": "Red Hat OpenStack Platform 13 (Queens)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:14",
			"fix_state": "Will not fix",
			"package_name": "ansible",
			"product_name": "Red Hat OpenStack Platform 14 (Rocky)"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Out of support scope",
			"package_name": "ansible",
			"product_name": "Red Hat Satellite 6"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Will not fix",
			"package_name": "ansible",
			"product_name": "Red Hat Storage 3"
		}
	],
	"upstream_fix": "ansible-engine 2.9.1, ansible-engine 2.8.7, ansible-engine 2.7.15",
	"csaw": false
}
