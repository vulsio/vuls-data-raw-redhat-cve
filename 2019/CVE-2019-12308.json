{
	"name": "CVE-2019-12308",
	"threat_severity": "Moderate",
	"public_date": "2019-06-03T00:00:00Z",
	"bugzilla": {
		"description": "django: missing URL validation by AdminURLFieldWidget leads to generation of clickable unsafe JavaScript link causing cross site scripting",
		"id": "1715915",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1715915"
	},
	"cvss3": {
		"cvss3_base_score": "4.7",
		"cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N",
		"status": "draft"
	},
	"cwe": "CWE-79",
	"details": [
		"An issue was discovered in Django 1.11 before 1.11.21, 2.1 before 2.1.9, and 2.2 before 2.2.2. The clickable Current URL value displayed by the AdminURLFieldWidget displays the provided value without validating it as a safe URL. Thus, an unvalidated value stored in the database, or a value provided as a URL query parameter payload, could result in an clickable JavaScript link.",
		"A validation flaw was found in Django's AdminURLFieldWidget. The clickable Current URL link generated by AdminURLFieldWidget displayed the provided value without validating it as a safe URL. An unvalidated value stored in the database, or a value provided as a URL query parameter payload, could result in a clickable JavaScript link."
	],
	"statement": "* This issue affects the version of python-django as shipped with Red Hat Gluster Storage 3 as it contains the vulnerable code.\n* This issue does not affect Red Hat Satellite 6, versions 6.3, 6.4 and 6.5, because its django component only returns content-type as JSON, which does not lead to cross site scripting.\n* This issue does not affect Red Hat Update Infrastructure 3 because it does not use any of the Widgets provided by python-django, including AdminURLFieldWidget.\n* This issue does not affect redhat-certification because it does not use AdminURLFieldWidget from python-django package.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2019-12308\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-12308\nhttps://docs.djangoproject.com/en/2.1/releases/2.1.9/\nhttps://docs.djangoproject.com/en/2.2/releases/1.11.21/\nhttps://docs.djangoproject.com/en/2.2/releases/2.2.2/"
	],
	"acknowledgement": "Red Hat would like to thank the Django project for reporting this issue.",
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:ceph_storage:2",
			"fix_state": "Not affected",
			"package_name": "python-django",
			"product_name": "Red Hat Ceph Storage 2"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:3",
			"fix_state": "Not affected",
			"package_name": "python-django",
			"product_name": "Red Hat Ceph Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:certifications:1::el7",
			"fix_state": "Not affected",
			"package_name": "python-django",
			"product_name": "Red Hat Certification for Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:7",
			"fix_state": "Not affected",
			"package_name": "python-django",
			"product_name": "Red Hat Enterprise Linux OpenStack Platform 7 (Kilo)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack-optools:7",
			"fix_state": "Not affected",
			"package_name": "python-django",
			"product_name": "Red Hat Enterprise Linux OpenStack Platform 7 (Kilo) Operational Tools"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:10",
			"fix_state": "Not affected",
			"package_name": "python-django",
			"product_name": "Red Hat OpenStack Platform 10 (Newton)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:13",
			"fix_state": "Will not fix",
			"package_name": "python-django",
			"product_name": "Red Hat OpenStack Platform 13 (Queens)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:14",
			"fix_state": "Affected",
			"package_name": "python-django",
			"product_name": "Red Hat OpenStack Platform 14 (Rocky)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:15",
			"fix_state": "Not affected",
			"package_name": "python-django",
			"product_name": "Red Hat OpenStack Platform 15 (Stein)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:8",
			"fix_state": "Not affected",
			"package_name": "python-django",
			"product_name": "Red Hat OpenStack Platform 8 (Liberty)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack-optools:8",
			"fix_state": "Not affected",
			"package_name": "python-django",
			"product_name": "Red Hat OpenStack Platform 8 (Liberty) Operational Tools"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:9",
			"fix_state": "Not affected",
			"package_name": "python-django",
			"product_name": "Red Hat OpenStack Platform 9 (Mitaka)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack-optools:9",
			"fix_state": "Not affected",
			"package_name": "python-django",
			"product_name": "Red Hat OpenStack Platform 9 (Mitaka) Operational Tools"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Not affected",
			"package_name": "python-django",
			"product_name": "Red Hat Satellite 6"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Will not fix",
			"package_name": "python-django",
			"product_name": "Red Hat Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:rhui:3",
			"fix_state": "Not affected",
			"package_name": "python-django",
			"product_name": "Red Hat Update Infrastructure 3 for Cloud Providers"
		}
	],
	"upstream_fix": "Django 2.1.9, Django 2.2.2, Django 1.11.21",
	"csaw": false
}
