{
	"name": "CVE-2019-19377",
	"threat_severity": "Moderate",
	"public_date": "2019-11-28T00:00:00Z",
	"bugzilla": {
		"description": "use-after-free in btrfs_queue_work in fs/btrfs/async-thread.c",
		"id": "1781894",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1781894"
	},
	"cvss3": {
		"cvss3_base_score": "7.8",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
		"status": "draft"
	},
	"cwe": "CWE-416",
	"details": [
		"In the Linux kernel 5.0.21, mounting a crafted btrfs filesystem image, performing some operations, and unmounting can lead to a use-after-free in btrfs_queue_work in fs/btrfs/async-thread.c.",
		"A flaw was found in the Linux kernel's implementation of the BTRFS file system. A local attacker, with the ability to mount a file system, can create a use-after-free memory fault after the file system has been unmounted. This may lead to memory corruption or privilege escalation."
	],
	"statement": "This flaw is rated as moderate, the attacker would need to have physical access or permission to mount/write to a filesystem to abuse this.  If they can write to a block device they can already do other evil things, like make a setuid binary etc.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2019-19377\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-19377"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "As the btrfs module will be auto-loaded when required, its use can be disabled by preventing the module from loading with the following instructions:\n# echo \"install btrfs /bin/true\" >> /etc/modprobe.d/disable-btrfs.conf \nThe system will need to be restarted if the BTRFS modules are loaded. In most circumstances, the CIFS kernel modules will be unable to be unloaded while any network interfaces are active and the protocol is in use.\nIf the system requires this module to work correctly (as a filesytem required to run), this mitigation may not be suitable.\nIf you need further assistance, see KCS article https://access.redhat.com/solutions/41278 or contact Red Hat Global Support Services."
	},
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:5",
			"fix_state": "Out of support scope",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 5"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Will not fix",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Will not fix",
			"package_name": "kernel-alt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Will not fix",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/a:redhat:enterprise_mrg:2",
			"fix_state": "Will not fix",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise MRG 2"
		}
	],
	"csaw": false
}
