{
	"affected_release": [
		{
			"advisory": "RHSA-2021:1859",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"impact": "low",
			"package": "grafana-0:7.3.6-2.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2021-05-18T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:5633",
			"cpe": "cpe:/a:redhat:openshift:4.7::el8",
			"impact": "low",
			"package": "openshift4/ose-grafana:v4.7.0-202102130115.p0",
			"product_name": "Red Hat OpenShift Container Platform 4.7",
			"release_date": "2021-02-24T00:00:00Z"
		}
	],
	"bugzilla": {
		"description": "authentication bypass in saml authentication",
		"id": "1907670",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1907670"
	},
	"csaw": false,
	"cvss3": {
		"cvss3_base_score": "9.8",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-115",
	"details": [
		"A signature verification vulnerability exists in crewjam/saml. This flaw allows an attacker to bypass SAML Authentication. The highest threat from this vulnerability is to confidentiality, integrity, as well as system availability.",
		"A signature verification vulnerability exists in crewjam/saml. This flaw allows an attacker to bypass SAML Authentication. The highest threat from this vulnerability is to confidentiality, integrity, as well as system availability."
	],
	"name": "CVE-2020-27846",
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:service_mesh:1",
			"fix_state": "Out of support scope",
			"impact": "low",
			"package_name": "servicemesh-grafana",
			"product_name": "OpenShift Service Mesh 1"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:2.0",
			"fix_state": "Will not fix",
			"package_name": "servicemesh-grafana",
			"product_name": "OpenShift Service Mesh 2.0"
		},
		{
			"cpe": "cpe:/a:redhat:red_hat_3scale_amp:2",
			"fix_state": "Not affected",
			"package_name": "3scale-operator-container",
			"product_name": "Red Hat 3scale API Management Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:2",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Ceph Storage 2"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:3",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Ceph Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:4",
			"fix_state": "Not affected",
			"package_name": "rhceph/rhceph-4-dashboard-rhel8",
			"product_name": "Red Hat Ceph Storage 4"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "openshift3/grafana",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Storage 3"
		}
	],
	"public_date": "2020-12-17T13:00:00Z",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2020-27846\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-27846\nhttps://github.com/crewjam/saml/security/advisories/GHSA-4hq8-gmxx-h6w9\nhttps://grafana.com/blog/2020/12/17/grafana-6.7.5-7.2.3-and-7.3.6-released-with-important-security-fix-for-grafana-enterprise/\nhttps://mattermost.com/blog/coordinated-disclosure-go-xml-vulnerabilities/"
	],
	"statement": "Grafana in the OpenShift Container Platform (OCP) and OpenShift ServiceMesh) uses oauth-proxy as an Auth Proxy, and therefore does not make use of the vulnerable SAML Authentication in the github.com/crewjam/saml module used by Grafana. Additionally, SAML is only available in the enterprise version of grafana, but as the code is still packaged, it has been marked Low impact.\nRed Hat Gluster Storage 3, Red Hat Ceph Storage 2, 3 and 4 ships old versions of grafana where ‘crewjam/saml’ module is not included. Therefore these products are not affected by this vulnerability.\ngrafana as shipped with Red Hat Enterprise Linux 8 packages a vulnerable version of crewjam/saml but does not use it, as SAML is only available for the Enterprise version of grafana. For this reason, this flaw has been marked Low impact.",
	"threat_severity": "Critical",
	"upstream_fix": "grafana 7.2.3, grafana 7.3.6, grafana 6.7.5, github.com/crewjam/saml 0.4.3"
}
