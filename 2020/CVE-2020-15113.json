{
	"name": "CVE-2020-15113",
	"threat_severity": "Moderate",
	"public_date": "2020-08-05T00:00:00Z",
	"bugzilla": {
		"description": "CVE-2020-15113 etcd: directories created via os.MkdirAll are not checked for permissions",
		"id": "1868870",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1868870"
	},
	"cvss3": {
		"cvss3_base_score": "7.1",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
		"status": "verified"
	},
	"cwe": "CWE-285",
	"details": [
		"In etcd before versions 3.3.23 and 3.4.10, certain directory paths are created (etcd data directory and the directory path when provided to automatically generate self-signed certificates for TLS connections with clients) with restricted access permissions (700) by using the os.MkdirAll. This function does not perform any permission checks when a given directory path exists already. A possible workaround is to ensure the directories have the desired permission (700).",
		"A flaw was found in etcd. Certain directory paths are created with restricted access permissions (700) by using the os.MkdirAll. This function does not perform any permission checks when a given directory path exists already."
	],
	"statement": "In Red Hat OpenShift Container Platform (RHOCP) the affected components are behind OpenShift OAuth authentication. This restricts access to the vulnerable etcd to authenticated users only, therefore the impact by this vulnerability is Low.\nA similar access restriction is in place in Red Hat OpenStack Platform (RHOSP) as etcd is limited to use within the internal API network, which is not accessible to any OpenStack tenants.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2020-15113\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-15113\nhttps://github.com/etcd-io/etcd/security/advisories/GHSA-chh6-ppwq-jh92"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2021:2438",
			"cpe": "cpe:/a:redhat:openshift:4.8::el8",
			"impact": "low",
			"package": "openshift4/ose-etcd:v4.8.0-202106152230.p0.git.aefa6bf.assembly.stream",
			"product_name": "Red Hat OpenShift Container Platform 4.8",
			"release_date": "2021-07-27T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:0916",
			"cpe": "cpe:/a:redhat:openstack:16.1::el8",
			"package": "etcd-0:3.3.23-1.el8ost",
			"product_name": "Red Hat OpenStack Platform 16.1",
			"release_date": "2021-03-17T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "etcd",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Will not fix",
			"package_name": "etcd",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:15",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "etcd",
			"product_name": "Red Hat OpenStack Platform 15 (Stein)"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Will not fix",
			"package_name": "etcd",
			"product_name": "Red Hat Storage 3"
		}
	],
	"upstream_fix": "etcd 3.4.10, etcd 3.3.23",
	"csaw": false
}
