{
	"name": "CVE-2020-28493",
	"threat_severity": "Moderate",
	"public_date": "2021-02-01T00:00:00Z",
	"bugzilla": {
		"description": "ReDoS vulnerability in the urlize filter",
		"id": "1928707",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1928707"
	},
	"cvss3": {
		"cvss3_base_score": "7.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
		"status": "verified"
	},
	"cwe": "CWE-20->CWE-400",
	"details": [
		"This affects the package jinja2 from 0.0.0 and before 2.11.3. The ReDoS vulnerability is mainly due to the `_punctuation_re regex` operator and its use of multiple wildcards. The last wildcard is the most exploitable as it searches for trailing punctuation. This issue can be mitigated by Markdown to format user content instead of the urlize filter, or by implementing request timeouts and limiting process memory.",
		"A flaw was found in python-jinja2. The ReDOS vulnerability of the regex is mainly due to the sub-pattern [a-zA-Z0-9._-]+.[a-zA-Z0-9._-]+. This issue can be mitigated by Markdown to format user content instead of the urlize filter, or by implementing request timeouts and limiting process memory."
	],
	"statement": "This flaw is out of support scope for the following products:\n* Red Hat Enterprise Linux 6\n* Red Hat Enterprise Linux 7\n* Red Hat Ceph Storage 2\nTo learn more about Red Hat Enterprise Linux support scopes, please see https://access.redhat.com/support/policy/updates/errata/\nIn Red Hat OpenStack Platform, because python-jinja2 is not directly customer exposed, the Impact has been moved to Low and no updated will be provided at this time for the RHOSP python-jinja2 package.\nRed Hat Quay does not make use of the vulnerable function, so the impact is Low.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2020-28493\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-28493"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "If using the jinja2 library as a developer, this flaw can be mitigated by not using the vulnerable urlize() filter, and instead, using Markdown to format user content."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2021:4151",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "python27:2.7-8050020210811095446.3e7ace8b",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2021-11-09T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:4161",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "python-jinja2-0:2.10.1-3.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2021-11-09T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:4162",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "python38:3.8-8050020210811101222.e3d35cca",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2021-11-09T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:4162",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "python38-devel:3.8-8050020210811101222.e3d35cca",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2021-11-09T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3252",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "python27-babel-0:0.9.6-10.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3252",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "python27-python-0:2.7.18-3.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3252",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "python27-python-jinja2-0:2.6-16.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3252",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "python27-python-pygments-0:1.5-5.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3254",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python38-babel-0:2.7.0-12.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3254",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python38-python-0:3.8.11-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3254",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python38-python-cryptography-0:2.8-5.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3254",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python38-python-jinja2-0:2.10.3-6.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3254",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python38-python-lxml-0:4.4.1-7.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3254",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python38-python-pip-0:19.3.1-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3254",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python38-python-urllib3-0:1.25.7-7.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3252",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "python27-babel-0:0.9.6-10.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3252",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "python27-python-0:2.7.18-3.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3252",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "python27-python-jinja2-0:2.6-16.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3252",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "python27-python-pygments-0:1.5-5.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3254",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python38-babel-0:2.7.0-12.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3254",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python38-python-0:3.8.11-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3254",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python38-python-cryptography-0:2.8-5.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3254",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python38-python-jinja2-0:2.10.3-6.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3254",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python38-python-lxml-0:4.4.1-7.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3254",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python38-python-pip-0:19.3.1-2.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2021-08-24T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3254",
			"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7",
			"package": "rh-python38-python-urllib3-0:1.25.7-7.el7",
			"product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
			"release_date": "2021-08-24T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform",
			"fix_state": "Not affected",
			"package_name": "jinja2",
			"product_name": "Red Hat Ansible Automation Platform 1.2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform",
			"fix_state": "Not affected",
			"package_name": "python-jinja2",
			"product_name": "Red Hat Ansible Automation Platform 1.2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_tower:3",
			"fix_state": "Not affected",
			"package_name": "jinja2",
			"product_name": "Red Hat Ansible Tower 3"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:2",
			"fix_state": "Out of support scope",
			"package_name": "python-jinja2",
			"product_name": "Red Hat Ceph Storage 2"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:3",
			"fix_state": "Will not fix",
			"package_name": "python-jinja2",
			"product_name": "Red Hat Ceph Storage 3"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "python-jinja2",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "python-jinja2",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "python-jinja2",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:13",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "python-jinja2",
			"product_name": "Red Hat OpenStack Platform 13 (Queens)"
		},
		{
			"cpe": "cpe:/a:redhat:quay:3",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "quay/quay-rhel8",
			"product_name": "Red Hat Quay 3"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Affected",
			"package_name": "python-jinja2",
			"product_name": "Red Hat Satellite 6"
		}
	],
	"upstream_fix": "jinja2 2.11.3",
	"csaw": false
}
