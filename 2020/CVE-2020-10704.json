{
	"acknowledgement": "Red Hat would like to thank the Samba project for reporting this issue.",
	"bugzilla": {
		"description": "LDAP Denial of Service (stack overflow) in Samba AD DC",
		"id": "1825734",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1825734"
	},
	"csaw": false,
	"cvss3": {
		"cvss3_base_score": "7.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
		"status": "draft"
	},
	"cwe": "CWE-674",
	"details": [
		"A flaw was found when using samba as an Active Directory Domain Controller. Due to the way samba handles certain requests as an Active Directory Domain Controller LDAP server, an unauthorized user can cause a stack overflow leading to a denial of service. The highest threat from this vulnerability is to system availability. This issue affects all samba versions before 4.10.15, before 4.11.8 and before 4.12.2.",
		"A flaw was found when using samba as an Active Directory Domain Controller. Due to the way samba handles certain requests as an Active Directory Domain Controller LDAP server, an unauthorized user can cause a stack overflow leading to a denial of service. The highest threat from this vulnerability is to system availability."
	],
	"mitigation": {
		"lang": "en:us",
		"value": "By default, Samba 4.10 is run using the \"standard\" process model, which would leave only the CLDAP server affected.  (Later versions use 'prefork').\nThis is controlled by the -M or --model parameter to the samba binary.\nAll Samba versions are impacted if -M prefork or -M single is used. To mitigate this issue for LDAP only, select -M standard (however this will use more memory, may allow resource exhaustion, and will still leave the CLDAP server exposed)."
	},
	"name": "CVE-2020-10704",
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:5",
			"fix_state": "Not affected",
			"package_name": "samba",
			"product_name": "Red Hat Enterprise Linux 5"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:5",
			"fix_state": "Not affected",
			"package_name": "samba3x",
			"product_name": "Red Hat Enterprise Linux 5"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "samba",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "samba4",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "samba",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "samba",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Not affected",
			"package_name": "samba",
			"product_name": "Red Hat Storage 3"
		}
	],
	"public_date": "2020-04-28T00:00:00Z",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2020-10704\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-10704\nhttps://www.samba.org/samba/security/CVE-2020-10704.html"
	],
	"statement": "This flaw does not affect the version of samba shipped with Red Hat Enterprise Linux as there is no support for samba as an Active Directory Domain Controller (AD DC). Similarly, the version of samba shipped with Red Hat Gluster Storage 3 is also not supported for use as an AD DC and, thus, is not affected by this vulnerability.",
	"threat_severity": "Important",
	"upstream_fix": "samba 4.10.15, samba 4.11.8, samba 4.12.2"
}
