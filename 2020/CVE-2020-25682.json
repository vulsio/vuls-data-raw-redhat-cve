{
	"name": "CVE-2020-25682",
	"threat_severity": "Important",
	"public_date": "2021-01-19T00:00:00Z",
	"bugzilla": {
		"description": "CVE-2020-25682 dnsmasq: buffer overflow in extract_name() due to missing length check when DNSSEC is enabled",
		"id": "1882014",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1882014"
	},
	"cvss3": {
		"cvss3_base_score": "8.1",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-122",
	"details": [
		"A flaw was found in dnsmasq before 2.83. A buffer overflow vulnerability was discovered in the way dnsmasq extract names from DNS packets before validating them with DNSSEC data. An attacker on the network, who can create valid DNS replies, could use this flaw to cause an overflow with arbitrary data in a heap-allocated memory, possibly executing code on the machine. The flaw is in the rfc1035.c:extract_name() function, which writes data to the memory pointed by name assuming MAXDNAME*2 bytes are available in the buffer. However, in some code execution paths, it is possible extract_name() gets passed an offset from the base buffer, thus reducing, in practice, the number of available bytes that can be written in the buffer. The highest threat from this vulnerability is to data confidentiality and integrity as well as system availability.",
		"A flaw was found in dnsmasq. A buffer overflow vulnerability was discovered in the way dnsmasq extract names from DNS packets before validating them with DNSSEC data. An attacker on the network, who can create valid DNS replies, could use this flaw to cause an overflow with arbitrary data in a heap-allocated memory, possibly executing code on the machine. The flaw is in the rfc1035.c:extract_name() function, which writes data to the memory pointed by name assuming MAXDNAME*2 bytes are available in the buffer. However, in some code execution paths, it is possible extract_name() gets passed an offset from the base buffer, thus reducing, in practice, the number of available bytes that can be written in the buffer. The highest threat from this vulnerability is to data confidentiality and integrity as well as system availability."
	],
	"statement": "This issue does not affect the versions of dnsmasq as shipped with Red Hat Enterprise Linux 5, 6, and 7 as they are not compiled with DNSSEC support.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2020-25682\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-25682\nhttps://www.jsof-tech.com/disclosures/dnspooq/"
	],
	"acknowledgement": "Red Hat would like to thank Moshe Kol (JSOF) and Shlomi Oberman (JSOF) for reporting this issue.",
	"mitigation": {
		"lang": "en:us",
		"value": "The only known way to mitigate this flaw is to disable DNSSEC altogether, by removing the `--dnssec` command line option or the `dnssec` option from dnsmasq configuration file."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2021:0150",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "dnsmasq-0:2.79-13.el8_3.1",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2021-01-19T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:0152",
			"cpe": "cpe:/a:redhat:rhel_eus:8.1",
			"package": "dnsmasq-0:2.79-6.el8_1.1",
			"product_name": "Red Hat Enterprise Linux 8.1 Extended Update Support",
			"release_date": "2021-01-19T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:0151",
			"cpe": "cpe:/a:redhat:rhel_eus:8.2",
			"package": "dnsmasq-0:2.79-11.el8_2.2",
			"product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
			"release_date": "2021-01-19T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:5",
			"fix_state": "Not affected",
			"package_name": "dnsmasq",
			"product_name": "Red Hat Enterprise Linux 5"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "dnsmasq",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "dnsmasq",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "dnsmasq",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:10",
			"fix_state": "Not affected",
			"package_name": "dnsmasq",
			"product_name": "Red Hat OpenStack Platform 10 (Newton)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:13",
			"fix_state": "Not affected",
			"package_name": "dnsmasq",
			"product_name": "Red Hat OpenStack Platform 13 (Queens)"
		}
	],
	"upstream_fix": "dnsmasq 2.83",
	"csaw": false
}
