{
	"name": "CVE-2020-16844",
	"threat_severity": "Moderate",
	"public_date": "2020-08-11T19:00:00Z",
	"bugzilla": {
		"description": "CVE-2020-16844 istio: incorrect translation of DENY policy for TCP service",
		"id": "1861625",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1861625"
	},
	"cvss3": {
		"cvss3_base_score": "6.8",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N",
		"status": "verified"
	},
	"cwe": "CWE-284",
	"details": [
		"In Istio 1.5.0 though 1.5.8 and Istio 1.6.0 through 1.6.7, when users specify an AuthorizationPolicy resource with DENY actions using wildcard suffixes (e.g. *-some-suffix) for source principals or namespace fields, callers will never be denied access, bypassing the intended policy.",
		"An insecure access control vulnerability was found in Istio. If an authorization policy is created for a TCP service that includes a DENY rule with a prefix wildcard, Istio translates this into an Envoy string match, incorrectly removing the wildcard. This flaw allows an attacker to subvert particular DENY rules, potentially gaining access to restricted resources."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2020-16844\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-16844\nhttps://istio.io/latest/news/security/istio-security-2020-009/"
	],
	"acknowledgement": "Red Hat would like to thank the Envoy Security Team for reporting this issue.",
	"mitigation": {
		"lang": "en:us",
		"value": "In regards to an AuthorizationPolicy for a TCP service, if using a DENY rule in the source principal (or namespace field) such as:\napiVersion: security.istio.io/v1beta1\nkind: AuthorizationPolicy\n...\nspec: \naction: DENY\nrules:\n- from:\n- source:\nprincipals:\n- */ns/servicemesh\nConsider using an exact or suffix match instead such as:\n- /foo/bar/ns/servicemesh"
	},
	"affected_release": [
		{
			"advisory": "RHSA-2020:3425",
			"cpe": "cpe:/a:redhat:service_mesh:1.1::el8",
			"package": "servicemesh-0:1.1.7-1.el8",
			"product_name": "OpenShift Service Mesh 1.1",
			"release_date": "2020-08-11T00:00:00Z"
		}
	],
	"upstream_fix": "istio 1.6.8, istio 1.5.9",
	"csaw": false
}
