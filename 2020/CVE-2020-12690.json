{
	"name": "CVE-2020-12690",
	"threat_severity": "Important",
	"public_date": "2020-05-06T15:00:00Z",
	"bugzilla": {
		"description": "openstack-keystone: OAuth1 request token authorize silently ignores roles parameter",
		"id": "1830395",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1830395"
	},
	"cvss3": {
		"cvss3_base_score": "8.8",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-863",
	"details": [
		"An issue was discovered in OpenStack Keystone before 15.0.1, and 16.0.0. The list of roles provided for an OAuth1 access token is silently ignored. Thus, when an access token is used to request a keystone token, the keystone token contains every role assignment the creator had for the project. This results in the provided keystone token having more role assignments than the creator intended, possibly giving unintended escalated access.",
		"A flaw was found in Keystone, where it inadvertently provided OAuth1 access tokens to every role assignment the creator had for a project, resulting in giving more permissions and escalated access in role assignments than intended. The greatest impact is on confidentiality."
	],
	"statement": "Red Hat Quay includes keystone-client, which is not vulnerable to this (server-side) vulnerability.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2020-12690\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-12690\nhttps://security.openstack.org/ossa/OSSA-2020-005.html"
	],
	"acknowledgement": "Red Hat would like to thank kay (OpenStack) for reporting this issue.",
	"affected_release": [
		{
			"advisory": "RHSA-2020:3102",
			"cpe": "cpe:/a:redhat:openstack:15::el8",
			"package": "openstack-keystone-1:15.0.1-0.20200512110437.95b2bbe.el8ost",
			"product_name": "Red Hat OpenStack Platform 15.0 (Stein)",
			"release_date": "2020-07-22T00:00:00Z"
		},
		{
			"advisory": "RHSA-2020:3105",
			"cpe": "cpe:/a:redhat:openstack:16::el8",
			"package": "openstack-keystone-1:16.0.1-0.20200511063421.40cbb7b.el8ost",
			"product_name": "Red Hat OpenStack Platform 16.0 (Train)",
			"release_date": "2020-07-22T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:openstack:7",
			"fix_state": "Out of support scope",
			"package_name": "openstack-keystone",
			"product_name": "Red Hat Enterprise Linux OpenStack Platform 7 (Kilo)"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:6",
			"fix_state": "Not affected",
			"package_name": "openstack-keystone",
			"product_name": "Red Hat JBoss Fuse 6"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:10",
			"fix_state": "Affected",
			"package_name": "openstack-keystone",
			"product_name": "Red Hat OpenStack Platform 10 (Newton)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:13",
			"fix_state": "Affected",
			"package_name": "openstack-keystone",
			"product_name": "Red Hat OpenStack Platform 13 (Queens)"
		},
		{
			"cpe": "cpe:/a:redhat:quay:3",
			"fix_state": "Not affected",
			"package_name": "quay/quay-rhel8",
			"product_name": "Red Hat Quay 3"
		}
	],
	"upstream_fix": "Keystone 15.0.1, Keystone 16.0.1",
	"csaw": false
}
