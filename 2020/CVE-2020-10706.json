{
	"name": "CVE-2020-10706",
	"threat_severity": "Moderate",
	"public_date": "2020-04-30T00:00:00Z",
	"bugzilla": {
		"description": "openshift/openshift-apiserver: oauth tokens not encrypted when enabling encryption of data at rest",
		"id": "1819011",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1819011"
	},
	"cvss3": {
		"cvss3_base_score": "6.3",
		"cvss3_scoring_vector": "CVSS:3.1/AV:P/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-312",
	"details": [
		"A flaw was found in OpenShift Container Platform where OAuth tokens are not encrypted when the encryption of data at rest is enabled. This flaw allows an attacker with access to a backup to obtain OAuth tokens and then use them to log into the cluster as any user who logged into the cluster via the WebUI or via the command line in the last 24 hours. Once the backup is older than 24 hours the OAuth tokens are no longer valid.",
		"A flaw was found in OpenShift Container Platform where OAuth tokens are not encrypted when the encryption of data at rest is enabled. This flaw allows an attacker with access to a backup to obtain OAuth tokens and then use them to log into the cluster as any user who logged into the cluster via the WebUI or via the command line in the last 24 hours. Once the backup is older than 24 hours the OAuth tokens are no longer valid."
	],
	"statement": "This issue only affects OpenShift Container Platform when the 'encryption at rest' feature enabled, see https://access.redhat.com/documentation/en-us/openshift_container_platform/4.3/html/authentication/encrypting-etcd. When backing up the encrypted data the keys should be stored separately to the data, making backups the most likely target of this attack.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2020-10706\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-10706"
	],
	"acknowledgement": "This issue was discovered by Stefan Schimanski (Red Hat).",
	"mitigation": {
		"lang": "en:us",
		"value": "If you have made a vulnerable backup public you can revoke leaked OAuth tokens by deleting them with the OpenShift API."
	},
	"affected_release": [
		{
			"advisory": "RHBA-2020:4196",
			"cpe": "cpe:/a:redhat:openshift:4.6::el8",
			"package": "openshift4/ose-oauth-server-rhel8:v4.6.0-202010061132.p0",
			"product_name": "Red Hat OpenShift Container Platform 4.6",
			"release_date": "2020-10-27T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Will not fix",
			"package_name": "atomic-openshift",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		}
	],
	"csaw": false
}
