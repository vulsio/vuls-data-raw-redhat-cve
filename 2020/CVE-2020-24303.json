{
	"name": "CVE-2020-24303",
	"threat_severity": "Moderate",
	"public_date": "2020-06-08T00:00:00Z",
	"bugzilla": {
		"description": "grafana: XSS via a query alias for the Elasticsearch and Testdata datasource",
		"id": "1892418",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1892418"
	},
	"cvss3": {
		"cvss3_base_score": "6.1",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
		"status": "verified"
	},
	"cwe": "CWE-79",
	"details": [
		"Grafana before 7.1.0-beta 1 allows XSS via a query alias for the ElasticSearch datasource.",
		"A flaw was found in grafana. A XSS via a query alias for the ElasticSearch datasource is allowed."
	],
	"statement": "A vulnerable version of Grafana is shipped in OpenShift 3.11 - 4.5 and OpenShift ServiceMesh, however Prometheus is used as a data source and modification to Elasticsearch or Testdata requires full control of the grafana component. Access is restricted to authenticated users only by OpenShift OAuth. As OpenShift and OpenShift ServiceMesh still packages the vulnerable code, the components are affected but with impact Low. OpenShift 4.6 uses version 7.2.0 of Grafana in openshift4/ose-grafana-container and is not affected.\nRed Hat Ceph Storage 3 and 4 ship a vulnerable version of grafana, however, Prometheus is used as the data source., and thus the impact is rated as low. \nRed Hat Gluster Storage 3 ships vulnerable version of grafana, however Graphite is the only supported data source and hence this issue has been rated as having a security impact of Low.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2020-24303\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-24303\nhttps://github.com/grafana/grafana/pull/25401"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2021:1859",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "grafana-0:7.3.6-2.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2021-05-18T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:service_mesh:1",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "servicemesh-grafana",
			"product_name": "OpenShift Service Mesh 1"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:2.0",
			"fix_state": "Will not fix",
			"package_name": "servicemesh-grafana",
			"product_name": "OpenShift Service Mesh 2.0"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:2",
			"fix_state": "Out of support scope",
			"package_name": "grafana",
			"product_name": "Red Hat Ceph Storage 2"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:3",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "grafana",
			"product_name": "Red Hat Ceph Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:4",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "rhceph/rhceph-4-dashboard-rhel8",
			"product_name": "Red Hat Ceph Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "openshift3/grafana",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "openshift4/ose-grafana",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "grafana",
			"product_name": "Red Hat Storage 3"
		}
	],
	"upstream_fix": "grafana 7.1.0",
	"csaw": false
}
