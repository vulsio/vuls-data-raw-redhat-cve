{
	"name": "CVE-2015-4020",
	"threat_severity": "Important",
	"public_date": "2015-05-18T00:00:00Z",
	"bugzilla": {
		"description": "rubygems: incomplete fix for CVE-2015-3900",
		"id": "1250109",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1250109"
	},
	"cvss": {
		"cvss_base_score": "7.9",
		"cvss_scoring_vector": "AV:A/AC:M/Au:N/C:C/I:C/A:C",
		"status": "draft"
	},
	"cwe": "CWE-20->CWE-345",
	"details": [
		"RubyGems 2.0.x before 2.0.17, 2.2.x before 2.2.5, and 2.4.x before 2.4.8 does not validate the hostname when fetching gems or making API requests, which allows remote attackers to redirect requests to arbitrary domains via a crafted DNS SRV record with a domain that is suffixed with the original domain name, aka a \"DNS hijack attack.\" NOTE: this vulnerability exists because to an incomplete fix for CVE-2015-3900.",
		"A flaw was found in a way rubygems verified the API endpoint hostname retrieved through a DNS SRV record. A man-in-the-middle attacker could use this flaw to force a client to download content from an untrusted domain."
	],
	"statement": "This issue did not affect the versions of rubygems as shipped with Red Hat Enterprise Linux 6, Red Hat Enterprise MRG 2.5, Red Hat Satellite 6, Red Hat Openstack 5, Red Hat Openshift Enterprise 2, as the packages did not include the incomplete fix.\nThis issue did not affect the versions of ruby as shipped with Red Hat Enterprise Linux 5, 6 and 7, Red Hat Subscription Asset Manager and Red Hat Software Collections, as the packages did not include the incomplete fix.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2015-4020\nhttps://nvd.nist.gov/vuln/detail/CVE-2015-4020"
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:cloudforms_managementengine:5",
			"fix_state": "Not affected",
			"package_name": "rubygems",
			"product_name": "CloudForms Management Engine 5"
		},
		{
			"cpe": "cpe:/a:redhat:openstack-installer:5",
			"fix_state": "Not affected",
			"package_name": "rubygems",
			"product_name": "OpenStack Foreman"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:5",
			"fix_state": "Not affected",
			"package_name": "ruby",
			"product_name": "Red Hat Enterprise Linux 5"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "ruby",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "rubygems",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "ruby",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:5::el6",
			"fix_state": "Not affected",
			"package_name": "rubygems",
			"product_name": "Red Hat Enterprise Linux OpenStack Platform 5 (Icehouse)"
		},
		{
			"cpe": "cpe:/a:redhat:enterprise_mrg:2",
			"fix_state": "Not affected",
			"package_name": "rubygems",
			"product_name": "Red Hat Enterprise MRG 2"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:2",
			"fix_state": "Not affected",
			"package_name": "rubygems",
			"product_name": "Red Hat OpenShift Enterprise 2"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Not affected",
			"package_name": "rubygems",
			"product_name": "Red Hat Satellite 6"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:2",
			"fix_state": "Not affected",
			"package_name": "rh-ruby22-ruby",
			"product_name": "Red Hat Software Collections"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:2",
			"fix_state": "Not affected",
			"package_name": "ruby193-ruby",
			"product_name": "Red Hat Software Collections"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:2",
			"fix_state": "Not affected",
			"package_name": "ruby200-ruby",
			"product_name": "Red Hat Software Collections"
		},
		{
			"cpe": "cpe:/a:rhel_sam:1",
			"fix_state": "Not affected",
			"package_name": "ruby193-ruby",
			"product_name": "Red Hat Subscription Asset Manager"
		}
	],
	"upstream_fix": "rubygems 2.0.17, rubygems 2.2.5, rubygems 2.4.8",
	"csaw": false
}
