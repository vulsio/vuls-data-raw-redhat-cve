{
	"name": "CVE-2021-47515",
	"threat_severity": "Moderate",
	"public_date": "2024-05-24T00:00:00Z",
	"bugzilla": {
		"description": "kernel: seg6: fix the iif in the IPv6 socket control block",
		"id": "2283436",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2283436"
	},
	"cvss3": {
		"cvss3_base_score": "5.3",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H",
		"status": "verified"
	},
	"cwe": "CWE-476",
	"details": [
		"In the Linux kernel, the following vulnerability has been resolved:\nseg6: fix the iif in the IPv6 socket control block\nWhen an IPv4 packet is received, the ip_rcv_core(...) sets the receiving\ninterface index into the IPv4 socket control block (v5.16-rc4,\nnet/ipv4/ip_input.c line 510):\nIPCB(skb)->iif = skb->skb_iif;\nIf that IPv4 packet is meant to be encapsulated in an outer IPv6+SRH\nheader, the seg6_do_srh_encap(...) performs the required encapsulation.\nIn this case, the seg6_do_srh_encap function clears the IPv6 socket control\nblock (v5.16-rc4 net/ipv6/seg6_iptunnel.c line 163):\nmemset(IP6CB(skb), 0, sizeof(*IP6CB(skb)));\nThe memset(...) was introduced in commit ef489749aae5 (\"ipv6: sr: clear\nIP6CB(skb) on SRH ip4ip6 encapsulation\") a long time ago (2019-01-29).\nSince the IPv6 socket control block and the IPv4 socket control block share\nthe same memory area (skb->cb), the receiving interface index info is lost\n(IP6CB(skb)->iif is set to zero).\nAs a side effect, that condition triggers a NULL pointer dereference if\ncommit 0857d6f8c759 (\"ipv6: When forwarding count rx stats on the orig\nnetdev\") is applied.\nTo fix that issue, we set the IP6CB(skb)->iif with the index of the\nreceiving interface once again."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-47515\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-47515\nhttps://lore.kernel.org/linux-cve-announce/2024052431-CVE-2021-47515-5c06@gregkh/T"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2023:6583",
			"cpe": "cpe:/a:redhat:enterprise_linux:9",
			"package": "kernel-0:5.14.0-362.8.1.el9_3",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2023-11-07T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:6583",
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"package": "kernel-0:5.14.0-362.8.1.el9_3",
			"product_name": "Red Hat Enterprise Linux 9",
			"release_date": "2023-11-07T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "kernel 4.14.258, kernel 4.19.221, kernel 5.4.165, kernel 5.10.85, kernel 5.15.8, kernel 5.16",
	"csaw": false
}
