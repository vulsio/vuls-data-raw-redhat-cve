{
	"bugzilla": {
		"description": "document and field level security was not applied to searchable snapshots",
		"id": "1990094",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1990094"
	},
	"csaw": false,
	"cvss3": {
		"cvss3_base_score": "5.7",
		"cvss3_scoring_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
		"status": "draft"
	},
	"cwe": "CWE-200",
	"details": [
		"Elasticsearch before 7.14.0 did not apply document and field level security to searchable snapshots. This could lead to an authenticated user gaining access to information that they are unauthorized to view."
	],
	"name": "CVE-2021-22147",
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:logging:5",
			"fix_state": "Not affected",
			"package_name": "openshift-logging/elasticsearch6-rhel8",
			"product_name": "Logging Subsystem for Red Hat OpenShift"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:1",
			"fix_state": "Not affected",
			"package_name": "servicemesh-grafana",
			"product_name": "OpenShift Service Mesh 1"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:2.0",
			"fix_state": "Not affected",
			"package_name": "servicemesh-grafana",
			"product_name": "OpenShift Service Mesh 2.0"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7",
			"fix_state": "Not affected",
			"package_name": "elasticsearch",
			"product_name": "Red Hat Decision Manager 7"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Not affected",
			"package_name": "elasticsearch",
			"product_name": "Red Hat Integration Camel K"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:6",
			"fix_state": "Out of support scope",
			"package_name": "elasticsearch",
			"product_name": "Red Hat JBoss Data Grid 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:6",
			"fix_state": "Out of support scope",
			"package_name": "elasticsearch",
			"product_name": "Red Hat JBoss Fuse 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"fix_state": "Not affected",
			"package_name": "elasticsearch",
			"product_name": "Red Hat JBoss Fuse 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse_service_works:6",
			"fix_state": "Out of support scope",
			"package_name": "elasticsearch",
			"product_name": "Red Hat JBoss Fuse Service Works 6"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Not affected",
			"package_name": "openshift3/ose-logging-elasticsearch5",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-logging-elasticsearch6",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:10",
			"fix_state": "Not affected",
			"package_name": "python-elasticsearch",
			"product_name": "Red Hat OpenStack Platform 10 (Newton)"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7",
			"fix_state": "Not affected",
			"package_name": "elasticsearch",
			"product_name": "Red Hat Process Automation 7"
		}
	],
	"public_date": "2021-08-03T00:00:00Z",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-22147\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-22147\nhttps://discuss.elastic.co/t/elastic-stack-7-14-0-security-update/280344"
	],
	"statement": "Searchable snapshots feature is only available with enterprise subscription. Opensource version of elasticsearch does not include the searchable snapshots feature and hence not affected by this vulnerability.",
	"threat_severity": "Moderate",
	"upstream_fix": "elasticsearch 7.14.0"
}
