{
	"name": "CVE-2021-21321",
	"threat_severity": "Critical",
	"public_date": "2021-02-23T00:00:00Z",
	"bugzilla": {
		"description": "fastify-reply-from: crafted URL allows prefix scape of the proxied backend service",
		"id": "1942178",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1942178"
	},
	"cvss3": {
		"cvss3_base_score": "10.0",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N",
		"status": "verified"
	},
	"cwe": "CWE-20",
	"details": [
		"fastify-reply-from is an npm package which is a fastify plugin to forward the current http request to another server. In fastify-reply-from before version 4.0.2, by crafting a specific URL, it is possible to escape the prefix of the proxied backend service. If the base url of the proxied server is \"/pub/\", a user expect that accessing \"/priv\" on the target service would not be possible. In affected versions, it is possible. This is fixed in version 4.0.2.",
		"A flaw was found in fastify-reply-from. Escaping of the prefix of the proxied backend service is possible allowing an attacker, using a specially crafted URL, to gain access to directories that would otherwise be out of bounds. The highest threat from this vulnerability is to data confidentiality and integrity."
	],
	"statement": "The impact of this flaw largely depends on the environment where the affected library is being used. This flaw could be used to redirect an adversary to an exposed, unprotected endpoint. Depending on the functionality of the affected endpoint that could result in a loss of confidentiality, integrity and availability.  The severity of this flaw in for Red Had Advanced Cluster Management for Kubernetes is rated as important as there are no exposed, un-authenticated endpoints that could be accessed by exploiting this flaw.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-21321\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-21321\nhttps://github.com/fastify/fastify-reply-from/security/advisories/GHSA-qmw8-3v4g-gwj4"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "acmesolver-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "acm-must-gather-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "acm-operator-bundle-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "application-ui-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "cainjector-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "cert-manager-controller-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "cert-manager-webhook-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "cert-policy-controller-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "clusterlifecycle-state-metrics-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "configmap-watcher-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "config-policy-controller-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "console-api-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "console-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "console-header-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "endpoint-component-operator-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "endpoint-monitoring-operator-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "endpoint-operator-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "governance-policy-propagator-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "governance-policy-spec-sync-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "governance-policy-status-sync-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "governance-policy-template-sync-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "grafana-dashboard-loader-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "grc-ui-api-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "grc-ui-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "iam-policy-controller-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "klusterlet-addon-lease-controller-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "klusterlet-operator-bundle-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "kui-web-terminal-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "management-ingress-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "mcm-topology-api-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "mcm-topology-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "memcached-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "memcached-exporter-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "metrics-collector-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "multicloud-manager-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "multiclusterhub-operator-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "multiclusterhub-repo-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "multicluster-observability-operator-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "multicluster-operators-application-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "multicluster-operators-channel-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "multicluster-operators-deployable-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "multicluster-operators-placementrule-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "multicluster-operators-subscription-operator-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "multicluster-operators-subscription-release-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "observatorium-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "observatorium-operator-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "openshift-hive-operator-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "rbac-query-proxy-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "rcm-controller-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "redisgraph-tls-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "registration-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "registration-operator-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "search-aggregator-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "search-api-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "search-collector-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "search-operator-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "search-ui-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "submariner-addon-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "thanos-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "thanos-receive-controller-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:1168",
			"cpe": "cpe:/a:redhat:acm:2.2::el7",
			"package": "work-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
			"release_date": "2021-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3016",
			"cpe": "cpe:/a:redhat:acm:2.3::el8",
			"impact": "important",
			"package": "rhacm2/search-ui-rhel8:v2.3.0-59",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 8",
			"release_date": "2021-08-06T00:00:00Z"
		}
	],
	"upstream_fix": "fastify-reply-from 4.0.2",
	"csaw": false
}
