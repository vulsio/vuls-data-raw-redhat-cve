{
	"name": "CVE-2021-41089",
	"threat_severity": "Moderate",
	"public_date": "2021-10-04T00:00:00Z",
	"bugzilla": {
		"description": "moby: `docker cp` allows unexpected chmod of host file",
		"id": "2008592",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2008592"
	},
	"cvss3": {
		"cvss3_base_score": "5.3",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:L/I:L/A:L",
		"status": "verified"
	},
	"cwe": "CWE-552",
	"details": [
		"Moby is an open-source project created by Docker to enable software containerization. A bug was found in Moby (Docker Engine) where attempting to copy files using `docker cp` into a specially-crafted container can result in Unix file permission changes for existing files in the hostâ€™s filesystem, widening access to others. This bug does not directly allow files to be read, modified, or executed without an additional cooperating process. This bug has been fixed in Moby (Docker Engine) 20.10.9. Users should update to this version as soon as possible. Running containers do not need to be restarted.",
		"A file permissions vulnerability was found in Moby (Docker Engine). Copying files by using `docker cp` into a specially-crafted container can result in Unix file permission changes for existing files in the host's filesystem, which might lead to permissions escalation and allow an attacker access to restricted data."
	],
	"statement": "In OpenShift Container Platform (OCP), Migration Toolkit for Virtualization (MTV) and Red Hat Quay some components bundle github.com/moby/moby, but successful exploitation requires using a specially crafted container, therefore impact to these components is LOW.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-41089\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-41089\nhttps://github.com/moby/moby/security/advisories/GHSA-v994-f8vw-g7j4"
	],
	"affected_release": [
		{
			"advisory": "RHEA-2021:5066",
			"cpe": "cpe:/a:redhat:migration_toolkit_virtualization:2.2::el8",
			"impact": "low",
			"package": "migration-toolkit-virtualization/mtv-controller-rhel8:2.2.0-39",
			"product_name": "Migration Toolkit for Virtualization 2.2",
			"release_date": "2021-12-09T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "rhacm2/agent-service-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "rhacm2/assisted-installer-agent-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "rhacm2/assisted-installer-reporter-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "rhacm2/assisted-installer-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "rhacm2/multicluster-operators-subscription-release-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Fix deferred",
			"impact": "low",
			"package_name": "rhacm2/multicluster-operators-subscription-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "rhacm2/search-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "rhacm-assisted-service-container",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "docker",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "openshift-compliance-openscap-container",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "openshift-file-integrity-operator-container",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:assisted_installer:",
			"fix_state": "Out of support scope",
			"impact": "low",
			"package_name": "rhai-tech-preview/assisted-installer-agent-rhel8",
			"product_name": "Red Hat OpenShift Container Platform Assisted Installer"
		},
		{
			"cpe": "cpe:/a:redhat:assisted_installer:",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "rhai-tech-preview/assisted-installer-reporter-rhel8",
			"product_name": "Red Hat OpenShift Container Platform Assisted Installer"
		},
		{
			"cpe": "cpe:/a:redhat:assisted_installer:",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "rhai-tech-preview/assisted-installer-rhel8",
			"product_name": "Red Hat OpenShift Container Platform Assisted Installer"
		},
		{
			"cpe": "cpe:/a:redhat:quay:3",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "quay/quay-builder-rhel8",
			"product_name": "Red Hat Quay 3"
		}
	],
	"upstream_fix": "moby 20.10.9",
	"csaw": false
}
