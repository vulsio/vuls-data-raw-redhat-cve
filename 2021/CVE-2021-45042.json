{
	"name": "CVE-2021-45042",
	"threat_severity": "Moderate",
	"public_date": "2021-12-13T00:00:00Z",
	"bugzilla": {
		"description": "vault: clusters using the integrated storage backend allowed an authenticated user to cause a DoS of the storage backend",
		"id": "2034914",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2034914"
	},
	"cvss3": {
		"cvss3_base_score": "4.9",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H",
		"status": "draft"
	},
	"cwe": "CWE-400",
	"details": [
		"In HashiCorp Vault and Vault Enterprise before 1.7.7, 1.8.x before 1.8.6, and 1.9.x before 1.9.1, clusters using the Integrated Storage backend allowed an authenticated user (with write permissions to a kv secrets engine) to cause a panic and denial of service of the storage backend. The earliest affected version is 1.4.0.",
		"A denial of service attack was discovered against vault. For clusters using the Integrated Storage (Raft) backend, an authenticated user with write permissions to the KV secrets engine can cause a panic leading to a denial of service of the storage backend, by supplying a key larger than 32KB."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-45042\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-45042\nhttps://discuss.hashicorp.com/t/hcsec-2021-33-vault-s-kv-secrets-engine-with-integrated-storage-exposed-to-authenticated-denial-of-service/33157"
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:logging:5",
			"fix_state": "Not affected",
			"package_name": "openshift-logging/logging-loki-rhel8",
			"product_name": "Logging Subsystem for Red Hat OpenShift"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "hashicorp/vault",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-installer",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/topology-aware-lifecycle-manager-rhel8-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Not affected",
			"package_name": "ocs4/cephcsi-rhel8",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Not affected",
			"package_name": "ocs4/mcg-rhel8-operator",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Not affected",
			"package_name": "ocs4/ocs-rhel8-operator",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Not affected",
			"package_name": "ocs4/rook-ceph-rhel8-operator",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "mcg",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "noobaa-operator-container",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf4/cephcsi-rhel8",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf4/mcg-rhel8-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf4/ocs-must-gather-rhel8",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf4/ocs-rhel8-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf4/odf-multicluster-rhel8-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf4/odf-rhel8-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf4/odr-rhel8-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf4/rook-ceph-rhel8-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf/odf-multicluster-rhel8-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		}
	],
	"upstream_fix": "vault 1.7.7, vault 1.8.6, vault 1.9.1",
	"csaw": false
}
