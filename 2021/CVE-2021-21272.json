{
	"name": "CVE-2021-21272",
	"threat_severity": "Moderate",
	"public_date": "2021-01-22T00:00:00Z",
	"bugzilla": {
		"description": "oras: zip-slip vulnerability via oras-pull",
		"id": "1921286",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1921286"
	},
	"cvss3": {
		"cvss3_base_score": "7.1",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:H/A:N",
		"status": "verified"
	},
	"cwe": "CWE-22",
	"details": [
		"ORAS is open source software which enables a way to push OCI Artifacts to OCI Conformant registries. ORAS is both a CLI for initial testing and a Go Module. In ORAS from version 0.4.0 and before version 0.9.0, there is a \"zip-slip\" vulnerability. The directory support feature allows the downloaded gzipped tarballs to be automatically extracted to the user-specified directory where the tarball can have symbolic links and hard links. A well-crafted tarball or tarballs allow malicious artifact providers linking, writing, or overwriting specific files on the host filesystem outside of the user-specified directory unexpectedly with the same permissions as the user who runs `oras pull`. Users of the affected versions are impacted if they are `oras` CLI users who runs `oras pull`, or if they are Go programs, which invoke `github.com/deislabs/oras/pkg/content.FileStore`. The problem has been fixed in version 0.9.0. For `oras` CLI users, there is no workarounds other than pulling from a trusted artifact provider. For `oras` package users, the workaround is to not use `github.com/deislabs/oras/pkg/content.FileStore`, and use other content stores instead, or pull from a trusted artifact provider.",
		"A flaw was found in oras. The directory support feature allows the downloaded gzipped tarballs to be automatically extracted to the user-specified directory where the tarball can have symbolic links and hard links. A well-crafted tarball or tarballs allow malicious artifact providers linking, writing, or overwriting specific files on the host filesystem outside of the user-specified directory unexpectedly with the same permissions as the user who runs `oras pull`."
	],
	"statement": "A vulnerable version of github.com/deislabs/oras package is delivered in listed OpenShift Container Platform (OCP) and OpenShift Container Storage components, but the vulnerable code is not invoked, therefore these components are affected but with impact Low.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-21272\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-21272\nhttps://github.com/deislabs/oras/security/advisories/GHSA-g5v4-5x39-vwhx"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2021:3016",
			"cpe": "cpe:/a:redhat:acm:2.3::el8",
			"impact": "low",
			"package": "rhacm2/endpoint-monitoring-rhel8-operator:v2.3.0-49",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 8",
			"release_date": "2021-08-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3016",
			"cpe": "cpe:/a:redhat:acm:2.3::el8",
			"impact": "low",
			"package": "rhacm2/multicluster-operators-subscription-release-rhel8:v2.3.0-43",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 8",
			"release_date": "2021-08-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3016",
			"cpe": "cpe:/a:redhat:acm:2.3::el8",
			"impact": "low",
			"package": "rhacm2/multicluster-operators-subscription-rhel8:v2.3.0-66",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 8",
			"release_date": "2021-08-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3016",
			"cpe": "cpe:/a:redhat:acm:2.3::el8",
			"impact": "low",
			"package": "rhacm2/search-collector-rhel8:v2.3.0-52",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 8",
			"release_date": "2021-08-06T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "multicloud-operators-subscription",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "multicloud-operators-subscription-release",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "multicluster-monitoring-operator",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "search-collector",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:advanced_cluster_security:3",
			"fix_state": "Affected",
			"package_name": "rox",
			"product_name": "Red Hat Advanced Cluster Security 3"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "openshift4/cnf-tests-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "openshift4/compliance-rhel8-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "openshift4/file-integrity-rhel8-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "openshift4/ose-ansible-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "openshift4/ose-console",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "openshift4/ose-helm-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "openshift4/ose-operator-lifecycle-manager",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "openshift4/ose-ptp-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "openshift4/ose-sriov-network-config-daemon",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "openshift4/ose-sriov-network-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "openshift4/ose-sriov-network-webhook",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "openshift4/ose-sriov-operator-must-gather",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "openshift4-wincw/windows-machine-config-rhel8-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:assisted_installer:",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "rhai-tech-preview/assisted-installer-agent-rhel8",
			"product_name": "Red Hat OpenShift Container Platform Assisted Installer"
		},
		{
			"cpe": "cpe:/a:redhat:assisted_installer:",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "rhai-tech-preview/assisted-installer-reporter-rhel8",
			"product_name": "Red Hat OpenShift Container Platform Assisted Installer"
		},
		{
			"cpe": "cpe:/a:redhat:assisted_installer:",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "rhai-tech-preview/assisted-installer-rhel8",
			"product_name": "Red Hat OpenShift Container Platform Assisted Installer"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "ocs4/mcg-rhel8-operator",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "ocs4/ocs-must-gather-rhel8",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "ocs4/ocs-rhel8-operator",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:container_native_virtualization:2",
			"fix_state": "Not affected",
			"package_name": "cluster-network-addons-operator-container",
			"product_name": "Red Hat OpenShift Virtualization 2"
		},
		{
			"cpe": "cpe:/a:redhat:container_native_virtualization:2",
			"fix_state": "Not affected",
			"package_name": "container-native-virtualization/vm-import-controller-rhel8",
			"product_name": "Red Hat OpenShift Virtualization 2"
		},
		{
			"cpe": "cpe:/a:redhat:container_native_virtualization:2",
			"fix_state": "Not affected",
			"package_name": "hostpath-provisioner-container",
			"product_name": "Red Hat OpenShift Virtualization 2"
		},
		{
			"cpe": "cpe:/a:redhat:container_native_virtualization:2",
			"fix_state": "Not affected",
			"package_name": "hostpath-provisioner-operator-container",
			"product_name": "Red Hat OpenShift Virtualization 2"
		},
		{
			"cpe": "cpe:/a:redhat:container_native_virtualization:2",
			"fix_state": "Not affected",
			"package_name": "hyperconverged-cluster-operator-container",
			"product_name": "Red Hat OpenShift Virtualization 2"
		},
		{
			"cpe": "cpe:/a:redhat:container_native_virtualization:2",
			"fix_state": "Not affected",
			"package_name": "kubernetes-nmstate-handler-container",
			"product_name": "Red Hat OpenShift Virtualization 2"
		},
		{
			"cpe": "cpe:/a:redhat:container_native_virtualization:2",
			"fix_state": "Not affected",
			"package_name": "node-maintenance-operator-container",
			"product_name": "Red Hat OpenShift Virtualization 2"
		},
		{
			"cpe": "cpe:/a:redhat:container_native_virtualization:2",
			"fix_state": "Not affected",
			"package_name": "vm-import-operator-container",
			"product_name": "Red Hat OpenShift Virtualization 2"
		}
	],
	"upstream_fix": "github.com/deislabs/oras 0.9.0",
	"csaw": false
}
