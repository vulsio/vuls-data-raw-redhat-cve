{
	"name": "CVE-2021-44832",
	"threat_severity": "Moderate",
	"public_date": "2021-12-28T00:00:00Z",
	"bugzilla": {
		"description": "CVE-2021-44832 log4j-core: remote code execution via JDBC Appender",
		"id": "2035951",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2035951"
	},
	"cvss3": {
		"cvss3_base_score": "6.6",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-20",
	"details": [
		"Apache Log4j2 versions 2.0-beta7 through 2.17.0 (excluding security fix releases 2.3.2 and 2.12.4) are vulnerable to a remote code execution (RCE) attack when a configuration uses a JDBC Appender with a JNDI LDAP data source URI when an attacker has control of the target LDAP server. This issue is fixed by limiting JNDI data source names to the java protocol in Log4j2 versions 2.17.1, 2.12.4, and 2.3.2.",
		"Apache Log4j2 versions 2.0-beta7 through 2.17.0 (excluding security fix releases 2.3.2 and 2.12.4) are vulnerable to a remote code execution (RCE) attack where an attacker with permission to modify the logging configuration file can construct a malicious configuration using a JDBC Appender with a data source referencing a JNDI URI which can execute remote code. This issue is fixed by limiting JNDI data source names to the java protocol in Log4j2 versions 2.17.1, 2.12.4, and 2.3.2."
	],
	"statement": "Log4j 1.x is not impacted by this vulnerability. Therefore versions of log4j shipped with Red Hat Enterprise Linux are NOT affected by this flaw.\nFor Elasticsearch, as shipped in OpenShift Container Platform and OpenShift Logging, access to the log4j2.properties configuration is limited only to the cluster administrators and exploitation requires cluster logging changes, what reduced the impact of this vulnerability significantly [0].\n[0] https://discuss.elastic.co/t/apache-log4j2-remote-code-execution-rce-vulnerability-cve-2021-44228-esa-2021-31/291476#update-jan-6-5",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-44832\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-44832\nhttps://issues.apache.org/jira/browse/LOG4J2-3293"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "As per upstream:\n- In prior releases confirm that if the JDBC Appender is being used it is not configured to use any protocol other than Java.\n- Note that only the log4j-core JAR file is impacted by this vulnerability. Applications using only the log4j-api JAR file without the log4j-core JAR file are not impacted by this vulnerability."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2022:1299",
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4",
			"impact": "low",
			"package": "log4j-core",
			"product_name": "EAP 7.4.4 release",
			"release_date": "2022-04-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0216",
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4",
			"impact": "low",
			"package": "log4j-core",
			"product_name": "EAP 7.4 log4j async",
			"release_date": "2022-01-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0225",
			"cpe": "cpe:/a:redhat:logging:5.0::el8",
			"package": "openshift-logging/elasticsearch6-rhel8:v5.0.12-1",
			"product_name": "OpenShift Logging 5.0",
			"release_date": "2022-01-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0226",
			"cpe": "cpe:/a:redhat:logging:5.1::el8",
			"package": "openshift-logging/elasticsearch6-rhel8:v6.8.1-98",
			"product_name": "OpenShift Logging 5.1",
			"release_date": "2022-01-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0230",
			"cpe": "cpe:/a:redhat:logging:5.2::el8",
			"package": "openshift-logging/elasticsearch6-rhel8:v6.8.1-100",
			"product_name": "OpenShift Logging 5.2",
			"release_date": "2022-01-21T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0227",
			"cpe": "cpe:/a:redhat:logging:5.3::el8",
			"package": "openshift-logging/elasticsearch6-rhel8:v6.8.1-99",
			"product_name": "OpenShift Logging 5.3",
			"release_date": "2022-01-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0467",
			"cpe": "cpe:/a:redhat:amq_streams:1",
			"product_name": "Red Hat AMQ Streams 1.6.7",
			"release_date": "2022-02-08T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0138",
			"cpe": "cpe:/a:redhat:amq_streams:2",
			"package": "log4j-core",
			"product_name": "Red Hat AMQ Streams 2.0.0",
			"release_date": "2022-01-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0205",
			"cpe": "cpe:/a:redhat:jboss_data_grid:8.2",
			"package": "log4j-core",
			"product_name": "Red Hat Data Grid 8.2.3",
			"release_date": "2022-01-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0203",
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"package": "log4j-core",
			"product_name": "Red Hat Fuse 7.8.2, 7.9.1, 7.10.1",
			"release_date": "2022-01-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0222",
			"cpe": "cpe:/a:redhat:camel_quarkus:2.2",
			"package": "log4j-core",
			"product_name": "Red Hat Integration Camel Extensions for Quarkus 2.2",
			"release_date": "2022-01-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0223",
			"cpe": "cpe:/a:redhat:integration:1",
			"package": "log4j-core",
			"product_name": "Red Hat Integration Camel-K 1.6.3",
			"release_date": "2022-01-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:1297",
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4::el8",
			"impact": "low",
			"package": "eap7-log4j-0:2.17.1-1.redhat_00001.1.el8eap",
			"product_name": "Red Hat JBoss Enterprise Application Platform 7.4 for RHEL 8",
			"release_date": "2022-04-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:1296",
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4::el7",
			"impact": "low",
			"package": "eap7-log4j-0:2.17.1-1.redhat_00001.1.el7eap",
			"product_name": "Red Hat JBoss Enterprise Application Platform 7.4 on RHEL 7",
			"release_date": "2022-04-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0236",
			"cpe": "cpe:/a:redhat:openshift:3.11::el7",
			"package": "openshift3/ose-logging-elasticsearch5:v3.11.570-2.ge84e80c",
			"product_name": "Red Hat OpenShift Container Platform 3.11",
			"release_date": "2022-01-25T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0181",
			"cpe": "cpe:/a:redhat:openshift:4.6::el8",
			"package": "openshift4/ose-logging-elasticsearch6:v4.6.0-202201181437.p0.g181b827.assembly.stream",
			"product_name": "Red Hat OpenShift Container Platform 4.6",
			"release_date": "2022-01-27T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0493",
			"cpe": "cpe:/a:redhat:openshift:4.7::el8",
			"package": "openshift4/ose-metering-hive:v4.7.0-202201271626.p0.g12e974d.assembly.stream",
			"product_name": "Red Hat OpenShift Container Platform 4.7",
			"release_date": "2022-02-16T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0493",
			"cpe": "cpe:/a:redhat:openshift:4.7::el8",
			"package": "openshift4/ose-metering-presto:v4.7.0-202201271626.p0.g2155d34.assembly.stream",
			"product_name": "Red Hat OpenShift Container Platform 4.7",
			"release_date": "2022-02-16T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0485",
			"cpe": "cpe:/a:redhat:openshift:4.8::el8",
			"package": "openshift4/ose-metering-hive:v4.8.0-202201271626.p0.g8fb24af.assembly.stream",
			"product_name": "Red Hat OpenShift Container Platform 4.8",
			"release_date": "2022-02-16T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0485",
			"cpe": "cpe:/a:redhat:openshift:4.8::el8",
			"package": "openshift4/ose-metering-presto:v4.8.0-202201271626.p0.gf1abc62.assembly.stream",
			"product_name": "Red Hat OpenShift Container Platform 4.8",
			"release_date": "2022-02-16T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0083",
			"cpe": "cpe:/a:redhat:openshift_application_runtimes:1.0",
			"package": "log4j-core",
			"product_name": "Vert.x 4.1.8",
			"release_date": "2022-01-20T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:a_mq_clients:2",
			"fix_state": "Not affected",
			"package_name": "log4j-core",
			"product_name": "A-MQ Clients 2"
		},
		{
			"cpe": "cpe:/a:redhat:quarkus:2",
			"fix_state": "Not affected",
			"package_name": "log4j-core",
			"product_name": "Red Hat build of Quarkus"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_developer_studio:12.",
			"fix_state": "Affected",
			"package_name": "log4j-core",
			"product_name": "Red Hat CodeReady Studio 12"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7",
			"fix_state": "Not affected",
			"package_name": "log4j-core",
			"product_name": "Red Hat Decision Manager 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "log4j",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Not affected",
			"package_name": "log4j",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "parfait:0.5/log4j12",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/a:redhat:amq_broker:7",
			"fix_state": "Not affected",
			"package_name": "log4j-core",
			"product_name": "Red Hat JBoss A-MQ 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6",
			"fix_state": "Not affected",
			"package_name": "log4j",
			"product_name": "Red Hat JBoss Enterprise Application Platform 6"
		},
		{
			"cpe": "cpe:/a:redhat:jbosseapxp",
			"fix_state": "Not affected",
			"package_name": "log4j-core",
			"product_name": "Red Hat JBoss Enterprise Application Platform Expansion Pack"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-metering-hadoop",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "log4j-core",
			"product_name": "Red Hat Process Automation 7"
		},
		{
			"cpe": "cpe:/a:redhat:satellite:6",
			"fix_state": "Not affected",
			"package_name": "log4j-over-slf4j",
			"product_name": "Red Hat Satellite 6"
		},
		{
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7",
			"fix_state": "Not affected",
			"package_name": "log4j-core",
			"product_name": "Red Hat Single Sign-On 7"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:3",
			"fix_state": "Not affected",
			"package_name": "rh-java-common-log4j",
			"product_name": "Red Hat Software Collections"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:3",
			"fix_state": "Not affected",
			"package_name": "rh-maven35-log4j12",
			"product_name": "Red Hat Software Collections"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:3",
			"fix_state": "Not affected",
			"package_name": "rh-maven36-log4j12",
			"product_name": "Red Hat Software Collections"
		}
	],
	"upstream_fix": "log4j 2.3.2, log4j 2.12.4, log4j 2.17.1",
	"csaw": false
}
