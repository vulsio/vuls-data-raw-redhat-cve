{
	"name": "CVE-2021-22947",
	"threat_severity": "Moderate",
	"public_date": "2021-09-15T00:00:00Z",
	"bugzilla": {
		"description": "Server responses received before STARTTLS processed after TLS handshake",
		"id": "2003191",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2003191"
	},
	"cvss3": {
		"cvss3_base_score": "6.1",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:N/A:N",
		"status": "verified"
	},
	"cwe": "CWE-319",
	"details": [
		"When curl >= 7.20.0 and <= 7.78.0 connects to an IMAP or POP3 server to retrieve data using STARTTLS to upgrade to TLS security, the server can respond and send back multiple responses at once that curl caches. curl would then upgrade to TLS but not flush the in-queue of cached responses but instead continue using and trustingthe responses it got *before* the TLS handshake as if they were authenticated.Using this flaw, it allows a Man-In-The-Middle attacker to first inject the fake responses, then pass-through the TLS traffic from the legitimate server and trick curl into sending data back to the user thinking the attacker's injected data comes from the TLS-protected server.",
		"A flaw was found in curl. The flaw lies in how curl handles cached or pipelined responses that it receives from either a IMAP, POP3, SMTP or FTP server before the TLS upgrade using STARTTLS. In such a scenario curl even after upgrading to TLS would trust these cached responses treating them as valid and authenticated and use them. An attacker could potentially use this flaw to carry out a Man-In-The-Middle attack. The highest threat from this vulnerability is to data confidentiality."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-22947\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-22947\nhttps://curl.se/docs/CVE-2021-22947.html"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2022:1354",
			"cpe": "cpe:/a:redhat:rhel_dotnet:3.1::el7",
			"package": "rh-dotnet31-curl-0:7.61.1-22.el7_9",
			"product_name": ".NET Core on Red Hat Enterprise Linux",
			"release_date": "2022-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:4059",
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"package": "curl-0:7.61.1-18.el8_4.2",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2021-11-02T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0635",
			"cpe": "cpe:/o:redhat:rhel_eus:8.2",
			"package": "curl-0:7.61.1-12.el8_2.4",
			"product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
			"release_date": "2022-02-22T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:rhel_dotnet:2.1",
			"fix_state": "Out of support scope",
			"package_name": "rh-dotnet21-curl",
			"product_name": ".NET Core 2.1 on Red Hat Enterprise Linux"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:2",
			"fix_state": "Out of support scope",
			"package_name": "curl",
			"product_name": "Red Hat Ceph Storage 2"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "curl",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "curl",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "curl",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_core_services:1",
			"fix_state": "Not affected",
			"package_name": "curl",
			"product_name": "Red Hat JBoss Core Services"
		},
		{
			"cpe": "cpe:/a:redhat:rhel_software_collections:3",
			"fix_state": "Affected",
			"package_name": "httpd24-curl",
			"product_name": "Red Hat Software Collections"
		}
	],
	"upstream_fix": "curl 7.79.0",
	"csaw": false
}
