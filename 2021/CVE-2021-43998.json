{
	"name": "CVE-2021-43998",
	"threat_severity": "Moderate",
	"public_date": "2021-11-18T00:00:00Z",
	"bugzilla": {
		"description": "vault: incorrect policy enforcement",
		"id": "2028193",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2028193"
	},
	"cvss3": {
		"cvss3_base_score": "6.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N",
		"status": "verified"
	},
	"cwe": "CWE-732",
	"details": [
		"HashiCorp Vault and Vault Enterprise 0.11.0 up to 1.7.5 and 1.8.4 templated ACL policies would always match the first-created entity alias if multiple entity aliases exist for a specified entity and mount combination, potentially resulting in incorrect policy enforcement. Fixed in Vault and Vault Enterprise 1.7.6, 1.8.5, and 1.9.0.",
		"A flaw was found in HashiCorp Vault. In affected versions of HashiCorp Vault and Vault Enterprise, templated ACL policies would always match the first-created entity alias if multiple entity aliases exist for a specified entity and mount combination, potentially resulting in incorrect policy enforcement."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-43998\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-43998\nhttps://discuss.hashicorp.com/t/hcsec-2021-30-vaults-templated-acl-policies-matched-first-created-alias-per-entity-and-auth-backend/32132"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2023:2138",
			"cpe": "cpe:/a:redhat:openshift:4.13::el8",
			"package": "openshift4/bare-metal-event-relay-operator-bundle:v4.13.0-39",
			"product_name": "Red Hat OpenShift Container Platform 4.13",
			"release_date": "2023-05-18T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:2138",
			"cpe": "cpe:/a:redhat:openshift:4.13::el8",
			"package": "openshift4/bare-metal-event-relay-rhel8-operator:v4.13.0-42",
			"product_name": "Red Hat OpenShift Container Platform 4.13",
			"release_date": "2023-05-18T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:2138",
			"cpe": "cpe:/a:redhat:openshift:4.13::el8",
			"package": "openshift4/baremetal-hardware-event-proxy-rhel8:v4.13.0-21",
			"product_name": "Red Hat OpenShift Container Platform 4.13",
			"release_date": "2023-05-18T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:2138",
			"cpe": "cpe:/a:redhat:openshift:4.13::el8",
			"package": "openshift4/topology-aware-lifecycle-manager-operator-bundle:v4.13.0-70",
			"product_name": "Red Hat OpenShift Container Platform 4.13",
			"release_date": "2023-05-18T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:2138",
			"cpe": "cpe:/a:redhat:openshift:4.13::el8",
			"package": "openshift4/topology-aware-lifecycle-manager-precache-rhel8:v4.13.0-45",
			"product_name": "Red Hat OpenShift Container Platform 4.13",
			"release_date": "2023-05-18T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:2138",
			"cpe": "cpe:/a:redhat:openshift:4.13::el8",
			"package": "openshift4/topology-aware-lifecycle-manager-recovery-rhel8:v4.13.0-43",
			"product_name": "Red Hat OpenShift Container Platform 4.13",
			"release_date": "2023-05-18T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:2138",
			"cpe": "cpe:/a:redhat:openshift:4.13::el8",
			"package": "openshift4/topology-aware-lifecycle-manager-rhel8-operator:v4.13.0-70",
			"product_name": "Red Hat OpenShift Container Platform 4.13",
			"release_date": "2023-05-18T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:2138",
			"cpe": "cpe:/a:redhat:openshift:4.13::el8",
			"package": "openshift4/ztp-site-generate-rhel8:v4.13.0-45",
			"product_name": "Red Hat OpenShift Container Platform 4.13",
			"release_date": "2023-05-18T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:3742",
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4.13::el9",
			"package": "odf4/odf-rhel9-operator:v4.13.0-24",
			"product_name": "RHODF-4.13-RHEL-9",
			"release_date": "2023-06-21T00:00:00Z"
		},
		{
			"advisory": "RHSA-2023:3742",
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4.13::el9",
			"package": "odf4/rook-ceph-rhel9-operator:v4.13.0-70",
			"product_name": "RHODF-4.13-RHEL-9",
			"release_date": "2023-06-21T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:logging:5",
			"fix_state": "Not affected",
			"package_name": "openshift-logging/logging-loki-rhel9",
			"product_name": "Logging Subsystem for Red Hat OpenShift"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-installer",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Out of support scope",
			"package_name": "ocs4/cephcsi-rhel8",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Out of support scope",
			"package_name": "ocs4/mcg-rhel8-operator",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Out of support scope",
			"package_name": "ocs4/ocs-rhel8-operator",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Out of support scope",
			"package_name": "ocs4/rook-ceph-rhel8-operator",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf4/cephcsi-rhel8",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf4/mcg-rhel9-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf4/ocs-rhel9-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Will not fix",
			"package_name": "odf4/odf-multicluster-rhel9-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Not affected",
			"package_name": "odf4/odr-rhel8-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		}
	],
	"upstream_fix": "Vault 1.7.6, Vault 1.8.5, Vault 1.9.0",
	"csaw": false
}
