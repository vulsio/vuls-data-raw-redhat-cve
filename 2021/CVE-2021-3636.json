{
	"name": "CVE-2021-3636",
	"threat_severity": "Moderate",
	"public_date": "2021-07-14T00:00:00Z",
	"bugzilla": {
		"description": "CVE-2021-3636 openshift: Injected service-ca.crt incorrectly contains additional internal CAs",
		"id": "1978621",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1978621"
	},
	"cvss3": {
		"cvss3_base_score": "4.6",
		"cvss3_scoring_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N",
		"status": "verified"
	},
	"cwe": "CWE-295->CWE-287",
	"details": [
		"It was found in OpenShift, before version 4.8, that the generated certificate for the in-cluster Service CA, incorrectly included additional certificates. The Service CA is automatically mounted into all pods, allowing them to safely connect to trusted in-cluster services that present certificates signed by the trusted Service CA. The incorrect inclusion of additional CAs in this certificate would allow an attacker that compromises any of the additional CAs to masquerade as a trusted in-cluster service.",
		"It was found in OpenShift, before version 4.8, that the generated certificate for the in-cluster Service CA, incorrectly included additional certificates. The Service CA is automatically mounted into all pods, allowing them to safely connect to trusted in-cluster services that present certificates signed by the trusted Service CA. The incorrect inclusion of additional CAs in this certificate would allow an attacker that compromises any of the additional CAs to masquerade as a trusted in-cluster service."
	],
	"statement": "Though this CVE is fixed by default in freshly installed OpenShift 4.8 clusters, existing clusters that upgrade to 4.8 will need to opt-in to the new secure behaviour. Once opted-in, it is not possible to revert to the previous insecure behaviour.\nClusters can opt-in to the new secure behaviour by upgrading to version 4.8 or later and then setting \"spec.useMoreSecureServiceCA\" to true in the KubeControllerManager API object, e.g.:\n```$ oc patch KubeControllerManager cluster -p '{\"spec\": {\"useMoreSecureServiceCA\": true}}' --type=merge```\nThe kube-controller-manager pod will then restart before the changes to take effect. New pods will then be provisioned with the secure Service CA.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-3636\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-3636"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2021:2437",
			"cpe": "cpe:/a:redhat:openshift:4.8::el7",
			"package": "openshift-0:4.8.0-202107161820.p0.git.051ac4f.assembly.stream.el8",
			"product_name": "Red Hat OpenShift Container Platform 4.8",
			"release_date": "2021-07-27T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Out of support scope",
			"package_name": "atomic-openshift",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		}
	],
	"upstream_fix": "openshift 4.8",
	"csaw": false
}
