{
	"name": "CVE-2021-32690",
	"threat_severity": "Moderate",
	"public_date": "2021-06-16T00:00:00Z",
	"bugzilla": {
		"description": "information disclosure vulnerability",
		"id": "1978144",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1978144"
	},
	"cvss3": {
		"cvss3_base_score": "6.8",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:N/A:N",
		"status": "verified"
	},
	"cwe": "CWE-200",
	"details": [
		"Helm is a tool for managing Charts (packages of pre-configured Kubernetes resources). In versions of helm prior to 3.6.1, a vulnerability exists where the username and password credentials associated with a Helm repository could be passed on to another domain referenced by that Helm repository. This issue has been resolved in 3.6.1. There is a workaround through which one may check for improperly passed credentials. One may use a username and password for a Helm repository and may audit the Helm repository in order to check for another domain being used that could have received the credentials. In the `index.yaml` file for that repository, one may look for another domain in the `urls` list for the chart versions. If there is another domain found and that chart version was pulled or installed, the credentials would be passed on.",
		"A vulnerability was discovered in Helm, which could allow credentials associated with one Helm repository to be leaked to another repository referenced by the first one.  In order to exploit this vulnerability, an attacker would need to control a repository trusted by the configuration of the target Helm instance."
	],
	"statement": "Red Hat Advanced Cluster Management for Kubernetes:\nIn Red Hat Advanced Cluster Management for Kubernetes (RHACM) the affected components are using helm chart provided by the installer, so components are not using untrusted charts except in the application-lifecycle area. For this reason we marked the impact as low. For RHACM, the credentials could be leaked only when a helm chart is stored in a domain other than the helm repository itself. In practice, this rarely happens as the chart is stored in the same helm repository. For example, this chart in the helm repo https://charts.helm.sh/stable/index.yaml references only charts stored in the same domain (charts.heml.sh). From version, 2.2 onwards, multicloud-operators-placementrule and multicloud-operators-deployable do not use helm at all.\nOpenShift Developer Tools and Services:\nThe OpenShift Helm team has analyzed this CVE and we have come to the conclusion that this only affects OpenShift Helm customers that use the CLI to install and update charts. It does not affect customers that use the OpenShift Console to install and update charts. To mitigate this issue, customers can refresh their Helm cli by following the Red Had official Helm install guide here: https://docs.openshift.com/container-platform/4.7/cli_reference/helm_cli/getting-started-with-helm-on-openshift-container-platform.html#installing-helm_getting-started-with-helm-on-openshift. The mirror (https://mirror.openshift.com/pub/openshift-v4/clients/helm/latest/) have already been updated with helm 3.6.2 which contains the fix for this CVE.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-32690\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-32690\nhttps://github.com/helm/helm/security/advisories/GHSA-56hp-xqp3-w2jf"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2021:3925",
			"cpe": "cpe:/a:redhat:acm:2.3::el8",
			"package": "rhacm2/multicluster-operators-channel-rhel8:v2.3.3-2",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 8",
			"release_date": "2021-10-20T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:4618",
			"cpe": "cpe:/a:redhat:acm:2.4::el8",
			"package": "rhacm2/multicluster-operators-application-rhel8:v2.4.0-9",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.4 for RHEL 8",
			"release_date": "2021-11-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:4618",
			"cpe": "cpe:/a:redhat:acm:2.4::el8",
			"package": "rhacm2/multicluster-operators-subscription-release-rhel8:v2.4.0-8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.4 for RHEL 8",
			"release_date": "2021-11-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:4618",
			"cpe": "cpe:/a:redhat:acm:2.4::el8",
			"package": "rhacm2/multicluster-operators-subscription-rhel8:v2.4.0-40",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.4 for RHEL 8",
			"release_date": "2021-11-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3759",
			"cpe": "cpe:/a:redhat:openshift:4.9::el8",
			"package": "openshift4/ose-console:v4.9.0-202110130449.p0.git.8c077e4.assembly.rc.8",
			"product_name": "Red Hat OpenShift Container Platform 4.9",
			"release_date": "2021-10-18T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:4902",
			"cpe": "cpe:/a:redhat:advanced_cluster_security:3.67::el8",
			"package": "advanced-cluster-security/rhacs-rhel8-operator:3.67.0-3",
			"product_name": "RHACS-3.67-RHEL-8",
			"release_date": "2021-12-01T00:00:00Z"
		},
		{
			"advisory": "RHEA-2021:3139",
			"cpe": "cpe:/a:redhat:rhosemc:1.0::el8",
			"package": "web-terminal-tech-preview/web-terminal-exec-rhel8:1.3-9",
			"product_name": "RHEL-8 based Middleware Containers",
			"release_date": "2021-08-11T00:00:00Z"
		},
		{
			"advisory": "RHEA-2021:3139",
			"cpe": "cpe:/a:redhat:rhosemc:1.0::el8",
			"package": "web-terminal-tech-preview/web-terminal-rhel8-operator:1.3-20",
			"product_name": "RHEL-8 based Middleware Containers",
			"release_date": "2021-08-11T00:00:00Z"
		},
		{
			"advisory": "RHEA-2021:3139",
			"cpe": "cpe:/a:redhat:rhosemc:1.0::el8",
			"package": "web-terminal-tech-preview/web-terminal-rhel8-operator-metadata:1.3-19",
			"product_name": "RHEL-8 based Middleware Containers",
			"release_date": "2021-08-11T00:00:00Z"
		},
		{
			"advisory": "RHEA-2021:3139",
			"cpe": "cpe:/a:redhat:rhosemc:1.0::el8",
			"package": "web-terminal-tech-preview/web-terminal-tooling-rhel8:1.3-6",
			"product_name": "RHEL-8 based Middleware Containers",
			"release_date": "2021-08-11T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:ocp_tools",
			"fix_state": "Will not fix",
			"package_name": "helm",
			"product_name": "OpenShift Developer Tools and Services"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:1",
			"fix_state": "Out of support scope",
			"package_name": "servicemesh",
			"product_name": "OpenShift Service Mesh 1"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:1",
			"fix_state": "Out of support scope",
			"package_name": "servicemesh-operator",
			"product_name": "OpenShift Service Mesh 1"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:2.0",
			"fix_state": "Not affected",
			"package_name": "servicemesh",
			"product_name": "OpenShift Service Mesh 2.0"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:2.0",
			"fix_state": "Not affected",
			"package_name": "servicemesh-operator",
			"product_name": "OpenShift Service Mesh 2.0"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "cert-policy-controller",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "config-policy-controller",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "endpoint-component-operator",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "endpoint-operator",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "governance-policy-propagator",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "governance-policy-spec-sync",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "governance-policy-status-sync",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "governance-policy-template-sync",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "iam-policy-controller",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "multicloudhub-operator",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "multicloudhub-repo",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "multicloud-operators-application",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "multicloud-operators-channel",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "multicloud-operators-deployable",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "multicloud-operators-foundation",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "multicloud-operators-placementrule",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "multicloud-operators-subscription",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "multicloud-operators-subscription-release",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rcm-controller",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "registration-operator",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/acmesolver-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/cainjector-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/cert-manager-controller-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/cert-manager-webhook-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/cert-policy-controller-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/cluster-curator-controller-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/clusterlifecycle-state-metrics-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/config-policy-controller-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/endpoint-monitoring-rhel8-operator",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/governance-policy-propagator-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/governance-policy-spec-sync-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/governance-policy-status-sync-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/governance-policy-template-sync-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/iam-policy-controller-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/managedcluster-import-controller-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/metrics-collector-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/multicloud-manager-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/multiclusterhub-repo-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/multiclusterhub-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/multicluster-observability-rhel8-operator",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/multicluster-operators-deployable-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/multicluster-operators-placementrule-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/openshift-hive-rhel7",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/rcm-controller-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/registration-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/registration-rhel8-operator",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/search-aggregator-rhel7",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/search-collector-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/search-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/submariner-addon-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2-tech-preview/subctl-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2-tech-preview/submariner-operator-bundle",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2-tech-preview/submariner-rhel8-operator",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "rhacm2/work-rhel8",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "search-aggregator",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "search-collector",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "search-operator",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform",
			"fix_state": "Affected",
			"package_name": "helm",
			"product_name": "Red Hat Ansible Automation Platform 1.2"
		},
		{
			"cpe": "cpe:/a:redhat:ansible_automation_platform:2",
			"fix_state": "Affected",
			"package_name": "helm",
			"product_name": "Red Hat Ansible Automation Platform 2"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Affected",
			"package_name": "openshift4/ose-ansible-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Affected",
			"package_name": "openshift4/ose-helm-operator",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Will not fix",
			"package_name": "openshift4/ose-metering-helm-container-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Affected",
			"package_name": "openshift4/ose-operator-sdk-rhel8",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:16.2",
			"fix_state": "Not affected",
			"package_name": "osp-director-provisioner-container",
			"product_name": "Red Hat OpenStack Platform 16.2"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:16.2",
			"fix_state": "Not affected",
			"package_name": "rhosp-beta-rhel8/osp-director-downloader",
			"product_name": "Red Hat OpenStack Platform 16.2"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:16.2",
			"fix_state": "Not affected",
			"package_name": "rhosp-beta-rhel8/osp-director-operator",
			"product_name": "Red Hat OpenStack Platform 16.2"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:16.2",
			"fix_state": "Not affected",
			"package_name": "rhosp-rhel8-tech-preview/osp-director-downloader",
			"product_name": "Red Hat OpenStack Platform 16.2"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:16.2",
			"fix_state": "Not affected",
			"package_name": "rhosp-rhel8-tech-preview/osp-director-operator",
			"product_name": "Red Hat OpenStack Platform 16.2"
		}
	],
	"upstream_fix": "helm 3.6.1",
	"csaw": false
}
