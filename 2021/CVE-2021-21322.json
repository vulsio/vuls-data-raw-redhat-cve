{
	"name": "CVE-2021-21322",
	"threat_severity": "Critical",
	"public_date": "2021-02-23T00:00:00Z",
	"bugzilla": {
		"description": "fastify-http-proxy: crafted URL allows prefix scape of the proxied backend service",
		"id": "1942182",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1942182"
	},
	"cvss3": {
		"cvss3_base_score": "10.0",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N",
		"status": "verified"
	},
	"cwe": "CWE-20",
	"details": [
		"fastify-http-proxy is an npm package which is a fastify plugin for proxying your http requests to another server, with hooks. By crafting a specific URL, it is possible to escape the prefix of the proxied backend service. If the base url of the proxied server is `/pub/`, a user expect that accessing `/priv` on the target service would not be possible. In affected versions, it is possible. This is fixed in version 4.3.1.",
		"A flaw was found in fastify-http-proxy. Escaping the prefix of the proxied backend service is possible by an attacker using a specially crafted URL. The highest threat from this vulnerability is to data confidentiality and integrity."
	],
	"statement": "The impact of this flaw largely depends on the environment where the affected library is being used. This flaw could be used to redirect an adversary to an exposed, unprotected endpoint. Depending on the functionality of the affected endpoint that could result in a loss of confidentiality, integrity and availability.  The severity of this flaw in for Red Had Advanced Cluster Management for Kubernetes is rated as important as there are no exposed, un-authenticated endpoints that could be accessed by exploiting this flaw.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-21322\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-21322\nhttps://github.com/fastify/fastify-http-proxy/security/advisories/GHSA-c4qr-gmr9-v23w"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2021:3016",
			"cpe": "cpe:/a:redhat:acm:2.3::el8",
			"impact": "important",
			"package": "rhacm2/search-ui-rhel8:v2.3.0-59",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 8",
			"release_date": "2021-08-06T00:00:00Z"
		}
	],
	"upstream_fix": "fastify-http-proxy 4.3.1",
	"csaw": false
}
