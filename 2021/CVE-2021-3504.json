{
	"name": "CVE-2021-3504",
	"threat_severity": "Moderate",
	"public_date": "2021-05-03T00:00:00Z",
	"bugzilla": {
		"description": "CVE-2021-3504 hivex: Buffer overflow when provided invalid node key length",
		"id": "1949687",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1949687"
	},
	"cvss3": {
		"cvss3_base_score": "5.4",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:L",
		"status": "verified"
	},
	"cwe": "CWE-125",
	"details": [
		"A flaw was found in the hivex library in versions before 1.3.20. It is caused due to a lack of bounds check within the hivex_open function. An attacker could input a specially crafted Windows Registry (hive) file which would cause hivex to read memory beyond its normal bounds or cause the program to crash. The highest threat from this vulnerability is to system availability.",
		"A flaw was found in the hivex library. It is caused due to a lack of bounds check within the hivex_open function. An attacker could input a specially crafted Windows Registry (hive) file which would cause hivex to read memory beyond its normal bounds or cause the program to crash. The highest threat from this vulnerability is to system availability."
	],
	"statement": "The hivex utility being non-privileged, does not handle any confidential information. Any external program using the hivex library could be exposed to partial unavailability in case of a crash where a user can always retry the operation. As for libguestfs, a crash in hivex would not result in libguestfs crashing.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-3504\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-3504"
	],
	"acknowledgement": "Red Hat would like to thank Jeremy Galindo (Datto) for reporting this issue.",
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2021:2318",
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"package": "hivex-0:1.3.10-6.11.el7_9",
			"product_name": "Red Hat Enterprise Linux 7",
			"release_date": "2021-06-08T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3061",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "virt-devel:rhel-8040020210721215855.522a0ee4",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2021-08-10T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:3061",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "virt:rhel-8040020210721215855.522a0ee4",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2021-08-10T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "hivex",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/a:redhat:advanced_virtualization:8::el8",
			"fix_state": "Affected",
			"package_name": "virt:8.3/hivex",
			"product_name": "Red Hat Enterprise Linux 8 Advanced Virtualization"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "hivex",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "hivex 1.3.20",
	"csaw": false
}
