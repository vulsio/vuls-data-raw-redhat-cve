{
	"name": "CVE-2021-35938",
	"threat_severity": "Moderate",
	"public_date": "2021-06-30T00:00:00Z",
	"bugzilla": {
		"description": "rpm: races with chown/chmod/capabilities calls during installation",
		"id": "1964114",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1964114"
	},
	"cvss3": {
		"cvss3_base_score": "6.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:H",
		"status": "draft"
	},
	"cwe": "CWE-59",
	"details": [
		"A symbolic link issue was found in rpm. It occurs when rpm sets the desired permissions and credentials after installing a file. A local unprivileged user could use this flaw to exchange the original file with a symbolic link to a security-critical file and escalate their privileges on the system. The highest threat from this vulnerability is to data confidentiality and integrity as well as system availability.",
		"A symbolic link issue was found in rpm. It occurs when rpm sets the desired permissions and credentials after installing a file. A local unprivileged user could use this flaw to exchange the original file with a symbolic link to a security-critical file and escalate their privileges on the system. The highest threat from this vulnerability is to data confidentiality and integrity as well as system availability."
	],
	"statement": "System and service accounts may have the required permissions to exploit this flaw. Conversely, regular user accounts should not be allowed to manipulate RPM artifacts during installation, thus reducing the attack surface and hence the impact of this flaw considerably.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-35938\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-35938\nhttps://rpm.org/wiki/Releases/4.18.0"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
	},
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "rpm",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "rpm",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Will not fix",
			"package_name": "rpm",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "rpm",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "rpm 4.18.0",
	"csaw": false
}
