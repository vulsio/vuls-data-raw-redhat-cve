{
	"affected_release": [
		{
			"advisory": "RHSA-2022:6407",
			"cpe": "cpe:/a:redhat:integration:1",
			"package": "elasticsearch",
			"product_name": "RHAF Camel-K 1.8",
			"release_date": "2022-09-09T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:5606",
			"cpe": "cpe:/a:redhat:camel_quarkus:2.7",
			"impact": "low",
			"package": "elasticsearch",
			"product_name": "RHINT Camel-Q 2.7",
			"release_date": "2022-07-19T00:00:00Z"
		}
	],
	"bugzilla": {
		"description": "CVE-2021-22137 elasticsearch: Document disclosure flaw when Document or Field Level Security is used",
		"id": "1943189",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1943189"
	},
	"csaw": false,
	"cvss3": {
		"cvss3_base_score": "2.6",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:N/A:N",
		"status": "verified"
	},
	"cwe": "CWE-200",
	"details": [
		"In Elasticsearch versions before 7.11.2 and 6.8.15 a document disclosure flaw was found when Document or Field Level Security is used. Search queries do not properly preserve security permissions when executing certain cross-cluster search queries. This could result in the search disclosing the existence of documents the attacker should not be able to view. This could result in an attacker gaining additional insight into potentially sensitive indices."
	],
	"name": "CVE-2021-22137",
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:logging:5",
			"fix_state": "Not affected",
			"package_name": "openshift-logging/elasticsearch6-rhel8",
			"product_name": "Logging Subsystem for Red Hat OpenShift"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7",
			"fix_state": "Will not fix",
			"package_name": "elasticsearch",
			"product_name": "Red Hat Decision Manager 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:6",
			"fix_state": "Out of support scope",
			"package_name": "elasticsearch",
			"product_name": "Red Hat JBoss Fuse 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"fix_state": "Will not fix",
			"package_name": "elasticsearch",
			"product_name": "Red Hat JBoss Fuse 7"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Not affected",
			"package_name": "openshift3/ose-logging-elasticsearch5",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-logging-elasticsearch5",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-logging-elasticsearch6",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7",
			"fix_state": "Will not fix",
			"package_name": "elasticsearch",
			"product_name": "Red Hat Process Automation 7"
		}
	],
	"public_date": "2021-03-23T00:00:00Z",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-22137\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-22137\nhttps://discuss.elastic.co/t/elastic-stack-7-12-0-and-6-8-15-security-update/268125"
	],
	"statement": "In Elasticsearch, Document and Field Level Security is an enterprise only feature [1]. Hence the open source version is unaffected by this vulnerability.\n[1] https://www.elastic.co/subscriptions",
	"threat_severity": "Low",
	"upstream_fix": "elasticsearch 6.8.15, elasticsearch 7.11.2"
}
