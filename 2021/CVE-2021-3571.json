{
	"name": "CVE-2021-3571",
	"threat_severity": "Moderate",
	"public_date": "2021-07-05T00:00:00Z",
	"bugzilla": {
		"description": "linuxptp: wrong length of one-step follow-up in transparent clock",
		"id": "1966241",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1966241"
	},
	"cvss3": {
		"cvss3_base_score": "7.1",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H",
		"status": "verified"
	},
	"cwe": "CWE-119",
	"details": [
		"A flaw was found in the ptp4l program of the linuxptp package. When ptp4l is operating on a little-endian architecture as a PTP transparent clock, a remote attacker could send a crafted one-step sync message to cause an information leak or crash. The highest threat from this vulnerability is to data confidentiality and system availability. This flaw affects linuxptp versions before 3.1.1 and before 2.0.1.",
		"A flaw was found in the ptp4l program of the linuxptp package. When ptp4l is operating on a little-endian architecture as a PTP transparent clock, a remote attacker could send a crafted one-step sync message to cause an information leak or crash. The highest threat from this vulnerability is to data confidentiality and system availability."
	],
	"statement": "This flaw has been rated as having a Moderate impact. The information leak is probably not very useful on its own as `ptp4l` doesn't handle any confidential data like passwords or private keys.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-3571\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-3571"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Only attackers that can connect to the `ptp4l` service can exploit this vulnerability. If `ptp4l` is bound only to a private network interface, or is protected by firewall rules to block incoming PTP management messages, the attack surface is correspondingly limited. When using the UDP IPv4 or IPv6 network transport, the following tcpdump filter can be used to detect PTP management messages:\n```\n(port 319 or port 320) and udp[8]&0xf=0xd\n```"
	},
	"affected_release": [
		{
			"advisory": "RHSA-2021:4321",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "linuxptp-0:3.1.1-1.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2021-11-09T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "linuxptp",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "linuxptp",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "linuxptp",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "linuxptp 2.0.1, linuxptp 3.1.1",
	"csaw": false
}
