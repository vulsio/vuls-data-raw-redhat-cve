{
	"name": "CVE-2021-43798",
	"threat_severity": "Moderate",
	"public_date": "2021-12-07T00:00:00Z",
	"bugzilla": {
		"description": "grafana: path traversal vulnerability",
		"id": "2030422",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2030422"
	},
	"cvss3": {
		"cvss3_base_score": "7.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
		"status": "draft"
	},
	"cwe": "CWE-22",
	"details": [
		"Grafana is an open-source platform for monitoring and observability. Grafana versions 8.0.0-beta1 through 8.3.0 (except for patched versions) iss vulnerable to directory traversal, allowing access to local files. The vulnerable URL path is: `<grafana_host_url>/public/plugins//`, where is the plugin ID for any installed plugin. At no time has Grafana Cloud been vulnerable. Users are advised to upgrade to patched versions 8.0.7, 8.1.8, 8.2.7, or 8.3.1. The GitHub Security Advisory contains more information about vulnerable URL paths, mitigation, and the disclosure timeline.",
		"A directory path traversal vulnerability was found in Grafana. This flaw allows an attacker to obtain read access to the local files due to a lack of path normalization in the /public/plugins// URL."
	],
	"statement": "Red Hat Enterprise Linux 8 and 9 are not affected with this vulnerability because we are shipping older versions of Grafana for those. Vulnerable function introduced in upstream from (v8.0.0-beta1 through v8.3.2), which is not present in our source code.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-43798\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-43798\nhttps://github.com/grafana/grafana/security/advisories/GHSA-8pjx-jj86-j47p"
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:service_mesh:2.0",
			"fix_state": "Not affected",
			"package_name": "servicemesh-grafana",
			"product_name": "OpenShift Service Mesh 2.0"
		},
		{
			"cpe": "cpe:/a:redhat:acm:2",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:2",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Ceph Storage 2"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:3",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Ceph Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:3",
			"fix_state": "Not affected",
			"package_name": "grafana-container",
			"product_name": "Red Hat Ceph Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:4",
			"fix_state": "Not affected",
			"package_name": "rhceph/rhceph-4-dashboard-rhel8",
			"product_name": "Red Hat Ceph Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:5",
			"fix_state": "Not affected",
			"package_name": "rhceph/rhceph-5-dashboard-rhel8",
			"product_name": "Red Hat Ceph Storage 5"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Not affected",
			"package_name": "openshift3/grafana",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-grafana",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Storage 3"
		}
	],
	"upstream_fix": "grafana 8.3.1, grafana 8.2.7, grafana 8.1.8, grafana 8.0.7",
	"csaw": false
}
