{
	"name": "CVE-2021-47309",
	"threat_severity": "Moderate",
	"public_date": "2024-05-21T00:00:00Z",
	"bugzilla": {
		"description": "kernel: net: validate lwtstate-&gt;data before returning from skb_tunnel_info()",
		"id": "2282473",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2282473"
	},
	"cvss3": {
		"cvss3_base_score": "5.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
		"status": "draft"
	},
	"cwe": "CWE-125",
	"details": [
		"In the Linux kernel, the following vulnerability has been resolved:\nnet: validate lwtstate->data before returning from skb_tunnel_info()\nskb_tunnel_info() returns pointer of lwtstate->data as ip_tunnel_info\ntype without validation. lwtstate->data can have various types such as\nmpls_iptunnel_encap, etc and these are not compatible.\nSo skb_tunnel_info() should validate before returning that pointer.\nSplat looks like:\nBUG: KASAN: slab-out-of-bounds in vxlan_get_route+0x418/0x4b0 [vxlan]\nRead of size 2 at addr ffff888106ec2698 by task ping/811\nCPU: 1 PID: 811 Comm: ping Not tainted 5.13.0+ #1195\nCall Trace:\ndump_stack_lvl+0x56/0x7b\nprint_address_description.constprop.8.cold.13+0x13/0x2ee\n? vxlan_get_route+0x418/0x4b0 [vxlan]\n? vxlan_get_route+0x418/0x4b0 [vxlan]\nkasan_report.cold.14+0x83/0xdf\n? vxlan_get_route+0x418/0x4b0 [vxlan]\nvxlan_get_route+0x418/0x4b0 [vxlan]\n[ ... ]\nvxlan_xmit_one+0x148b/0x32b0 [vxlan]\n[ ... ]\nvxlan_xmit+0x25c5/0x4780 [vxlan]\n[ ... ]\ndev_hard_start_xmit+0x1ae/0x6e0\n__dev_queue_xmit+0x1f39/0x31a0\n[ ... ]\nneigh_xmit+0x2f9/0x940\nmpls_xmit+0x911/0x1600 [mpls_iptunnel]\nlwtunnel_xmit+0x18f/0x450\nip_finish_output2+0x867/0x2040\n[ ... ]",
		"A vulnerability was found in the Linux kernel's networking component, where the skb_tunnel_info() function can return unvalidated data. This issue arises because the function does not check the type of lwtstate->data before using it, which could lead to accessing incompatible data types and cause memory errors."
	],
	"statement": "This vulnerability is rated as a Moderate severity because the unvalidated data is accessed and it may lead to out-of-bounds memory reads, which could result in system crashes or unexpected behavior.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-47309\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-47309\nhttps://lore.kernel.org/linux-cve-announce/2024052128-CVE-2021-47309-2889@gregkh/T"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Red Hat has investigated whether a possible mitigation exists for this issue, and has not been able to identify a practical example. Please update the affected package as soon as possible."
	},
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "kernel 4.4.277, kernel 4.9.277, kernel 4.14.241, kernel 4.19.199, kernel 5.4.135, kernel 5.10.53, kernel 5.13.5, kernel 5.14",
	"csaw": false
}
