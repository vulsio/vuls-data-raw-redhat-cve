{
	"name": "CVE-2021-22134",
	"threat_severity": "Low",
	"public_date": "2021-03-01T00:00:00Z",
	"bugzilla": {
		"description": "elasticsearch: requests do not properly apply security permissions when executing a query against a recently updated document",
		"id": "1934745",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1934745"
	},
	"cvss3": {
		"cvss3_base_score": "2.6",
		"cvss3_scoring_vector": "CVSS:3.1/AV:A/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N",
		"status": "draft"
	},
	"cwe": "CWE-863",
	"details": [
		"A document disclosure flaw was found in Elasticsearch versions after 7.6.0 and before 7.11.0 when Document or Field Level Security is used. Get requests do not properly apply security permissions when executing a query against a recently updated document. This affects documents that have been updated and not yet refreshed in the index. This could result in the search disclosing the existence of documents and fields the attacker should not be able to view.",
		"A flaw was found in elasticsearch. Get requests do not properly apply security permissions when executing a query against a recently updated document. This affects documents that have been updated and not yet refreshed in the index. This could result in the search disclosing the existence of documents and fields the attacker should not be able to view. A mitigating factor to this flaw is an attacker must know the document ID to run the get request."
	],
	"statement": "In Elasticsearch, Document and Field Level Security is an enterprise only feature [1]. Hence the open source version is unaffected by this vulnerability.\n[1] https://www.elastic.co/subscriptions",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-22134\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-22134\nhttps://discuss.elastic.co/t/elastic-stack-7-11-0-security-update/265835"
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7",
			"fix_state": "Not affected",
			"package_name": "elasticsearch",
			"product_name": "Red Hat Decision Manager 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"fix_state": "Not affected",
			"package_name": "elasticsearch",
			"product_name": "Red Hat Fuse 7"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Not affected",
			"package_name": "elasticsearch",
			"product_name": "Red Hat Integration Camel K"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:6",
			"fix_state": "Not affected",
			"package_name": "elasticsearch",
			"product_name": "Red Hat JBoss Fuse 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse_service_works:6",
			"fix_state": "Not affected",
			"package_name": "elasticsearch",
			"product_name": "Red Hat JBoss Fuse Service Works 6"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Not affected",
			"package_name": "openshift3/ose-logging-elasticsearch5",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-logging-elasticsearch5",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Not affected",
			"package_name": "openshift4/ose-logging-elasticsearch6",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:10",
			"fix_state": "Not affected",
			"package_name": "python-elasticsearch",
			"product_name": "Red Hat OpenStack Platform 10 (Newton)"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7",
			"fix_state": "Not affected",
			"package_name": "elasticsearch",
			"product_name": "Red Hat Process Automation 7"
		},
		{
			"cpe": "cpe:/a:redhat:quay:3",
			"fix_state": "Not affected",
			"package_name": "quay/quay-rhel8",
			"product_name": "Red Hat Quay 3"
		}
	],
	"upstream_fix": "elasticsearch 7.11.0",
	"csaw": false
}
