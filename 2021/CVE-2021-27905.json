{
	"name": "CVE-2021-27905",
	"threat_severity": "Important",
	"public_date": "2021-04-12T00:00:00Z",
	"bugzilla": {
		"description": "solr: SSRF vulnerability with the Replication handler",
		"id": "1949516",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1949516"
	},
	"cvss3": {
		"cvss3_base_score": "8.1",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
		"status": "draft"
	},
	"cwe": "CWE-918",
	"details": [
		"The ReplicationHandler (normally registered at \"/replication\" under a Solr core) in Apache Solr has a \"masterUrl\" (also \"leaderUrl\" alias) parameter that is used to designate another ReplicationHandler on another Solr core to replicate index data into the local core. To prevent a SSRF vulnerability, Solr ought to check these parameters against a similar configuration it uses for the \"shards\" parameter. Prior to this bug getting fixed, it did not. This problem affects essentially all Solr versions prior to it getting fixed in 8.8.2.",
		"A flaw was found in solr. The ReplicationHandler in Apache Solr does not check proper parameters when connecting to another Solr instance to replicate index data into the local core leading to a SSRF vulnerability.  The highest threat from this vulnerability is to data confidentiality and integrity as well as system availability."
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-27905\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-27905"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "Restrict access to the replication handler to only internal Solr instances."
	},
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Not affected",
			"impact": "moderate",
			"package_name": "camel-solr",
			"product_name": "Red Hat Integration Camel K"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_virtualization:6",
			"fix_state": "Out of support scope",
			"package_name": "solr",
			"product_name": "Red Hat JBoss Data Virtualization 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6",
			"fix_state": "Out of support scope",
			"package_name": "solr",
			"product_name": "Red Hat JBoss Enterprise Application Platform 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:6",
			"fix_state": "Out of support scope",
			"package_name": "solr",
			"product_name": "Red Hat JBoss Fuse 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"fix_state": "Not affected",
			"impact": "moderate",
			"package_name": "solr",
			"product_name": "Red Hat JBoss Fuse 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse_service_works:6",
			"fix_state": "Out of support scope",
			"package_name": "solr",
			"product_name": "Red Hat JBoss Fuse Service Works 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_web_server:3",
			"fix_state": "Not affected",
			"package_name": "solr",
			"product_name": "Red Hat JBoss Web Server 3"
		}
	],
	"upstream_fix": "Solr 8.8.2",
	"csaw": false
}
