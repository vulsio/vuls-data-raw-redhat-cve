{
	"name": "CVE-2021-47472",
	"threat_severity": "Moderate",
	"public_date": "2024-05-22T00:00:00Z",
	"bugzilla": {
		"description": "kernel: net: mdiobus: Fix memory leak in __mdiobus_register",
		"id": "2282883",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2282883"
	},
	"cvss3": {
		"cvss3_base_score": "5.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
		"status": "draft"
	},
	"details": [
		"In the Linux kernel, the following vulnerability has been resolved:\nnet: mdiobus: Fix memory leak in __mdiobus_register\nOnce device_register() failed, we should call put_device() to\ndecrement reference count for cleanup. Or it will cause memory\nleak.\nBUG: memory leak\nunreferenced object 0xffff888114032e00 (size 256):\ncomm \"kworker/1:3\", pid 2960, jiffies 4294943572 (age 15.920s)\nhex dump (first 32 bytes):\n00 00 00 00 00 00 00 00 08 2e 03 14 81 88 ff ff  ................\n08 2e 03 14 81 88 ff ff 90 76 65 82 ff ff ff ff  .........ve.....\nbacktrace:\n[<ffffffff8265cfab>] kmalloc include/linux/slab.h:591 [inline]\n[<ffffffff8265cfab>] kzalloc include/linux/slab.h:721 [inline]\n[<ffffffff8265cfab>] device_private_init drivers/base/core.c:3203 [inline]\n[<ffffffff8265cfab>] device_add+0x89b/0xdf0 drivers/base/core.c:3253\n[<ffffffff828dd643>] __mdiobus_register+0xc3/0x450 drivers/net/phy/mdio_bus.c:537\n[<ffffffff828cb835>] __devm_mdiobus_register+0x75/0xf0 drivers/net/phy/mdio_devres.c:87\n[<ffffffff82b92a00>] ax88772_init_mdio drivers/net/usb/asix_devices.c:676 [inline]\n[<ffffffff82b92a00>] ax88772_bind+0x330/0x480 drivers/net/usb/asix_devices.c:786\n[<ffffffff82baa33f>] usbnet_probe+0x3ff/0xdf0 drivers/net/usb/usbnet.c:1745\n[<ffffffff82c36e17>] usb_probe_interface+0x177/0x370 drivers/usb/core/driver.c:396\n[<ffffffff82661d17>] call_driver_probe drivers/base/dd.c:517 [inline]\n[<ffffffff82661d17>] really_probe.part.0+0xe7/0x380 drivers/base/dd.c:596\n[<ffffffff826620bc>] really_probe drivers/base/dd.c:558 [inline]\n[<ffffffff826620bc>] __driver_probe_device+0x10c/0x1e0 drivers/base/dd.c:751\n[<ffffffff826621ba>] driver_probe_device+0x2a/0x120 drivers/base/dd.c:781\n[<ffffffff82662a26>] __device_attach_driver+0xf6/0x140 drivers/base/dd.c:898\n[<ffffffff8265eca7>] bus_for_each_drv+0xb7/0x100 drivers/base/bus.c:427\n[<ffffffff826625a2>] __device_attach+0x122/0x260 drivers/base/dd.c:969\n[<ffffffff82660916>] bus_probe_device+0xc6/0xe0 drivers/base/bus.c:487\n[<ffffffff8265cd0b>] device_add+0x5fb/0xdf0 drivers/base/core.c:3359\n[<ffffffff82c343b9>] usb_set_configuration+0x9d9/0xb90 drivers/usb/core/message.c:2170\n[<ffffffff82c4473c>] usb_generic_driver_probe+0x8c/0xc0 drivers/usb/core/generic.c:238\nBUG: memory leak\nunreferenced object 0xffff888116f06900 (size 32):\ncomm \"kworker/0:2\", pid 2670, jiffies 4294944448 (age 7.160s)\nhex dump (first 32 bytes):\n75 73 62 2d 30 30 31 3a 30 30 33 00 00 00 00 00  usb-001:003.....\n00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\nbacktrace:\n[<ffffffff81484516>] kstrdup+0x36/0x70 mm/util.c:60\n[<ffffffff814845a3>] kstrdup_const+0x53/0x80 mm/util.c:83\n[<ffffffff82296ba2>] kvasprintf_const+0xc2/0x110 lib/kasprintf.c:48\n[<ffffffff82358d4b>] kobject_set_name_vargs+0x3b/0xe0 lib/kobject.c:289\n[<ffffffff826575f3>] dev_set_name+0x63/0x90 drivers/base/core.c:3147\n[<ffffffff828dd63b>] __mdiobus_register+0xbb/0x450 drivers/net/phy/mdio_bus.c:535\n[<ffffffff828cb835>] __devm_mdiobus_register+0x75/0xf0 drivers/net/phy/mdio_devres.c:87\n[<ffffffff82b92a00>] ax88772_init_mdio drivers/net/usb/asix_devices.c:676 [inline]\n[<ffffffff82b92a00>] ax88772_bind+0x330/0x480 drivers/net/usb/asix_devices.c:786\n[<ffffffff82baa33f>] usbnet_probe+0x3ff/0xdf0 drivers/net/usb/usbnet.c:1745\n[<ffffffff82c36e17>] usb_probe_interface+0x177/0x370 drivers/usb/core/driver.c:396\n[<ffffffff82661d17>] call_driver_probe drivers/base/dd.c:517 [inline]\n[<ffffffff82661d17>] really_probe.part.0+0xe7/0x380 drivers/base/dd.c:596\n[<ffffffff826620bc>] really_probe drivers/base/dd.c:558 [inline]\n[<ffffffff826620bc>] __driver_probe_device+0x10c/0x1e0 drivers/base/dd.c:751\n[<ffffffff826621ba>] driver_probe_device+0x2a/0x120 drivers/base/dd.c:781\n[<ffffffff82662a26>] __device_attach_driver+0xf6/0x140 drivers/base/dd.c:898\n[<ffffffff8265eca7>] bus_for_each\n---truncated---"
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-47472\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-47472\nhttps://lore.kernel.org/linux-cve-announce/2024052228-CVE-2021-47472-bd55@gregkh/T"
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Out of support scope",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Out of support scope",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Under investigation",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"fix_state": "Under investigation",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 8"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Affected",
			"package_name": "kernel-rt",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "kernel 4.4.290, kernel 4.4.291, kernel 4.9.288, kernel 4.9.289, kernel 4.14.253, kernel 4.14.254, kernel 4.19.214, kernel 4.19.215, kernel 5.4.156, kernel 5.4.157, kernel 5.10.76, kernel 5.10.77, kernel 5.14.15, kernel 5.14.16, kernel 5.15",
	"csaw": false
}
