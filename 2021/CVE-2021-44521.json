{
	"name": "CVE-2021-44521",
	"threat_severity": "Moderate",
	"public_date": "2022-02-11T00:00:00Z",
	"bugzilla": {
		"description": "cassandra: RCE for scripted UDFs",
		"id": "2053774",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2053774"
	},
	"cvss3": {
		"cvss3_base_score": "9.1",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H",
		"status": "draft"
	},
	"cwe": "CWE-94",
	"details": [
		"When running Apache Cassandra with the following configuration: enable_user_defined_functions: true enable_scripted_user_defined_functions: true enable_user_defined_functions_threads: false it is possible for an attacker to execute arbitrary code on the host. The attacker would need to have enough permissions to create user defined functions in the cluster to be able to exploit this. Note that this configuration is documented as unsafe, and will continue to be considered unsafe after this CVE.",
		"A flaw was found in Cassandra that allows users with certain permissions to execute user-defined functions to create scripts and run remote code execution. This flaw allows an attacker to gain unwanted access and also execute actions against Cassandra."
	],
	"statement": "While the CVSS is quite high this flaw has been downgraded to moderate impact for three main reasons:\n* Administrator privileges are required.\n* The configuration required to enable this flaw is non-default.\n* Cassandra documentation describes this configuration to be unsafe. This configuration should continue to be considered unsafe even after applying the fix for this CVE.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-44521\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-44521"
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:a_mq_clients:2",
			"fix_state": "Not affected",
			"package_name": "cassandra",
			"product_name": "A-MQ Clients 2"
		},
		{
			"cpe": "cpe:/a:redhat:a_mq_clients:2",
			"fix_state": "Not affected",
			"package_name": "org.apache.logging.log4j-log4j",
			"product_name": "A-MQ Clients 2"
		},
		{
			"cpe": "cpe:/a:redhat:jaeger:1.17::el7",
			"fix_state": "Not affected",
			"package_name": "distributed-tracing/jaeger-agent-rhel8",
			"product_name": "Distributed Tracing Jaeger 1"
		},
		{
			"cpe": "cpe:/a:redhat:jaeger:1.17::el7",
			"fix_state": "Not affected",
			"package_name": "distributed-tracing/jaeger-all-in-one-rhel8",
			"product_name": "Distributed Tracing Jaeger 1"
		},
		{
			"cpe": "cpe:/a:redhat:jaeger:1.17::el7",
			"fix_state": "Not affected",
			"package_name": "distributed-tracing/jaeger-collector-rhel8",
			"product_name": "Distributed Tracing Jaeger 1"
		},
		{
			"cpe": "cpe:/a:redhat:jaeger:1.17::el7",
			"fix_state": "Not affected",
			"package_name": "distributed-tracing/jaeger-es-index-cleaner-rhel8",
			"product_name": "Distributed Tracing Jaeger 1"
		},
		{
			"cpe": "cpe:/a:redhat:jaeger:1.17::el7",
			"fix_state": "Not affected",
			"package_name": "distributed-tracing/jaeger-es-rollover-rhel8",
			"product_name": "Distributed Tracing Jaeger 1"
		},
		{
			"cpe": "cpe:/a:redhat:jaeger:1.17::el7",
			"fix_state": "Not affected",
			"package_name": "distributed-tracing/jaeger-ingester-rhel8",
			"product_name": "Distributed Tracing Jaeger 1"
		},
		{
			"cpe": "cpe:/a:redhat:jaeger:1.17::el7",
			"fix_state": "Not affected",
			"package_name": "distributed-tracing/jaeger-query-rhel8",
			"product_name": "Distributed Tracing Jaeger 1"
		},
		{
			"cpe": "cpe:/a:redhat:quarkus:2",
			"fix_state": "Not affected",
			"package_name": "cassandra",
			"product_name": "Red Hat build of Quarkus"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:8",
			"fix_state": "Not affected",
			"package_name": "cassandra",
			"product_name": "Red Hat Data Grid 8"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "cassandra",
			"product_name": "Red Hat Fuse 7"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Not affected",
			"package_name": "cassandra",
			"product_name": "Red Hat Integration Camel K"
		},
		{
			"cpe": "cpe:/a:redhat:camel_quarkus:2",
			"fix_state": "Not affected",
			"package_name": "cassandra",
			"product_name": "Red Hat Integration Camel Quarkus"
		},
		{
			"cpe": "cpe:/a:redhat:integration:1",
			"fix_state": "Not affected",
			"package_name": "cassandra",
			"product_name": "Red Hat Integration Data Virtualisation Operator"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:7",
			"fix_state": "Out of support scope",
			"package_name": "cassandra",
			"product_name": "Red Hat JBoss Data Grid 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_virtualization:6",
			"fix_state": "Out of support scope",
			"package_name": "cassandra",
			"product_name": "Red Hat JBoss Data Virtualization 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6",
			"fix_state": "Out of support scope",
			"package_name": "cassandra",
			"product_name": "Red Hat JBoss Enterprise Application Platform 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6",
			"fix_state": "Out of support scope",
			"package_name": "jboss-on",
			"product_name": "Red Hat JBoss Enterprise Application Platform 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7",
			"fix_state": "Not affected",
			"package_name": "cassandra",
			"product_name": "Red Hat JBoss Enterprise Application Platform 7"
		},
		{
			"cpe": "cpe:/a:redhat:jbosseapxp",
			"fix_state": "Not affected",
			"package_name": "cassandra",
			"product_name": "Red Hat JBoss Enterprise Application Platform Expansion Pack"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:6",
			"fix_state": "Out of support scope",
			"package_name": "cassandra",
			"product_name": "Red Hat JBoss Fuse 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse_service_works:6",
			"fix_state": "Out of support scope",
			"package_name": "cassandra",
			"product_name": "Red Hat JBoss Fuse Service Works 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_operations_network:3",
			"fix_state": "Out of support scope",
			"package_name": "cassandra",
			"product_name": "Red Hat JBoss Operations Network 3"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_operations_network:3",
			"fix_state": "Out of support scope",
			"package_name": "org.jboss.on-jboss-on-parent",
			"product_name": "Red Hat JBoss Operations Network 3"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_application_runtimes:1.0",
			"fix_state": "Not affected",
			"package_name": "cassandra",
			"product_name": "Red Hat OpenShift Application Runtimes"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Out of support scope",
			"package_name": "openshift3/metrics-cassandra",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Out of support scope",
			"package_name": "openshift3/metrics-hawkular-metrics",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Out of support scope",
			"package_name": "openshift3/metrics-schema-installer",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Out of support scope",
			"package_name": "openshift3/ose-metrics-cassandra",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Out of support scope",
			"package_name": "openshift3/ose-metrics-hawkular-metrics",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Out of support scope",
			"package_name": "openshift3/ose-metrics-schema-installer",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Out of support scope",
			"package_name": "ocs4/ocs-must-gather-rhel8",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Out of support scope",
			"package_name": "ocs4/ocs-rhel8-operator",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Out of support scope",
			"package_name": "ocs4/rook-ceph-rhel8-operator",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_container_storage:4",
			"fix_state": "Out of support scope",
			"package_name": "odf-multicluster-operator-container",
			"product_name": "Red Hat Openshift Container Storage 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Affected",
			"package_name": "odf4/ocs-must-gather-rhel8",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Affected",
			"package_name": "odf4/ocs-rhel9-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Affected",
			"package_name": "odf4/odf-multicluster-rhel9-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_data_foundation:4",
			"fix_state": "Affected",
			"package_name": "odf4/rook-ceph-rhel8-operator",
			"product_name": "Red Hat Openshift Data Foundation 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:2",
			"fix_state": "Not affected",
			"package_name": "rhosdt/jaeger-agent-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 2"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:2",
			"fix_state": "Not affected",
			"package_name": "rhosdt/jaeger-all-in-one-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 2"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:2",
			"fix_state": "Not affected",
			"package_name": "rhosdt/jaeger-collector-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 2"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:2",
			"fix_state": "Not affected",
			"package_name": "rhosdt/jaeger-es-index-cleaner-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 2"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:2",
			"fix_state": "Not affected",
			"package_name": "rhosdt/jaeger-es-rollover-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 2"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:2",
			"fix_state": "Not affected",
			"package_name": "rhosdt/jaeger-ingester-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 2"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_distributed_tracing:2",
			"fix_state": "Not affected",
			"package_name": "rhosdt/jaeger-query-rhel8",
			"product_name": "Red Hat OpenShift distributed tracing 2"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:10",
			"fix_state": "Out of support scope",
			"package_name": "opendaylight",
			"product_name": "Red Hat OpenStack Platform 10 (Newton)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:10",
			"fix_state": "Out of support scope",
			"package_name": "puppet-cassandra",
			"product_name": "Red Hat OpenStack Platform 10 (Newton)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:13",
			"fix_state": "Out of support scope",
			"package_name": "puppet-cassandra",
			"product_name": "Red Hat OpenStack Platform 13 (Queens)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:16.1",
			"fix_state": "Not affected",
			"package_name": "puppet-cassandra",
			"product_name": "Red Hat OpenStack Platform 16.1"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:16.2",
			"fix_state": "Not affected",
			"package_name": "puppet-cassandra",
			"product_name": "Red Hat OpenStack Platform 16.2"
		},
		{
			"cpe": "cpe:/a:redhat:amq_streams:1",
			"fix_state": "Not affected",
			"package_name": "cassandra",
			"product_name": "streams for Apache Kafka"
		}
	],
	"upstream_fix": "cassandra 3.0.26, cassandra 3.11.12, cassandra 4.0.2",
	"csaw": false
}
