{
	"name": "CVE-2021-43797",
	"threat_severity": "Moderate",
	"public_date": "2021-12-09T00:00:00Z",
	"bugzilla": {
		"description": "control chars in header names may lead to HTTP request smuggling",
		"id": "2031958",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2031958"
	},
	"cvss3": {
		"cvss3_base_score": "6.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N",
		"status": "verified"
	},
	"cwe": "CWE-444",
	"details": [
		"Netty is an asynchronous event-driven network application framework for rapid development of maintainable high performance protocol servers & clients. Netty prior to version 4.1.71.Final skips control chars when they are present at the beginning / end of the header name. It should instead fail fast as these are not allowed by the spec and could lead to HTTP request smuggling. Failing to do the validation might cause netty to \"sanitize\" header names before it forward these to another remote system when used as proxy. This remote system can't see the invalid usage anymore, and therefore does not do the validation itself. Users should upgrade to version 4.1.71.Final.",
		"A flaw was found in Netty, specifically in the netty-codec-http package. This flaw allows unauthorized control characters at the beginning and end of a request, does not follow the specification, and can cause HTTP request smuggling."
	],
	"statement": "In OpenShift Container Platform (OCP), the Hive/Presto/Hadoop components that comprise the OCP Metering stack, ship the vulnerable version of netty-codec-http package.\nSince the release of OCP 4.6, the Metering product has been deprecated, hence the affected components are marked as wontfix.\nThe openshift4/ose-logging-elasticsearch6 container is marked as Out of support scope because since the release of OCP 4.7 the logging functionality is delivered as an OpenShift Logging product and OCP 4.6 is already in the Maintenance Support phase.\nA fix was introduced in netty-codec-http version 4.1.72.Final.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-43797\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-43797\nhttps://github.com/netty/netty/security/advisories/GHSA-wx5j-54mm-rqqq"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2022:2216",
			"cpe": "cpe:/a:redhat:logging:5.4::el8",
			"package": "openshift-logging/elasticsearch6-rhel8:v6.8.1-156",
			"product_name": "Logging subsystem for Red Hat OpenShift 5.4",
			"release_date": "2022-05-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:2218",
			"cpe": "cpe:/a:redhat:logging:5.2::el8",
			"package": "openshift-logging/elasticsearch6-rhel8:v6.8.1-157",
			"product_name": "OpenShift Logging 5.2",
			"release_date": "2022-05-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:2217",
			"cpe": "cpe:/a:redhat:logging:5.3::el8",
			"package": "openshift-logging/elasticsearch6-rhel8:v6.8.1-159",
			"product_name": "OpenShift Logging 5.3",
			"release_date": "2022-05-11T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:5101",
			"cpe": "cpe:/a:redhat:amq_broker:7",
			"impact": "low",
			"package": "netty",
			"product_name": "Red Hat AMQ 7.10.0",
			"release_date": "2022-06-16T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:1345",
			"cpe": "cpe:/a:redhat:amq_streams:2",
			"package": "netty",
			"product_name": "Red Hat AMQ Streams 2.1.0",
			"release_date": "2022-04-13T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:4623",
			"cpe": "cpe:/a:redhat:quarkus:2.7",
			"package": "netty",
			"product_name": "Red Hat build of Quarkus 2.7.5",
			"release_date": "2022-05-18T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:0520",
			"cpe": "cpe:/a:redhat:jboss_data_grid:8",
			"package": "netty",
			"product_name": "Red Hat Data Grid 8.3.0",
			"release_date": "2022-02-14T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:5532",
			"cpe": "cpe:/a:redhat:jboss_fuse:7",
			"package": "netty",
			"product_name": "Red Hat Fuse 7.11",
			"release_date": "2022-07-07T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:4922",
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4",
			"impact": "low",
			"package": "netty",
			"product_name": "Red Hat JBoss Enterprise Application Platform 7",
			"release_date": "2022-06-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:4919",
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4::el8",
			"impact": "low",
			"package": "eap7-netty-0:4.1.72-4.Final_redhat_00001.1.el8eap",
			"product_name": "Red Hat JBoss Enterprise Application Platform 7.4 for RHEL 8",
			"release_date": "2022-06-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:4918",
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7.4::el7",
			"impact": "low",
			"package": "eap7-netty-0:4.1.72-4.Final_redhat_00001.1.el7eap",
			"product_name": "Red Hat JBoss Enterprise Application Platform 7.4 on RHEL 7",
			"release_date": "2022-06-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:5498",
			"cpe": "cpe:/a:redhat:satellite:6.11::el7",
			"package": "candlepin-0:4.1.13-1.el7sat",
			"product_name": "Red Hat Satellite 6.11 for RHEL 7",
			"release_date": "2022-07-05T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:5498",
			"cpe": "cpe:/a:redhat:satellite:6.11::el8",
			"package": "candlepin-0:4.1.13-1.el8sat",
			"product_name": "Red Hat Satellite 6.11 for RHEL 8",
			"release_date": "2022-07-05T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:6787",
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7",
			"impact": "low",
			"package": "netty",
			"product_name": "Red Hat Single Sign-On 7",
			"release_date": "2022-10-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:6782",
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.5::el7",
			"impact": "low",
			"package": "rh-sso7-keycloak-0:15.0.8-1.redhat_00001.1.el7sso",
			"product_name": "Red Hat Single Sign-On 7.5 for RHEL 7",
			"release_date": "2022-10-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:6783",
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.5::el8",
			"impact": "low",
			"package": "rh-sso7-keycloak-0:15.0.8-1.redhat_00001.1.el8sso",
			"product_name": "Red Hat Single Sign-On 7.5 for RHEL 8",
			"release_date": "2022-10-04T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:7417",
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6.1",
			"impact": "low",
			"package": "netty",
			"product_name": "Red Hat Single Sign-On 7.6.1",
			"release_date": "2022-11-03T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:7409",
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el7",
			"impact": "low",
			"package": "rh-sso7-keycloak-0:18.0.3-1.redhat_00001.1.el7sso",
			"product_name": "Red Hat Single Sign-On 7.6 for RHEL 7",
			"release_date": "2022-11-03T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:7410",
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el8",
			"impact": "low",
			"package": "rh-sso7-keycloak-0:18.0.3-1.redhat_00001.1.el8sso",
			"product_name": "Red Hat Single Sign-On 7.6 for RHEL 8",
			"release_date": "2022-11-03T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:7411",
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el9",
			"impact": "low",
			"package": "rh-sso7-0:1-5.el9sso",
			"product_name": "Red Hat Single Sign-On 7.6 for RHEL 9",
			"release_date": "2022-11-03T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:7411",
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el9",
			"impact": "low",
			"package": "rh-sso7-javapackages-tools-0:6.0.0-7.el9sso",
			"product_name": "Red Hat Single Sign-On 7.6 for RHEL 9",
			"release_date": "2022-11-03T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:7411",
			"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7.6::el9",
			"impact": "low",
			"package": "rh-sso7-keycloak-0:18.0.3-1.redhat_00001.1.el9sso",
			"product_name": "Red Hat Single Sign-On 7.6 for RHEL 9",
			"release_date": "2022-11-03T00:00:00Z"
		},
		{
			"advisory": "RHSA-2022:5903",
			"cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7.13",
			"impact": "low",
			"package": "netty",
			"product_name": "RHPAM 7.13.0 async",
			"release_date": "2022-08-04T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:a_mq_clients:2",
			"fix_state": "Affected",
			"package_name": "netty",
			"product_name": "A-MQ Clients 2"
		},
		{
			"cpe": "cpe:/a:redhat:amq_online:1",
			"fix_state": "Will not fix",
			"package_name": "netty",
			"product_name": "Red Hat A-MQ Online"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "netty",
			"product_name": "Red Hat Decision Manager 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_amq:6",
			"fix_state": "Out of support scope",
			"package_name": "netty",
			"product_name": "Red Hat JBoss A-MQ 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_data_grid:7",
			"fix_state": "Out of support scope",
			"package_name": "netty",
			"product_name": "Red Hat JBoss Data Grid 7"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:5",
			"fix_state": "Out of support scope",
			"package_name": "netty",
			"product_name": "Red Hat JBoss Enterprise Application Platform 5"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6",
			"fix_state": "Out of support scope",
			"package_name": "netty",
			"product_name": "Red Hat JBoss Enterprise Application Platform 6"
		},
		{
			"cpe": "cpe:/a:redhat:jbosseapxp",
			"fix_state": "Not affected",
			"impact": "low",
			"package_name": "netty",
			"product_name": "Red Hat JBoss Enterprise Application Platform Expansion Pack"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_fuse:6",
			"fix_state": "Out of support scope",
			"package_name": "netty",
			"product_name": "Red Hat JBoss Fuse 6"
		},
		{
			"cpe": "cpe:/a:redhat:jboss_operations_network:3",
			"fix_state": "Out of support scope",
			"package_name": "netty",
			"product_name": "Red Hat JBoss Operations Network 3"
		},
		{
			"cpe": "cpe:/a:redhat:openshift_application_runtimes:1.0",
			"fix_state": "Not affected",
			"package_name": "netty",
			"product_name": "Red Hat OpenShift Application Runtimes"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Out of support scope",
			"package_name": "openshift3/ose-logging-elasticsearch5",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Out of support scope",
			"package_name": "openshift4/ose-logging-elasticsearch6",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Will not fix",
			"package_name": "openshift4/ose-metering-hadoop",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Will not fix",
			"package_name": "openshift4/ose-metering-hive",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Will not fix",
			"package_name": "openshift4/ose-metering-presto",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:10",
			"fix_state": "Out of support scope",
			"package_name": "opendaylight",
			"product_name": "Red Hat OpenStack Platform 10 (Newton)"
		},
		{
			"cpe": "cpe:/a:redhat:openstack:13",
			"fix_state": "Out of support scope",
			"package_name": "opendaylight",
			"product_name": "Red Hat OpenStack Platform 13 (Queens)"
		}
	],
	"upstream_fix": "netty-codec-http 4.1.72.Final",
	"csaw": false
}
