{
	"name": "CVE-2021-27358",
	"threat_severity": "Moderate",
	"public_date": "2021-02-17T00:00:00Z",
	"bugzilla": {
		"description": "grafana: snapshot feature allow an unauthenticated remote attacker to trigger a DoS via a remote API call",
		"id": "1941024",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1941024"
	},
	"cvss3": {
		"cvss3_base_score": "7.5",
		"cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
		"status": "verified"
	},
	"cwe": "CWE-862->CWE-400",
	"details": [
		"The snapshot feature in Grafana 6.7.3 through 7.4.1 can allow an unauthenticated remote attackers to trigger a Denial of Service via a remote API call if a commonly used configuration is set.",
		"A flaw was found in Grafana. The snapshot feature allows unauthenticated remote attackers to trigger a denial of service (DoS) via a remote API call if anonymous access is enabled. The highest threat from this vulnerability is to system availability."
	],
	"statement": "While in OpenShift Container Platform (OCP), OpenShift ServiceMesh (OSSM) and Red Hat Advanced Cluster Management for Kubernetes (RHACM) there is shipped a vulnerable version of grafana, access to the grafana panel is behind OpenShift OAuth proxy and requires admin permissions. Therefore these components are affected but with impact Low.\nRed Hat Ceph Storage (RHCS) and Red Hat Gluster Storage 3 does not ship the directly affected code, however, they are still affected by this vulnerability because it allows the same configuration of anonymous snapshots, hence this issue has been rated as having a security impact of Low.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-27358\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-27358\nhttps://grafana.com/docs/grafana/latest/release-notes/release-notes-7-4-2/"
	],
	"affected_release": [
		{
			"advisory": "RHSA-2021:3016",
			"cpe": "cpe:/a:redhat:acm:2.3::el8",
			"impact": "low",
			"package": "rhacm2/acm-grafana-rhel8:v2.3.0-38",
			"product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 8",
			"release_date": "2021-08-06T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:4226",
			"cpe": "cpe:/a:redhat:enterprise_linux:8",
			"package": "grafana-0:7.5.9-4.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2021-11-09T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/a:redhat:service_mesh:1",
			"fix_state": "Out of support scope",
			"impact": "low",
			"package_name": "servicemesh-grafana",
			"product_name": "OpenShift Service Mesh 1"
		},
		{
			"cpe": "cpe:/a:redhat:service_mesh:2.0",
			"fix_state": "Will not fix",
			"package_name": "servicemesh-grafana",
			"product_name": "OpenShift Service Mesh 2.0"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:2",
			"fix_state": "Out of support scope",
			"package_name": "grafana",
			"product_name": "Red Hat Ceph Storage 2"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:3",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "grafana",
			"product_name": "Red Hat Ceph Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:3",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "grafana-container",
			"product_name": "Red Hat Ceph Storage 3"
		},
		{
			"cpe": "cpe:/a:redhat:ceph_storage:4",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "rhceph/rhceph-4-dashboard-rhel8",
			"product_name": "Red Hat Ceph Storage 4"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "grafana",
			"product_name": "Red Hat Enterprise Linux 9"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:3.11",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "openshift3/grafana",
			"product_name": "Red Hat OpenShift Container Platform 3.11"
		},
		{
			"cpe": "cpe:/a:redhat:openshift:4",
			"fix_state": "Will not fix",
			"impact": "low",
			"package_name": "openshift4/ose-grafana",
			"product_name": "Red Hat OpenShift Container Platform 4"
		},
		{
			"cpe": "cpe:/a:redhat:storage:3",
			"fix_state": "Affected",
			"impact": "low",
			"package_name": "grafana",
			"product_name": "Red Hat Storage 3"
		}
	],
	"upstream_fix": "grafana 7.4.2",
	"csaw": false
}
