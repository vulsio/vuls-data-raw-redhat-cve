{
	"name": "CVE-2021-33033",
	"threat_severity": "Moderate",
	"public_date": "2021-03-04T00:00:00Z",
	"bugzilla": {
		"description": "CVE-2021-33033 kernel: use-after-free in cipso_v4_genopt in net/ipv4/cipso_ipv4.c",
		"id": "1961300",
		"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1961300"
	},
	"cvss3": {
		"cvss3_base_score": "7.8",
		"cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
		"status": "verified"
	},
	"cwe": "CWE-416",
	"details": [
		"The Linux kernel before 5.11.14 has a use-after-free in cipso_v4_genopt in net/ipv4/cipso_ipv4.c because the CIPSO and CALIPSO refcounting for the DOI definitions is mishandled, aka CID-ad5d07f4a9cd. This leads to writing an arbitrary value.",
		"A flaw use-after-free in the Linux kernel CIPSO network packet labeling protocol functionality was found in the way user open local network connection with the usage of the security labeling that is IP option number 134. A local user could use this flaw to crash the system or possibly escalate their privileges on the system."
	],
	"statement": "Considered to be Moderate rate, because by default CIPSO non-enabled and both no known way to reproduce the attack remotely and both it looks complex if even possible to use the attack in any way apart from crashing the system. For the usage of the inbound CIPSO connections, the administrator have to enable it with netlabelctl utility first. The vulnerability is considered to be for local user, because it can happen only when a local user opens a socket for sending packets, but not during receiving packets.",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2021-33033\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-33033"
	],
	"mitigation": {
		"lang": "en:us",
		"value": "The mitigation would be not allowing CIPSO labeling for the inbound network connections. For the most of the default configurations both for network routers and for the Linux servers itself it is disabled by default."
	},
	"affected_release": [
		{
			"advisory": "RHSA-2021:2726",
			"cpe": "cpe:/a:redhat:rhel_extras_rt:7",
			"package": "kernel-rt-0:3.10.0-1160.36.2.rt56.1179.el7",
			"product_name": "Red Hat Enterprise Linux 7",
			"release_date": "2021-07-21T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:2725",
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"package": "kernel-0:3.10.0-1160.36.2.el7",
			"product_name": "Red Hat Enterprise Linux 7",
			"release_date": "2021-07-21T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:4140",
			"cpe": "cpe:/a:redhat:enterprise_linux:8::nfv",
			"package": "kernel-rt-0:4.18.0-348.rt7.130.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2021-11-09T00:00:00Z"
		},
		{
			"advisory": "RHSA-2021:4356",
			"cpe": "cpe:/o:redhat:enterprise_linux:8",
			"package": "kernel-0:4.18.0-348.el8",
			"product_name": "Red Hat Enterprise Linux 8",
			"release_date": "2021-11-09T00:00:00Z"
		}
	],
	"package_state": [
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:6",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 6"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:7",
			"fix_state": "Will not fix",
			"package_name": "kernel-alt",
			"product_name": "Red Hat Enterprise Linux 7"
		},
		{
			"cpe": "cpe:/o:redhat:enterprise_linux:9",
			"fix_state": "Not affected",
			"package_name": "kernel",
			"product_name": "Red Hat Enterprise Linux 9"
		}
	],
	"upstream_fix": "Kernel 5.12",
	"csaw": false
}
